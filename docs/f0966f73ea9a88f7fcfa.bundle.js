/*! For license information please see f0966f73ea9a88f7fcfa.bundle.js.LICENSE.txt */
(()=>{var e,t,n={9742:(e,t)=>{"use strict";t.byteLength=function(e){var t=a(e),n=t[0],r=t[1];return 3*(n+r)/4-r},t.toByteArray=function(e){var t,n,o=a(e),s=o[0],c=o[1],u=new i(function(e,t,n){return 3*(t+n)/4-n}(0,s,c)),l=0,h=c>0?s-4:s;for(n=0;n<h;n+=4)t=r[e.charCodeAt(n)]<<18|r[e.charCodeAt(n+1)]<<12|r[e.charCodeAt(n+2)]<<6|r[e.charCodeAt(n+3)],u[l++]=t>>16&255,u[l++]=t>>8&255,u[l++]=255&t;2===c&&(t=r[e.charCodeAt(n)]<<2|r[e.charCodeAt(n+1)]>>4,u[l++]=255&t);1===c&&(t=r[e.charCodeAt(n)]<<10|r[e.charCodeAt(n+1)]<<4|r[e.charCodeAt(n+2)]>>2,u[l++]=t>>8&255,u[l++]=255&t);return u},t.fromByteArray=function(e){for(var t,r=e.length,i=r%3,o=[],s=16383,a=0,u=r-i;a<u;a+=s)o.push(c(e,a,a+s>u?u:a+s));1===i?(t=e[r-1],o.push(n[t>>2]+n[t<<4&63]+"==")):2===i&&(t=(e[r-2]<<8)+e[r-1],o.push(n[t>>10]+n[t>>4&63]+n[t<<2&63]+"="));return o.join("")};for(var n=[],r=[],i="undefined"!=typeof Uint8Array?Uint8Array:Array,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0;s<64;++s)n[s]=o[s],r[o.charCodeAt(s)]=s;function a(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");return-1===n&&(n=t),[n,n===t?0:4-n%4]}function c(e,t,r){for(var i,o,s=[],a=t;a<r;a+=3)i=(e[a]<<16&16711680)+(e[a+1]<<8&65280)+(255&e[a+2]),s.push(n[(o=i)>>18&63]+n[o>>12&63]+n[o>>6&63]+n[63&o]);return s.join("")}r["-".charCodeAt(0)]=62,r["_".charCodeAt(0)]=63},8764:(e,t,n)=>{"use strict";const r=n(9742),i=n(645),o="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;t.Buffer=c,t.SlowBuffer=function(e){+e!=e&&(e=0);return c.alloc(+e)},t.INSPECT_MAX_BYTES=50;const s=2147483647;function a(e){if(e>s)throw new RangeError('The value "'+e+'" is invalid for option "size"');const t=new Uint8Array(e);return Object.setPrototypeOf(t,c.prototype),t}function c(e,t,n){if("number"==typeof e){if("string"==typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return h(e)}return u(e,t,n)}function u(e,t,n){if("string"==typeof e)return function(e,t){"string"==typeof t&&""!==t||(t="utf8");if(!c.isEncoding(t))throw new TypeError("Unknown encoding: "+t);const n=0|m(e,t);let r=a(n);const i=r.write(e,t);i!==n&&(r=r.slice(0,i));return r}(e,t);if(ArrayBuffer.isView(e))return function(e){if(Y(e,Uint8Array)){const t=new Uint8Array(e);return f(t.buffer,t.byteOffset,t.byteLength)}return d(e)}(e);if(null==e)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(Y(e,ArrayBuffer)||e&&Y(e.buffer,ArrayBuffer))return f(e,t,n);if("undefined"!=typeof SharedArrayBuffer&&(Y(e,SharedArrayBuffer)||e&&Y(e.buffer,SharedArrayBuffer)))return f(e,t,n);if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');const r=e.valueOf&&e.valueOf();if(null!=r&&r!==e)return c.from(r,t,n);const i=function(e){if(c.isBuffer(e)){const t=0|p(e.length),n=a(t);return 0===n.length||e.copy(n,0,0,t),n}if(void 0!==e.length)return"number"!=typeof e.length||G(e.length)?a(0):d(e);if("Buffer"===e.type&&Array.isArray(e.data))return d(e.data)}(e);if(i)return i;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return c.from(e[Symbol.toPrimitive]("string"),t,n);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function l(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function h(e){return l(e),a(e<0?0:0|p(e))}function d(e){const t=e.length<0?0:0|p(e.length),n=a(t);for(let r=0;r<t;r+=1)n[r]=255&e[r];return n}function f(e,t,n){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(n||0))throw new RangeError('"length" is outside of buffer bounds');let r;return r=void 0===t&&void 0===n?new Uint8Array(e):void 0===n?new Uint8Array(e,t):new Uint8Array(e,t,n),Object.setPrototypeOf(r,c.prototype),r}function p(e){if(e>=s)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s.toString(16)+" bytes");return 0|e}function m(e,t){if(c.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||Y(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);const n=e.length,r=arguments.length>2&&!0===arguments[2];if(!r&&0===n)return 0;let i=!1;for(;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":return H(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return Q(e).length;default:if(i)return r?-1:H(e).length;t=(""+t).toLowerCase(),i=!0}}function y(e,t,n){let r=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return P(this,t,n);case"utf8":case"utf-8":return C(this,t,n);case"ascii":return R(this,t,n);case"latin1":case"binary":return I(this,t,n);case"base64":return x(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return D(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}function v(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function g(e,t,n,r,i){if(0===e.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),G(n=+n)&&(n=i?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(i)return-1;n=e.length-1}else if(n<0){if(!i)return-1;n=0}if("string"==typeof t&&(t=c.from(t,r)),c.isBuffer(t))return 0===t.length?-1:b(e,t,n,r,i);if("number"==typeof t)return t&=255,"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):b(e,[t],n,r,i);throw new TypeError("val must be string, number or Buffer")}function b(e,t,n,r,i){let o,s=1,a=e.length,c=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;s=2,a/=2,c/=2,n/=2}function u(e,t){return 1===s?e[t]:e.readUInt16BE(t*s)}if(i){let r=-1;for(o=n;o<a;o++)if(u(e,o)===u(t,-1===r?0:o-r)){if(-1===r&&(r=o),o-r+1===c)return r*s}else-1!==r&&(o-=o-r),r=-1}else for(n+c>a&&(n=a-c),o=n;o>=0;o--){let n=!0;for(let r=0;r<c;r++)if(u(e,o+r)!==u(t,r)){n=!1;break}if(n)return o}return-1}function w(e,t,n,r){n=Number(n)||0;const i=e.length-n;r?(r=Number(r))>i&&(r=i):r=i;const o=t.length;let s;for(r>o/2&&(r=o/2),s=0;s<r;++s){const r=parseInt(t.substr(2*s,2),16);if(G(r))return s;e[n+s]=r}return s}function _(e,t,n,r){return V(H(t,e.length-n),e,n,r)}function E(e,t,n,r){return V(function(e){const t=[];for(let n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,r)}function k(e,t,n,r){return V(Q(t),e,n,r)}function S(e,t,n,r){return V(function(e,t){let n,r,i;const o=[];for(let s=0;s<e.length&&!((t-=2)<0);++s)n=e.charCodeAt(s),r=n>>8,i=n%256,o.push(i),o.push(r);return o}(t,e.length-n),e,n,r)}function x(e,t,n){return 0===t&&n===e.length?r.fromByteArray(e):r.fromByteArray(e.slice(t,n))}function C(e,t,n){n=Math.min(e.length,n);const r=[];let i=t;for(;i<n;){const t=e[i];let o=null,s=t>239?4:t>223?3:t>191?2:1;if(i+s<=n){let n,r,a,c;switch(s){case 1:t<128&&(o=t);break;case 2:n=e[i+1],128==(192&n)&&(c=(31&t)<<6|63&n,c>127&&(o=c));break;case 3:n=e[i+1],r=e[i+2],128==(192&n)&&128==(192&r)&&(c=(15&t)<<12|(63&n)<<6|63&r,c>2047&&(c<55296||c>57343)&&(o=c));break;case 4:n=e[i+1],r=e[i+2],a=e[i+3],128==(192&n)&&128==(192&r)&&128==(192&a)&&(c=(15&t)<<18|(63&n)<<12|(63&r)<<6|63&a,c>65535&&c<1114112&&(o=c))}}null===o?(o=65533,s=1):o>65535&&(o-=65536,r.push(o>>>10&1023|55296),o=56320|1023&o),r.push(o),i+=s}return function(e){const t=e.length;if(t<=O)return String.fromCharCode.apply(String,e);let n="",r=0;for(;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=O));return n}(r)}t.kMaxLength=s,c.TYPED_ARRAY_SUPPORT=function(){try{const e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(e){return!1}}(),c.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(c.prototype,"parent",{enumerable:!0,get:function(){if(c.isBuffer(this))return this.buffer}}),Object.defineProperty(c.prototype,"offset",{enumerable:!0,get:function(){if(c.isBuffer(this))return this.byteOffset}}),c.poolSize=8192,c.from=function(e,t,n){return u(e,t,n)},Object.setPrototypeOf(c.prototype,Uint8Array.prototype),Object.setPrototypeOf(c,Uint8Array),c.alloc=function(e,t,n){return function(e,t,n){return l(e),e<=0?a(e):void 0!==t?"string"==typeof n?a(e).fill(t,n):a(e).fill(t):a(e)}(e,t,n)},c.allocUnsafe=function(e){return h(e)},c.allocUnsafeSlow=function(e){return h(e)},c.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==c.prototype},c.compare=function(e,t){if(Y(e,Uint8Array)&&(e=c.from(e,e.offset,e.byteLength)),Y(t,Uint8Array)&&(t=c.from(t,t.offset,t.byteLength)),!c.isBuffer(e)||!c.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;let n=e.length,r=t.length;for(let i=0,o=Math.min(n,r);i<o;++i)if(e[i]!==t[i]){n=e[i],r=t[i];break}return n<r?-1:r<n?1:0},c.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},c.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return c.alloc(0);let n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;const r=c.allocUnsafe(t);let i=0;for(n=0;n<e.length;++n){let t=e[n];if(Y(t,Uint8Array))i+t.length>r.length?(c.isBuffer(t)||(t=c.from(t)),t.copy(r,i)):Uint8Array.prototype.set.call(r,t,i);else{if(!c.isBuffer(t))throw new TypeError('"list" argument must be an Array of Buffers');t.copy(r,i)}i+=t.length}return r},c.byteLength=m,c.prototype._isBuffer=!0,c.prototype.swap16=function(){const e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let t=0;t<e;t+=2)v(this,t,t+1);return this},c.prototype.swap32=function(){const e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let t=0;t<e;t+=4)v(this,t,t+3),v(this,t+1,t+2);return this},c.prototype.swap64=function(){const e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let t=0;t<e;t+=8)v(this,t,t+7),v(this,t+1,t+6),v(this,t+2,t+5),v(this,t+3,t+4);return this},c.prototype.toString=function(){const e=this.length;return 0===e?"":0===arguments.length?C(this,0,e):y.apply(this,arguments)},c.prototype.toLocaleString=c.prototype.toString,c.prototype.equals=function(e){if(!c.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===c.compare(this,e)},c.prototype.inspect=function(){let e="";const n=t.INSPECT_MAX_BYTES;return e=this.toString("hex",0,n).replace(/(.{2})/g,"$1 ").trim(),this.length>n&&(e+=" ... "),"<Buffer "+e+">"},o&&(c.prototype[o]=c.prototype.inspect),c.prototype.compare=function(e,t,n,r,i){if(Y(e,Uint8Array)&&(e=c.from(e,e.offset,e.byteLength)),!c.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),t<0||n>e.length||r<0||i>this.length)throw new RangeError("out of range index");if(r>=i&&t>=n)return 0;if(r>=i)return-1;if(t>=n)return 1;if(this===e)return 0;let o=(i>>>=0)-(r>>>=0),s=(n>>>=0)-(t>>>=0);const a=Math.min(o,s),u=this.slice(r,i),l=e.slice(t,n);for(let e=0;e<a;++e)if(u[e]!==l[e]){o=u[e],s=l[e];break}return o<s?-1:s<o?1:0},c.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},c.prototype.indexOf=function(e,t,n){return g(this,e,t,n,!0)},c.prototype.lastIndexOf=function(e,t,n){return g(this,e,t,n,!1)},c.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(n)?(n>>>=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}const i=this.length-t;if((void 0===n||n>i)&&(n=i),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");let o=!1;for(;;)switch(r){case"hex":return w(this,e,t,n);case"utf8":case"utf-8":return _(this,e,t,n);case"ascii":case"latin1":case"binary":return E(this,e,t,n);case"base64":return k(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return S(this,e,t,n);default:if(o)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),o=!0}},c.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};const O=4096;function R(e,t,n){let r="";n=Math.min(e.length,n);for(let i=t;i<n;++i)r+=String.fromCharCode(127&e[i]);return r}function I(e,t,n){let r="";n=Math.min(e.length,n);for(let i=t;i<n;++i)r+=String.fromCharCode(e[i]);return r}function P(e,t,n){const r=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>r)&&(n=r);let i="";for(let r=t;r<n;++r)i+=J[e[r]];return i}function D(e,t,n){const r=e.slice(t,n);let i="";for(let e=0;e<r.length-1;e+=2)i+=String.fromCharCode(r[e]+256*r[e+1]);return i}function T(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function A(e,t,n,r,i,o){if(!c.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<o)throw new RangeError('"value" argument is out of bounds');if(n+r>e.length)throw new RangeError("Index out of range")}function j(e,t,n,r,i){K(t,r,i,e,n,7);let o=Number(t&BigInt(4294967295));e[n++]=o,o>>=8,e[n++]=o,o>>=8,e[n++]=o,o>>=8,e[n++]=o;let s=Number(t>>BigInt(32)&BigInt(4294967295));return e[n++]=s,s>>=8,e[n++]=s,s>>=8,e[n++]=s,s>>=8,e[n++]=s,n}function M(e,t,n,r,i){K(t,r,i,e,n,7);let o=Number(t&BigInt(4294967295));e[n+7]=o,o>>=8,e[n+6]=o,o>>=8,e[n+5]=o,o>>=8,e[n+4]=o;let s=Number(t>>BigInt(32)&BigInt(4294967295));return e[n+3]=s,s>>=8,e[n+2]=s,s>>=8,e[n+1]=s,s>>=8,e[n]=s,n+8}function N(e,t,n,r,i,o){if(n+r>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function L(e,t,n,r,o){return t=+t,n>>>=0,o||N(e,0,n,4),i.write(e,t,n,r,23,4),n+4}function B(e,t,n,r,o){return t=+t,n>>>=0,o||N(e,0,n,8),i.write(e,t,n,r,52,8),n+8}c.prototype.slice=function(e,t){const n=this.length;(e=~~e)<0?(e+=n)<0&&(e=0):e>n&&(e=n),(t=void 0===t?n:~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),t<e&&(t=e);const r=this.subarray(e,t);return Object.setPrototypeOf(r,c.prototype),r},c.prototype.readUintLE=c.prototype.readUIntLE=function(e,t,n){e>>>=0,t>>>=0,n||T(e,t,this.length);let r=this[e],i=1,o=0;for(;++o<t&&(i*=256);)r+=this[e+o]*i;return r},c.prototype.readUintBE=c.prototype.readUIntBE=function(e,t,n){e>>>=0,t>>>=0,n||T(e,t,this.length);let r=this[e+--t],i=1;for(;t>0&&(i*=256);)r+=this[e+--t]*i;return r},c.prototype.readUint8=c.prototype.readUInt8=function(e,t){return e>>>=0,t||T(e,1,this.length),this[e]},c.prototype.readUint16LE=c.prototype.readUInt16LE=function(e,t){return e>>>=0,t||T(e,2,this.length),this[e]|this[e+1]<<8},c.prototype.readUint16BE=c.prototype.readUInt16BE=function(e,t){return e>>>=0,t||T(e,2,this.length),this[e]<<8|this[e+1]},c.prototype.readUint32LE=c.prototype.readUInt32LE=function(e,t){return e>>>=0,t||T(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},c.prototype.readUint32BE=c.prototype.readUInt32BE=function(e,t){return e>>>=0,t||T(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},c.prototype.readBigUInt64LE=Z((function(e){U(e>>>=0,"offset");const t=this[e],n=this[e+7];void 0!==t&&void 0!==n||W(e,this.length-8);const r=t+256*this[++e]+65536*this[++e]+this[++e]*2**24,i=this[++e]+256*this[++e]+65536*this[++e]+n*2**24;return BigInt(r)+(BigInt(i)<<BigInt(32))})),c.prototype.readBigUInt64BE=Z((function(e){U(e>>>=0,"offset");const t=this[e],n=this[e+7];void 0!==t&&void 0!==n||W(e,this.length-8);const r=t*2**24+65536*this[++e]+256*this[++e]+this[++e],i=this[++e]*2**24+65536*this[++e]+256*this[++e]+n;return(BigInt(r)<<BigInt(32))+BigInt(i)})),c.prototype.readIntLE=function(e,t,n){e>>>=0,t>>>=0,n||T(e,t,this.length);let r=this[e],i=1,o=0;for(;++o<t&&(i*=256);)r+=this[e+o]*i;return i*=128,r>=i&&(r-=Math.pow(2,8*t)),r},c.prototype.readIntBE=function(e,t,n){e>>>=0,t>>>=0,n||T(e,t,this.length);let r=t,i=1,o=this[e+--r];for(;r>0&&(i*=256);)o+=this[e+--r]*i;return i*=128,o>=i&&(o-=Math.pow(2,8*t)),o},c.prototype.readInt8=function(e,t){return e>>>=0,t||T(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},c.prototype.readInt16LE=function(e,t){e>>>=0,t||T(e,2,this.length);const n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},c.prototype.readInt16BE=function(e,t){e>>>=0,t||T(e,2,this.length);const n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},c.prototype.readInt32LE=function(e,t){return e>>>=0,t||T(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},c.prototype.readInt32BE=function(e,t){return e>>>=0,t||T(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},c.prototype.readBigInt64LE=Z((function(e){U(e>>>=0,"offset");const t=this[e],n=this[e+7];void 0!==t&&void 0!==n||W(e,this.length-8);const r=this[e+4]+256*this[e+5]+65536*this[e+6]+(n<<24);return(BigInt(r)<<BigInt(32))+BigInt(t+256*this[++e]+65536*this[++e]+this[++e]*2**24)})),c.prototype.readBigInt64BE=Z((function(e){U(e>>>=0,"offset");const t=this[e],n=this[e+7];void 0!==t&&void 0!==n||W(e,this.length-8);const r=(t<<24)+65536*this[++e]+256*this[++e]+this[++e];return(BigInt(r)<<BigInt(32))+BigInt(this[++e]*2**24+65536*this[++e]+256*this[++e]+n)})),c.prototype.readFloatLE=function(e,t){return e>>>=0,t||T(e,4,this.length),i.read(this,e,!0,23,4)},c.prototype.readFloatBE=function(e,t){return e>>>=0,t||T(e,4,this.length),i.read(this,e,!1,23,4)},c.prototype.readDoubleLE=function(e,t){return e>>>=0,t||T(e,8,this.length),i.read(this,e,!0,52,8)},c.prototype.readDoubleBE=function(e,t){return e>>>=0,t||T(e,8,this.length),i.read(this,e,!1,52,8)},c.prototype.writeUintLE=c.prototype.writeUIntLE=function(e,t,n,r){if(e=+e,t>>>=0,n>>>=0,!r){A(this,e,t,n,Math.pow(2,8*n)-1,0)}let i=1,o=0;for(this[t]=255&e;++o<n&&(i*=256);)this[t+o]=e/i&255;return t+n},c.prototype.writeUintBE=c.prototype.writeUIntBE=function(e,t,n,r){if(e=+e,t>>>=0,n>>>=0,!r){A(this,e,t,n,Math.pow(2,8*n)-1,0)}let i=n-1,o=1;for(this[t+i]=255&e;--i>=0&&(o*=256);)this[t+i]=e/o&255;return t+n},c.prototype.writeUint8=c.prototype.writeUInt8=function(e,t,n){return e=+e,t>>>=0,n||A(this,e,t,1,255,0),this[t]=255&e,t+1},c.prototype.writeUint16LE=c.prototype.writeUInt16LE=function(e,t,n){return e=+e,t>>>=0,n||A(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},c.prototype.writeUint16BE=c.prototype.writeUInt16BE=function(e,t,n){return e=+e,t>>>=0,n||A(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},c.prototype.writeUint32LE=c.prototype.writeUInt32LE=function(e,t,n){return e=+e,t>>>=0,n||A(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},c.prototype.writeUint32BE=c.prototype.writeUInt32BE=function(e,t,n){return e=+e,t>>>=0,n||A(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},c.prototype.writeBigUInt64LE=Z((function(e,t=0){return j(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))})),c.prototype.writeBigUInt64BE=Z((function(e,t=0){return M(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))})),c.prototype.writeIntLE=function(e,t,n,r){if(e=+e,t>>>=0,!r){const r=Math.pow(2,8*n-1);A(this,e,t,n,r-1,-r)}let i=0,o=1,s=0;for(this[t]=255&e;++i<n&&(o*=256);)e<0&&0===s&&0!==this[t+i-1]&&(s=1),this[t+i]=(e/o>>0)-s&255;return t+n},c.prototype.writeIntBE=function(e,t,n,r){if(e=+e,t>>>=0,!r){const r=Math.pow(2,8*n-1);A(this,e,t,n,r-1,-r)}let i=n-1,o=1,s=0;for(this[t+i]=255&e;--i>=0&&(o*=256);)e<0&&0===s&&0!==this[t+i+1]&&(s=1),this[t+i]=(e/o>>0)-s&255;return t+n},c.prototype.writeInt8=function(e,t,n){return e=+e,t>>>=0,n||A(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},c.prototype.writeInt16LE=function(e,t,n){return e=+e,t>>>=0,n||A(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},c.prototype.writeInt16BE=function(e,t,n){return e=+e,t>>>=0,n||A(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},c.prototype.writeInt32LE=function(e,t,n){return e=+e,t>>>=0,n||A(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},c.prototype.writeInt32BE=function(e,t,n){return e=+e,t>>>=0,n||A(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},c.prototype.writeBigInt64LE=Z((function(e,t=0){return j(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),c.prototype.writeBigInt64BE=Z((function(e,t=0){return M(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),c.prototype.writeFloatLE=function(e,t,n){return L(this,e,t,!0,n)},c.prototype.writeFloatBE=function(e,t,n){return L(this,e,t,!1,n)},c.prototype.writeDoubleLE=function(e,t,n){return B(this,e,t,!0,n)},c.prototype.writeDoubleBE=function(e,t,n){return B(this,e,t,!1,n)},c.prototype.copy=function(e,t,n,r){if(!c.isBuffer(e))throw new TypeError("argument should be a Buffer");if(n||(n=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);const i=r-n;return this===e&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(t,n,r):Uint8Array.prototype.set.call(e,this.subarray(n,r),t),i},c.prototype.fill=function(e,t,n,r){if("string"==typeof e){if("string"==typeof t?(r=t,t=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!c.isEncoding(r))throw new TypeError("Unknown encoding: "+r);if(1===e.length){const t=e.charCodeAt(0);("utf8"===r&&t<128||"latin1"===r)&&(e=t)}}else"number"==typeof e?e&=255:"boolean"==typeof e&&(e=Number(e));if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;let i;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"==typeof e)for(i=t;i<n;++i)this[i]=e;else{const o=c.isBuffer(e)?e:c.from(e,r),s=o.length;if(0===s)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(i=0;i<n-t;++i)this[i+t]=o[i%s]}return this};const F={};function $(e,t,n){F[e]=class extends n{constructor(){super(),Object.defineProperty(this,"message",{value:t.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${e}]`,this.stack,delete this.name}get code(){return e}set code(e){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:e,writable:!0})}toString(){return`${this.name} [${e}]: ${this.message}`}}}function q(e){let t="",n=e.length;const r="-"===e[0]?1:0;for(;n>=r+4;n-=3)t=`_${e.slice(n-3,n)}${t}`;return`${e.slice(0,n)}${t}`}function K(e,t,n,r,i,o){if(e>n||e<t){const r="bigint"==typeof t?"n":"";let i;throw i=o>3?0===t||t===BigInt(0)?`>= 0${r} and < 2${r} ** ${8*(o+1)}${r}`:`>= -(2${r} ** ${8*(o+1)-1}${r}) and < 2 ** ${8*(o+1)-1}${r}`:`>= ${t}${r} and <= ${n}${r}`,new F.ERR_OUT_OF_RANGE("value",i,e)}!function(e,t,n){U(t,"offset"),void 0!==e[t]&&void 0!==e[t+n]||W(t,e.length-(n+1))}(r,i,o)}function U(e,t){if("number"!=typeof e)throw new F.ERR_INVALID_ARG_TYPE(t,"number",e)}function W(e,t,n){if(Math.floor(e)!==e)throw U(e,n),new F.ERR_OUT_OF_RANGE(n||"offset","an integer",e);if(t<0)throw new F.ERR_BUFFER_OUT_OF_BOUNDS;throw new F.ERR_OUT_OF_RANGE(n||"offset",`>= ${n?1:0} and <= ${t}`,e)}$("ERR_BUFFER_OUT_OF_BOUNDS",(function(e){return e?`${e} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"}),RangeError),$("ERR_INVALID_ARG_TYPE",(function(e,t){return`The "${e}" argument must be of type number. Received type ${typeof t}`}),TypeError),$("ERR_OUT_OF_RANGE",(function(e,t,n){let r=`The value of "${e}" is out of range.`,i=n;return Number.isInteger(n)&&Math.abs(n)>2**32?i=q(String(n)):"bigint"==typeof n&&(i=String(n),(n>BigInt(2)**BigInt(32)||n<-(BigInt(2)**BigInt(32)))&&(i=q(i)),i+="n"),r+=` It must be ${t}. Received ${i}`,r}),RangeError);const z=/[^+/0-9A-Za-z-_]/g;function H(e,t){let n;t=t||1/0;const r=e.length;let i=null;const o=[];for(let s=0;s<r;++s){if(n=e.charCodeAt(s),n>55295&&n<57344){if(!i){if(n>56319){(t-=3)>-1&&o.push(239,191,189);continue}if(s+1===r){(t-=3)>-1&&o.push(239,191,189);continue}i=n;continue}if(n<56320){(t-=3)>-1&&o.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&(t-=3)>-1&&o.push(239,191,189);if(i=null,n<128){if((t-=1)<0)break;o.push(n)}else if(n<2048){if((t-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return o}function Q(e){return r.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(z,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function V(e,t,n,r){let i;for(i=0;i<r&&!(i+n>=t.length||i>=e.length);++i)t[i+n]=e[i];return i}function Y(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function G(e){return e!=e}const J=function(){const e="0123456789abcdef",t=new Array(256);for(let n=0;n<16;++n){const r=16*n;for(let i=0;i<16;++i)t[r+i]=e[n]+e[i]}return t}();function Z(e){return"undefined"==typeof BigInt?X:e}function X(){throw new Error("BigInt not supported")}},1227:(e,t,n)=>{var r=n(4155);t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;const n="color: "+this.color;t.splice(1,0,n,"color: inherit");let r=0,i=0;t[0].replace(/%[a-zA-Z%]/g,(e=>{"%%"!==e&&(r++,"%c"===e&&(i=r))})),t.splice(i,0,n)},t.save=function(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch(e){}},t.load=function(){let e;try{e=t.storage.getItem("debug")}catch(e){}!e&&void 0!==r&&"env"in r&&(e=r.env.DEBUG);return e},t.useColors=function(){if("undefined"!=typeof window&&window.process&&("renderer"===window.process.type||window.process.__nwjs))return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},t.storage=function(){try{return localStorage}catch(e){}}(),t.destroy=(()=>{let e=!1;return()=>{e||(e=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.log=console.debug||console.log||(()=>{}),e.exports=n(2447)(t);const{formatters:i}=e.exports;i.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}},2447:(e,t,n)=>{e.exports=function(e){function t(e){let n,i,o,s=null;function a(...e){if(!a.enabled)return;const r=a,i=Number(new Date),o=i-(n||i);r.diff=o,r.prev=n,r.curr=i,n=i,e[0]=t.coerce(e[0]),"string"!=typeof e[0]&&e.unshift("%O");let s=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,((n,i)=>{if("%%"===n)return"%";s++;const o=t.formatters[i];if("function"==typeof o){const t=e[s];n=o.call(r,t),e.splice(s,1),s--}return n})),t.formatArgs.call(r,e);(r.log||t.log).apply(r,e)}return a.namespace=e,a.useColors=t.useColors(),a.color=t.selectColor(e),a.extend=r,a.destroy=t.destroy,Object.defineProperty(a,"enabled",{enumerable:!0,configurable:!1,get:()=>null!==s?s:(i!==t.namespaces&&(i=t.namespaces,o=t.enabled(e)),o),set:e=>{s=e}}),"function"==typeof t.init&&t.init(a),a}function r(e,n){const r=t(this.namespace+(void 0===n?":":n)+e);return r.log=this.log,r}function i(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return t.debug=t,t.default=t,t.coerce=function(e){if(e instanceof Error)return e.stack||e.message;return e},t.disable=function(){const e=[...t.names.map(i),...t.skips.map(i).map((e=>"-"+e))].join(",");return t.enable(""),e},t.enable=function(e){let n;t.save(e),t.namespaces=e,t.names=[],t.skips=[];const r=("string"==typeof e?e:"").split(/[\s,]+/),i=r.length;for(n=0;n<i;n++)r[n]&&("-"===(e=r[n].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.slice(1)+"$")):t.names.push(new RegExp("^"+e+"$")))},t.enabled=function(e){if("*"===e[e.length-1])return!0;let n,r;for(n=0,r=t.skips.length;n<r;n++)if(t.skips[n].test(e))return!1;for(n=0,r=t.names.length;n<r;n++)if(t.names[n].test(e))return!0;return!1},t.humanize=n(7824),t.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(e).forEach((n=>{t[n]=e[n]})),t.names=[],t.skips=[],t.formatters={},t.selectColor=function(e){let n=0;for(let t=0;t<e.length;t++)n=(n<<5)-n+e.charCodeAt(t),n|=0;return t.colors[Math.abs(n)%t.colors.length]},t.enable(t.load()),t}},2114:e=>{"use strict";function t(e,t){for(const n in t)Object.defineProperty(e,n,{value:t[n],enumerable:!0,configurable:!0});return e}e.exports=function(e,n,r){if(!e||"string"==typeof e)throw new TypeError("Please pass an Error to err-code");r||(r={}),"object"==typeof n&&(r=n,n=""),n&&(r.code=n);try{return t(e,r)}catch(n){r.message=e.message,r.stack=e.stack;const i=function(){};i.prototype=Object.create(Object.getPrototypeOf(e));return t(new i,r)}}},7187:e=>{"use strict";var t,n="object"==typeof Reflect?Reflect:null,r=n&&"function"==typeof n.apply?n.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)};t=n&&"function"==typeof n.ownKeys?n.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var i=Number.isNaN||function(e){return e!=e};function o(){o.init.call(this)}e.exports=o,e.exports.once=function(e,t){return new Promise((function(n,r){function i(n){e.removeListener(t,o),r(n)}function o(){"function"==typeof e.removeListener&&e.removeListener("error",i),n([].slice.call(arguments))}m(e,t,o,{once:!0}),"error"!==t&&function(e,t,n){"function"==typeof e.on&&m(e,"error",t,n)}(e,i,{once:!0})}))},o.EventEmitter=o,o.prototype._events=void 0,o.prototype._eventsCount=0,o.prototype._maxListeners=void 0;var s=10;function a(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function c(e){return void 0===e._maxListeners?o.defaultMaxListeners:e._maxListeners}function u(e,t,n,r){var i,o,s,u;if(a(n),void 0===(o=e._events)?(o=e._events=Object.create(null),e._eventsCount=0):(void 0!==o.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),o=e._events),s=o[t]),void 0===s)s=o[t]=n,++e._eventsCount;else if("function"==typeof s?s=o[t]=r?[n,s]:[s,n]:r?s.unshift(n):s.push(n),(i=c(e))>0&&s.length>i&&!s.warned){s.warned=!0;var l=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");l.name="MaxListenersExceededWarning",l.emitter=e,l.type=t,l.count=s.length,u=l,console&&console.warn&&console.warn(u)}return e}function l(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function h(e,t,n){var r={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},i=l.bind(r);return i.listener=n,r.wrapFn=i,i}function d(e,t,n){var r=e._events;if(void 0===r)return[];var i=r[t];return void 0===i?[]:"function"==typeof i?n?[i.listener||i]:[i]:n?function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(i):p(i,i.length)}function f(e){var t=this._events;if(void 0!==t){var n=t[e];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function p(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e[r];return n}function m(e,t,n,r){if("function"==typeof e.on)r.once?e.once(t,n):e.on(t,n);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function i(o){r.once&&e.removeEventListener(t,i),n(o)}))}}Object.defineProperty(o,"defaultMaxListeners",{enumerable:!0,get:function(){return s},set:function(e){if("number"!=typeof e||e<0||i(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");s=e}}),o.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},o.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||i(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},o.prototype.getMaxListeners=function(){return c(this)},o.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var i="error"===e,o=this._events;if(void 0!==o)i=i&&void 0===o.error;else if(!i)return!1;if(i){var s;if(t.length>0&&(s=t[0]),s instanceof Error)throw s;var a=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw a.context=s,a}var c=o[e];if(void 0===c)return!1;if("function"==typeof c)r(c,this,t);else{var u=c.length,l=p(c,u);for(n=0;n<u;++n)r(l[n],this,t)}return!0},o.prototype.addListener=function(e,t){return u(this,e,t,!1)},o.prototype.on=o.prototype.addListener,o.prototype.prependListener=function(e,t){return u(this,e,t,!0)},o.prototype.once=function(e,t){return a(t),this.on(e,h(this,e,t)),this},o.prototype.prependOnceListener=function(e,t){return a(t),this.prependListener(e,h(this,e,t)),this},o.prototype.removeListener=function(e,t){var n,r,i,o,s;if(a(t),void 0===(r=this._events))return this;if(void 0===(n=r[e]))return this;if(n===t||n.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete r[e],r.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(i=-1,o=n.length-1;o>=0;o--)if(n[o]===t||n[o].listener===t){s=n[o].listener,i=o;break}if(i<0)return this;0===i?n.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(n,i),1===n.length&&(r[e]=n[0]),void 0!==r.removeListener&&this.emit("removeListener",e,s||t)}return this},o.prototype.off=o.prototype.removeListener,o.prototype.removeAllListeners=function(e){var t,n,r;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[e]),this;if(0===arguments.length){var i,o=Object.keys(n);for(r=0;r<o.length;++r)"removeListener"!==(i=o[r])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(void 0!==t)for(r=t.length-1;r>=0;r--)this.removeListener(e,t[r]);return this},o.prototype.listeners=function(e){return d(this,e,!0)},o.prototype.rawListeners=function(e){return d(this,e,!1)},o.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):f.call(e,t)},o.prototype.listenerCount=f,o.prototype.eventNames=function(){return this._eventsCount>0?t(this._events):[]}},5177:e=>{e.exports=function(){if("undefined"==typeof globalThis)return null;var e={RTCPeerConnection:globalThis.RTCPeerConnection||globalThis.mozRTCPeerConnection||globalThis.webkitRTCPeerConnection,RTCSessionDescription:globalThis.RTCSessionDescription||globalThis.mozRTCSessionDescription||globalThis.webkitRTCSessionDescription,RTCIceCandidate:globalThis.RTCIceCandidate||globalThis.mozRTCIceCandidate||globalThis.webkitRTCIceCandidate};return e.RTCPeerConnection?e:null}},645:(e,t)=>{t.read=function(e,t,n,r,i){var o,s,a=8*i-r-1,c=(1<<a)-1,u=c>>1,l=-7,h=n?i-1:0,d=n?-1:1,f=e[t+h];for(h+=d,o=f&(1<<-l)-1,f>>=-l,l+=a;l>0;o=256*o+e[t+h],h+=d,l-=8);for(s=o&(1<<-l)-1,o>>=-l,l+=r;l>0;s=256*s+e[t+h],h+=d,l-=8);if(0===o)o=1-u;else{if(o===c)return s?NaN:1/0*(f?-1:1);s+=Math.pow(2,r),o-=u}return(f?-1:1)*s*Math.pow(2,o-r)},t.write=function(e,t,n,r,i,o){var s,a,c,u=8*o-i-1,l=(1<<u)-1,h=l>>1,d=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,f=r?0:o-1,p=r?1:-1,m=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,s=l):(s=Math.floor(Math.log(t)/Math.LN2),t*(c=Math.pow(2,-s))<1&&(s--,c*=2),(t+=s+h>=1?d/c:d*Math.pow(2,1-h))*c>=2&&(s++,c/=2),s+h>=l?(a=0,s=l):s+h>=1?(a=(t*c-1)*Math.pow(2,i),s+=h):(a=t*Math.pow(2,h-1)*Math.pow(2,i),s=0));i>=8;e[n+f]=255&a,f+=p,a/=256,i-=8);for(s=s<<i|a,u+=i;u>0;e[n+f]=255&s,f+=p,s/=256,u-=8);e[n+f-p]|=128*m}},5717:e=>{"function"==typeof Object.create?e.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:e.exports=function(e,t){if(t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}}},7824:e=>{var t=1e3,n=60*t,r=60*n,i=24*r,o=7*i,s=365.25*i;function a(e,t,n,r){var i=t>=1.5*n;return Math.round(e/n)+" "+r+(i?"s":"")}e.exports=function(e,c){c=c||{};var u=typeof e;if("string"===u&&e.length>0)return function(e){if((e=String(e)).length>100)return;var a=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(!a)return;var c=parseFloat(a[1]);switch((a[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return c*s;case"weeks":case"week":case"w":return c*o;case"days":case"day":case"d":return c*i;case"hours":case"hour":case"hrs":case"hr":case"h":return c*r;case"minutes":case"minute":case"mins":case"min":case"m":return c*n;case"seconds":case"second":case"secs":case"sec":case"s":return c*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return c;default:return}}(e);if("number"===u&&isFinite(e))return c.long?function(e){var o=Math.abs(e);if(o>=i)return a(e,o,i,"day");if(o>=r)return a(e,o,r,"hour");if(o>=n)return a(e,o,n,"minute");if(o>=t)return a(e,o,t,"second");return e+" ms"}(e):function(e){var o=Math.abs(e);if(o>=i)return Math.round(e/i)+"d";if(o>=r)return Math.round(e/r)+"h";if(o>=n)return Math.round(e/n)+"m";if(o>=t)return Math.round(e/t)+"s";return e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},4155:e=>{var t,n,r=e.exports={};function i(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function s(e){if(t===setTimeout)return setTimeout(e,0);if((t===i||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(n){try{return t.call(null,e,0)}catch(n){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:i}catch(e){t=i}try{n="function"==typeof clearTimeout?clearTimeout:o}catch(e){n=o}}();var a,c=[],u=!1,l=-1;function h(){u&&a&&(u=!1,a.length?c=a.concat(c):l=-1,c.length&&d())}function d(){if(!u){var e=s(h);u=!0;for(var t=c.length;t;){for(a=c,c=[];++l<t;)a&&a[l].run();l=-1,t=c.length}a=null,u=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===o||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{return n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function f(e,t){this.fun=e,this.array=t}function p(){}r.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];c.push(new f(e,t)),1!==c.length||u||s(d)},f.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=p,r.addListener=p,r.once=p,r.off=p,r.removeListener=p,r.removeAllListeners=p,r.emit=p,r.prependListener=p,r.prependOnceListener=p,r.listeners=function(e){return[]},r.binding=function(e){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(e){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},4375:(e,t,n)=>{let r;e.exports="function"==typeof queueMicrotask?queueMicrotask.bind("undefined"!=typeof window?window:n.g):e=>(r||(r=Promise.resolve())).then(e).catch((e=>setTimeout((()=>{throw e}),0)))},1798:(e,t,n)=>{"use strict";var r=n(4155),i=65536,o=4294967295;var s=n(9509).Buffer,a=n.g.crypto||n.g.msCrypto;a&&a.getRandomValues?e.exports=function(e,t){if(e>o)throw new RangeError("requested too many random bytes");var n=s.allocUnsafe(e);if(e>0)if(e>i)for(var c=0;c<e;c+=i)a.getRandomValues(n.slice(c,c+i));else a.getRandomValues(n);if("function"==typeof t)return r.nextTick((function(){t(null,n)}));return n}:e.exports=function(){throw new Error("Secure random number generation is not supported by this browser.\nUse Chrome, Firefox or Internet Explorer 11")}},4281:e=>{"use strict";var t={};function n(e,n,r){r||(r=Error);var i=function(e){var t,r;function i(t,r,i){return e.call(this,function(e,t,r){return"string"==typeof n?n:n(e,t,r)}(t,r,i))||this}return r=e,(t=i).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r,i}(r);i.prototype.name=r.name,i.prototype.code=e,t[e]=i}function r(e,t){if(Array.isArray(e)){var n=e.length;return e=e.map((function(e){return String(e)})),n>2?"one of ".concat(t," ").concat(e.slice(0,n-1).join(", "),", or ")+e[n-1]:2===n?"one of ".concat(t," ").concat(e[0]," or ").concat(e[1]):"of ".concat(t," ").concat(e[0])}return"of ".concat(t," ").concat(String(e))}n("ERR_INVALID_OPT_VALUE",(function(e,t){return'The value "'+t+'" is invalid for option "'+e+'"'}),TypeError),n("ERR_INVALID_ARG_TYPE",(function(e,t,n){var i,o,s,a;if("string"==typeof t&&(o="not ",t.substr(!s||s<0?0:+s,o.length)===o)?(i="must not be",t=t.replace(/^not /,"")):i="must be",function(e,t,n){return(void 0===n||n>e.length)&&(n=e.length),e.substring(n-t.length,n)===t}(e," argument"))a="The ".concat(e," ").concat(i," ").concat(r(t,"type"));else{var c=function(e,t,n){return"number"!=typeof n&&(n=0),!(n+t.length>e.length)&&-1!==e.indexOf(t,n)}(e,".")?"property":"argument";a='The "'.concat(e,'" ').concat(c," ").concat(i," ").concat(r(t,"type"))}return a+=". Received type ".concat(typeof n)}),TypeError),n("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),n("ERR_METHOD_NOT_IMPLEMENTED",(function(e){return"The "+e+" method is not implemented"})),n("ERR_STREAM_PREMATURE_CLOSE","Premature close"),n("ERR_STREAM_DESTROYED",(function(e){return"Cannot call "+e+" after a stream was destroyed"})),n("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),n("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),n("ERR_STREAM_WRITE_AFTER_END","write after end"),n("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),n("ERR_UNKNOWN_ENCODING",(function(e){return"Unknown encoding: "+e}),TypeError),n("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),e.exports.q=t},6753:(e,t,n)=>{"use strict";var r=n(4155),i=Object.keys||function(e){var t=[];for(var n in e)t.push(n);return t};e.exports=l;var o=n(9481),s=n(4229);n(5717)(l,o);for(var a=i(s.prototype),c=0;c<a.length;c++){var u=a[c];l.prototype[u]||(l.prototype[u]=s.prototype[u])}function l(e){if(!(this instanceof l))return new l(e);o.call(this,e),s.call(this,e),this.allowHalfOpen=!0,e&&(!1===e.readable&&(this.readable=!1),!1===e.writable&&(this.writable=!1),!1===e.allowHalfOpen&&(this.allowHalfOpen=!1,this.once("end",h)))}function h(){this._writableState.ended||r.nextTick(d,this)}function d(e){e.end()}Object.defineProperty(l.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(l.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(l.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(l.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed&&this._writableState.destroyed)},set:function(e){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}})},2725:(e,t,n)=>{"use strict";e.exports=i;var r=n(4605);function i(e){if(!(this instanceof i))return new i(e);r.call(this,e)}n(5717)(i,r),i.prototype._transform=function(e,t,n){n(null,e)}},9481:(e,t,n)=>{"use strict";var r,i=n(4155);e.exports=x,x.ReadableState=S;n(7187).EventEmitter;var o=function(e,t){return e.listeners(t).length},s=n(2503),a=n(8764).Buffer,c=(void 0!==n.g?n.g:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{}).Uint8Array||function(){};var u,l=n(4616);u=l&&l.debuglog?l.debuglog("stream"):function(){};var h,d,f,p=n(7327),m=n(1195),y=n(2457).getHighWaterMark,v=n(4281).q,g=v.ERR_INVALID_ARG_TYPE,b=v.ERR_STREAM_PUSH_AFTER_EOF,w=v.ERR_METHOD_NOT_IMPLEMENTED,_=v.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;n(5717)(x,s);var E=m.errorOrDestroy,k=["error","close","destroy","pause","resume"];function S(e,t,i){r=r||n(6753),e=e||{},"boolean"!=typeof i&&(i=t instanceof r),this.objectMode=!!e.objectMode,i&&(this.objectMode=this.objectMode||!!e.readableObjectMode),this.highWaterMark=y(this,e,"readableHighWaterMark",i),this.buffer=new p,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=!1!==e.emitClose,this.autoDestroy=!!e.autoDestroy,this.destroyed=!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(h||(h=n(2553).s),this.decoder=new h(e.encoding),this.encoding=e.encoding)}function x(e){if(r=r||n(6753),!(this instanceof x))return new x(e);var t=this instanceof r;this._readableState=new S(e,this,t),this.readable=!0,e&&("function"==typeof e.read&&(this._read=e.read),"function"==typeof e.destroy&&(this._destroy=e.destroy)),s.call(this)}function C(e,t,n,r,i){u("readableAddChunk",t);var o,s=e._readableState;if(null===t)s.reading=!1,function(e,t){if(u("onEofChunk"),t.ended)return;if(t.decoder){var n=t.decoder.end();n&&n.length&&(t.buffer.push(n),t.length+=t.objectMode?1:n.length)}t.ended=!0,t.sync?P(e):(t.needReadable=!1,t.emittedReadable||(t.emittedReadable=!0,D(e)))}(e,s);else if(i||(o=function(e,t){var n;r=t,a.isBuffer(r)||r instanceof c||"string"==typeof t||void 0===t||e.objectMode||(n=new g("chunk",["string","Buffer","Uint8Array"],t));var r;return n}(s,t)),o)E(e,o);else if(s.objectMode||t&&t.length>0)if("string"==typeof t||s.objectMode||Object.getPrototypeOf(t)===a.prototype||(t=function(e){return a.from(e)}(t)),r)s.endEmitted?E(e,new _):O(e,s,t,!0);else if(s.ended)E(e,new b);else{if(s.destroyed)return!1;s.reading=!1,s.decoder&&!n?(t=s.decoder.write(t),s.objectMode||0!==t.length?O(e,s,t,!1):T(e,s)):O(e,s,t,!1)}else r||(s.reading=!1,T(e,s));return!s.ended&&(s.length<s.highWaterMark||0===s.length)}function O(e,t,n,r){t.flowing&&0===t.length&&!t.sync?(t.awaitDrain=0,e.emit("data",n)):(t.length+=t.objectMode?1:n.length,r?t.buffer.unshift(n):t.buffer.push(n),t.needReadable&&P(e)),T(e,t)}Object.defineProperty(x.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}}),x.prototype.destroy=m.destroy,x.prototype._undestroy=m.undestroy,x.prototype._destroy=function(e,t){t(e)},x.prototype.push=function(e,t){var n,r=this._readableState;return r.objectMode?n=!0:"string"==typeof e&&((t=t||r.defaultEncoding)!==r.encoding&&(e=a.from(e,t),t=""),n=!0),C(this,e,t,!1,n)},x.prototype.unshift=function(e){return C(this,e,null,!0,!1)},x.prototype.isPaused=function(){return!1===this._readableState.flowing},x.prototype.setEncoding=function(e){h||(h=n(2553).s);var t=new h(e);this._readableState.decoder=t,this._readableState.encoding=this._readableState.decoder.encoding;for(var r=this._readableState.buffer.head,i="";null!==r;)i+=t.write(r.data),r=r.next;return this._readableState.buffer.clear(),""!==i&&this._readableState.buffer.push(i),this._readableState.length=i.length,this};var R=1073741824;function I(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:e!=e?t.flowing&&t.length?t.buffer.head.data.length:t.length:(e>t.highWaterMark&&(t.highWaterMark=function(e){return e>=R?e=R:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}(e)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0))}function P(e){var t=e._readableState;u("emitReadable",t.needReadable,t.emittedReadable),t.needReadable=!1,t.emittedReadable||(u("emitReadable",t.flowing),t.emittedReadable=!0,i.nextTick(D,e))}function D(e){var t=e._readableState;u("emitReadable_",t.destroyed,t.length,t.ended),t.destroyed||!t.length&&!t.ended||(e.emit("readable"),t.emittedReadable=!1),t.needReadable=!t.flowing&&!t.ended&&t.length<=t.highWaterMark,L(e)}function T(e,t){t.readingMore||(t.readingMore=!0,i.nextTick(A,e,t))}function A(e,t){for(;!t.reading&&!t.ended&&(t.length<t.highWaterMark||t.flowing&&0===t.length);){var n=t.length;if(u("maybeReadMore read 0"),e.read(0),n===t.length)break}t.readingMore=!1}function j(e){var t=e._readableState;t.readableListening=e.listenerCount("readable")>0,t.resumeScheduled&&!t.paused?t.flowing=!0:e.listenerCount("data")>0&&e.resume()}function M(e){u("readable nexttick read 0"),e.read(0)}function N(e,t){u("resume",t.reading),t.reading||e.read(0),t.resumeScheduled=!1,e.emit("resume"),L(e),t.flowing&&!t.reading&&e.read(0)}function L(e){var t=e._readableState;for(u("flow",t.flowing);t.flowing&&null!==e.read(););}function B(e,t){return 0===t.length?null:(t.objectMode?n=t.buffer.shift():!e||e>=t.length?(n=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.first():t.buffer.concat(t.length),t.buffer.clear()):n=t.buffer.consume(e,t.decoder),n);var n}function F(e){var t=e._readableState;u("endReadable",t.endEmitted),t.endEmitted||(t.ended=!0,i.nextTick($,t,e))}function $(e,t){if(u("endReadableNT",e.endEmitted,e.length),!e.endEmitted&&0===e.length&&(e.endEmitted=!0,t.readable=!1,t.emit("end"),e.autoDestroy)){var n=t._writableState;(!n||n.autoDestroy&&n.finished)&&t.destroy()}}function q(e,t){for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1}x.prototype.read=function(e){u("read",e),e=parseInt(e,10);var t=this._readableState,n=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&((0!==t.highWaterMark?t.length>=t.highWaterMark:t.length>0)||t.ended))return u("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?F(this):P(this),null;if(0===(e=I(e,t))&&t.ended)return 0===t.length&&F(this),null;var r,i=t.needReadable;return u("need readable",i),(0===t.length||t.length-e<t.highWaterMark)&&u("length less than watermark",i=!0),t.ended||t.reading?u("reading or ended",i=!1):i&&(u("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=I(n,t))),null===(r=e>0?B(e,t):null)?(t.needReadable=t.length<=t.highWaterMark,e=0):(t.length-=e,t.awaitDrain=0),0===t.length&&(t.ended||(t.needReadable=!0),n!==e&&t.ended&&F(this)),null!==r&&this.emit("data",r),r},x.prototype._read=function(e){E(this,new w("_read()"))},x.prototype.pipe=function(e,t){var n=this,r=this._readableState;switch(r.pipesCount){case 0:r.pipes=e;break;case 1:r.pipes=[r.pipes,e];break;default:r.pipes.push(e)}r.pipesCount+=1,u("pipe count=%d opts=%j",r.pipesCount,t);var s=(!t||!1!==t.end)&&e!==i.stdout&&e!==i.stderr?c:y;function a(t,i){u("onunpipe"),t===n&&i&&!1===i.hasUnpiped&&(i.hasUnpiped=!0,u("cleanup"),e.removeListener("close",p),e.removeListener("finish",m),e.removeListener("drain",l),e.removeListener("error",f),e.removeListener("unpipe",a),n.removeListener("end",c),n.removeListener("end",y),n.removeListener("data",d),h=!0,!r.awaitDrain||e._writableState&&!e._writableState.needDrain||l())}function c(){u("onend"),e.end()}r.endEmitted?i.nextTick(s):n.once("end",s),e.on("unpipe",a);var l=function(e){return function(){var t=e._readableState;u("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&o(e,"data")&&(t.flowing=!0,L(e))}}(n);e.on("drain",l);var h=!1;function d(t){u("ondata");var i=e.write(t);u("dest.write",i),!1===i&&((1===r.pipesCount&&r.pipes===e||r.pipesCount>1&&-1!==q(r.pipes,e))&&!h&&(u("false write response, pause",r.awaitDrain),r.awaitDrain++),n.pause())}function f(t){u("onerror",t),y(),e.removeListener("error",f),0===o(e,"error")&&E(e,t)}function p(){e.removeListener("finish",m),y()}function m(){u("onfinish"),e.removeListener("close",p),y()}function y(){u("unpipe"),n.unpipe(e)}return n.on("data",d),function(e,t,n){if("function"==typeof e.prependListener)return e.prependListener(t,n);e._events&&e._events[t]?Array.isArray(e._events[t])?e._events[t].unshift(n):e._events[t]=[n,e._events[t]]:e.on(t,n)}(e,"error",f),e.once("close",p),e.once("finish",m),e.emit("pipe",n),r.flowing||(u("pipe resume"),n.resume()),e},x.prototype.unpipe=function(e){var t=this._readableState,n={hasUnpiped:!1};if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes||(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this,n)),this;if(!e){var r=t.pipes,i=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var o=0;o<i;o++)r[o].emit("unpipe",this,{hasUnpiped:!1});return this}var s=q(t.pipes,e);return-1===s||(t.pipes.splice(s,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this,n)),this},x.prototype.on=function(e,t){var n=s.prototype.on.call(this,e,t),r=this._readableState;return"data"===e?(r.readableListening=this.listenerCount("readable")>0,!1!==r.flowing&&this.resume()):"readable"===e&&(r.endEmitted||r.readableListening||(r.readableListening=r.needReadable=!0,r.flowing=!1,r.emittedReadable=!1,u("on readable",r.length,r.reading),r.length?P(this):r.reading||i.nextTick(M,this))),n},x.prototype.addListener=x.prototype.on,x.prototype.removeListener=function(e,t){var n=s.prototype.removeListener.call(this,e,t);return"readable"===e&&i.nextTick(j,this),n},x.prototype.removeAllListeners=function(e){var t=s.prototype.removeAllListeners.apply(this,arguments);return"readable"!==e&&void 0!==e||i.nextTick(j,this),t},x.prototype.resume=function(){var e=this._readableState;return e.flowing||(u("resume"),e.flowing=!e.readableListening,function(e,t){t.resumeScheduled||(t.resumeScheduled=!0,i.nextTick(N,e,t))}(this,e)),e.paused=!1,this},x.prototype.pause=function(){return u("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(u("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},x.prototype.wrap=function(e){var t=this,n=this._readableState,r=!1;for(var i in e.on("end",(function(){if(u("wrapped end"),n.decoder&&!n.ended){var e=n.decoder.end();e&&e.length&&t.push(e)}t.push(null)})),e.on("data",(function(i){(u("wrapped data"),n.decoder&&(i=n.decoder.write(i)),n.objectMode&&null==i)||(n.objectMode||i&&i.length)&&(t.push(i)||(r=!0,e.pause()))})),e)void 0===this[i]&&"function"==typeof e[i]&&(this[i]=function(t){return function(){return e[t].apply(e,arguments)}}(i));for(var o=0;o<k.length;o++)e.on(k[o],this.emit.bind(this,k[o]));return this._read=function(t){u("wrapped _read",t),r&&(r=!1,e.resume())},this},"function"==typeof Symbol&&(x.prototype[Symbol.asyncIterator]=function(){return void 0===d&&(d=n(5850)),d(this)}),Object.defineProperty(x.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(x.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(x.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(e){this._readableState&&(this._readableState.flowing=e)}}),x._fromList=B,Object.defineProperty(x.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),"function"==typeof Symbol&&(x.from=function(e,t){return void 0===f&&(f=n(5167)),f(x,e,t)})},4605:(e,t,n)=>{"use strict";e.exports=l;var r=n(4281).q,i=r.ERR_METHOD_NOT_IMPLEMENTED,o=r.ERR_MULTIPLE_CALLBACK,s=r.ERR_TRANSFORM_ALREADY_TRANSFORMING,a=r.ERR_TRANSFORM_WITH_LENGTH_0,c=n(6753);function u(e,t){var n=this._transformState;n.transforming=!1;var r=n.writecb;if(null===r)return this.emit("error",new o);n.writechunk=null,n.writecb=null,null!=t&&this.push(t),r(e);var i=this._readableState;i.reading=!1,(i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}function l(e){if(!(this instanceof l))return new l(e);c.call(this,e),this._transformState={afterTransform:u.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,e&&("function"==typeof e.transform&&(this._transform=e.transform),"function"==typeof e.flush&&(this._flush=e.flush)),this.on("prefinish",h)}function h(){var e=this;"function"!=typeof this._flush||this._readableState.destroyed?d(this,null,null):this._flush((function(t,n){d(e,t,n)}))}function d(e,t,n){if(t)return e.emit("error",t);if(null!=n&&e.push(n),e._writableState.length)throw new a;if(e._transformState.transforming)throw new s;return e.push(null)}n(5717)(l,c),l.prototype.push=function(e,t){return this._transformState.needTransform=!1,c.prototype.push.call(this,e,t)},l.prototype._transform=function(e,t,n){n(new i("_transform()"))},l.prototype._write=function(e,t,n){var r=this._transformState;if(r.writecb=n,r.writechunk=e,r.writeencoding=t,!r.transforming){var i=this._readableState;(r.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},l.prototype._read=function(e){var t=this._transformState;null===t.writechunk||t.transforming?t.needTransform=!0:(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform))},l.prototype._destroy=function(e,t){c.prototype._destroy.call(this,e,(function(e){t(e)}))}},4229:(e,t,n)=>{"use strict";var r,i=n(4155);function o(e){var t=this;this.next=null,this.entry=null,this.finish=function(){!function(e,t,n){var r=e.entry;e.entry=null;for(;r;){var i=r.callback;t.pendingcb--,i(n),r=r.next}t.corkedRequestsFree.next=e}(t,e)}}e.exports=x,x.WritableState=S;var s={deprecate:n(4927)},a=n(2503),c=n(8764).Buffer,u=(void 0!==n.g?n.g:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{}).Uint8Array||function(){};var l,h=n(1195),d=n(2457).getHighWaterMark,f=n(4281).q,p=f.ERR_INVALID_ARG_TYPE,m=f.ERR_METHOD_NOT_IMPLEMENTED,y=f.ERR_MULTIPLE_CALLBACK,v=f.ERR_STREAM_CANNOT_PIPE,g=f.ERR_STREAM_DESTROYED,b=f.ERR_STREAM_NULL_VALUES,w=f.ERR_STREAM_WRITE_AFTER_END,_=f.ERR_UNKNOWN_ENCODING,E=h.errorOrDestroy;function k(){}function S(e,t,s){r=r||n(6753),e=e||{},"boolean"!=typeof s&&(s=t instanceof r),this.objectMode=!!e.objectMode,s&&(this.objectMode=this.objectMode||!!e.writableObjectMode),this.highWaterMark=d(this,e,"writableHighWaterMark",s),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var a=!1===e.decodeStrings;this.decodeStrings=!a,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){!function(e,t){var n=e._writableState,r=n.sync,o=n.writecb;if("function"!=typeof o)throw new y;if(function(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}(n),t)!function(e,t,n,r,o){--t.pendingcb,n?(i.nextTick(o,r),i.nextTick(D,e,t),e._writableState.errorEmitted=!0,E(e,r)):(o(r),e._writableState.errorEmitted=!0,E(e,r),D(e,t))}(e,n,r,t,o);else{var s=I(n)||e.destroyed;s||n.corked||n.bufferProcessing||!n.bufferedRequest||R(e,n),r?i.nextTick(O,e,n,s,o):O(e,n,s,o)}}(t,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!1!==e.emitClose,this.autoDestroy=!!e.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new o(this)}function x(e){var t=this instanceof(r=r||n(6753));if(!t&&!l.call(x,this))return new x(e);this._writableState=new S(e,this,t),this.writable=!0,e&&("function"==typeof e.write&&(this._write=e.write),"function"==typeof e.writev&&(this._writev=e.writev),"function"==typeof e.destroy&&(this._destroy=e.destroy),"function"==typeof e.final&&(this._final=e.final)),a.call(this)}function C(e,t,n,r,i,o,s){t.writelen=r,t.writecb=s,t.writing=!0,t.sync=!0,t.destroyed?t.onwrite(new g("write")):n?e._writev(i,t.onwrite):e._write(i,o,t.onwrite),t.sync=!1}function O(e,t,n,r){n||function(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}(e,t),t.pendingcb--,r(),D(e,t)}function R(e,t){t.bufferProcessing=!0;var n=t.bufferedRequest;if(e._writev&&n&&n.next){var r=t.bufferedRequestCount,i=new Array(r),s=t.corkedRequestsFree;s.entry=n;for(var a=0,c=!0;n;)i[a]=n,n.isBuf||(c=!1),n=n.next,a+=1;i.allBuffers=c,C(e,t,!0,t.length,i,"",s.finish),t.pendingcb++,t.lastBufferedRequest=null,s.next?(t.corkedRequestsFree=s.next,s.next=null):t.corkedRequestsFree=new o(t),t.bufferedRequestCount=0}else{for(;n;){var u=n.chunk,l=n.encoding,h=n.callback;if(C(e,t,!1,t.objectMode?1:u.length,u,l,h),n=n.next,t.bufferedRequestCount--,t.writing)break}null===n&&(t.lastBufferedRequest=null)}t.bufferedRequest=n,t.bufferProcessing=!1}function I(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function P(e,t){e._final((function(n){t.pendingcb--,n&&E(e,n),t.prefinished=!0,e.emit("prefinish"),D(e,t)}))}function D(e,t){var n=I(t);if(n&&(function(e,t){t.prefinished||t.finalCalled||("function"!=typeof e._final||t.destroyed?(t.prefinished=!0,e.emit("prefinish")):(t.pendingcb++,t.finalCalled=!0,i.nextTick(P,e,t)))}(e,t),0===t.pendingcb&&(t.finished=!0,e.emit("finish"),t.autoDestroy))){var r=e._readableState;(!r||r.autoDestroy&&r.endEmitted)&&e.destroy()}return n}n(5717)(x,a),S.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},function(){try{Object.defineProperty(S.prototype,"buffer",{get:s.deprecate((function(){return this.getBuffer()}),"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(e){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(l=Function.prototype[Symbol.hasInstance],Object.defineProperty(x,Symbol.hasInstance,{value:function(e){return!!l.call(this,e)||this===x&&(e&&e._writableState instanceof S)}})):l=function(e){return e instanceof this},x.prototype.pipe=function(){E(this,new v)},x.prototype.write=function(e,t,n){var r,o=this._writableState,s=!1,a=!o.objectMode&&(r=e,c.isBuffer(r)||r instanceof u);return a&&!c.isBuffer(e)&&(e=function(e){return c.from(e)}(e)),"function"==typeof t&&(n=t,t=null),a?t="buffer":t||(t=o.defaultEncoding),"function"!=typeof n&&(n=k),o.ending?function(e,t){var n=new w;E(e,n),i.nextTick(t,n)}(this,n):(a||function(e,t,n,r){var o;return null===n?o=new b:"string"==typeof n||t.objectMode||(o=new p("chunk",["string","Buffer"],n)),!o||(E(e,o),i.nextTick(r,o),!1)}(this,o,e,n))&&(o.pendingcb++,s=function(e,t,n,r,i,o){if(!n){var s=function(e,t,n){e.objectMode||!1===e.decodeStrings||"string"!=typeof t||(t=c.from(t,n));return t}(t,r,i);r!==s&&(n=!0,i="buffer",r=s)}var a=t.objectMode?1:r.length;t.length+=a;var u=t.length<t.highWaterMark;u||(t.needDrain=!0);if(t.writing||t.corked){var l=t.lastBufferedRequest;t.lastBufferedRequest={chunk:r,encoding:i,isBuf:n,callback:o,next:null},l?l.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else C(e,t,!1,a,r,i,o);return u}(this,o,a,e,t,n)),s},x.prototype.cork=function(){this._writableState.corked++},x.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.bufferProcessing||!e.bufferedRequest||R(this,e))},x.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new _(e);return this._writableState.defaultEncoding=e,this},Object.defineProperty(x.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(x.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),x.prototype._write=function(e,t,n){n(new m("_write()"))},x.prototype._writev=null,x.prototype.end=function(e,t,n){var r=this._writableState;return"function"==typeof e?(n=e,e=null,t=null):"function"==typeof t&&(n=t,t=null),null!=e&&this.write(e,t),r.corked&&(r.corked=1,this.uncork()),r.ending||function(e,t,n){t.ending=!0,D(e,t),n&&(t.finished?i.nextTick(n):e.once("finish",n));t.ended=!0,e.writable=!1}(this,r,n),this},Object.defineProperty(x.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(x.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e)}}),x.prototype.destroy=h.destroy,x.prototype._undestroy=h.undestroy,x.prototype._destroy=function(e,t){t(e)}},5850:(e,t,n)=>{"use strict";var r,i=n(4155);function o(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var s=n(8610),a=Symbol("lastResolve"),c=Symbol("lastReject"),u=Symbol("error"),l=Symbol("ended"),h=Symbol("lastPromise"),d=Symbol("handlePromise"),f=Symbol("stream");function p(e,t){return{value:e,done:t}}function m(e){var t=e[a];if(null!==t){var n=e[f].read();null!==n&&(e[h]=null,e[a]=null,e[c]=null,t(p(n,!1)))}}function y(e){i.nextTick(m,e)}var v=Object.getPrototypeOf((function(){})),g=Object.setPrototypeOf((o(r={get stream(){return this[f]},next:function(){var e=this,t=this[u];if(null!==t)return Promise.reject(t);if(this[l])return Promise.resolve(p(void 0,!0));if(this[f].destroyed)return new Promise((function(t,n){i.nextTick((function(){e[u]?n(e[u]):t(p(void 0,!0))}))}));var n,r=this[h];if(r)n=new Promise(function(e,t){return function(n,r){e.then((function(){t[l]?n(p(void 0,!0)):t[d](n,r)}),r)}}(r,this));else{var o=this[f].read();if(null!==o)return Promise.resolve(p(o,!1));n=new Promise(this[d])}return this[h]=n,n}},Symbol.asyncIterator,(function(){return this})),o(r,"return",(function(){var e=this;return new Promise((function(t,n){e[f].destroy(null,(function(e){e?n(e):t(p(void 0,!0))}))}))})),r),v);e.exports=function(e){var t,n=Object.create(g,(o(t={},f,{value:e,writable:!0}),o(t,a,{value:null,writable:!0}),o(t,c,{value:null,writable:!0}),o(t,u,{value:null,writable:!0}),o(t,l,{value:e._readableState.endEmitted,writable:!0}),o(t,d,{value:function(e,t){var r=n[f].read();r?(n[h]=null,n[a]=null,n[c]=null,e(p(r,!1))):(n[a]=e,n[c]=t)},writable:!0}),t));return n[h]=null,s(e,(function(e){if(e&&"ERR_STREAM_PREMATURE_CLOSE"!==e.code){var t=n[c];return null!==t&&(n[h]=null,n[a]=null,n[c]=null,t(e)),void(n[u]=e)}var r=n[a];null!==r&&(n[h]=null,n[a]=null,n[c]=null,r(p(void 0,!0))),n[l]=!0})),e.on("readable",y.bind(null,n)),n}},7327:(e,t,n)=>{"use strict";function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o(e,t,n){return(t=a(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,a(r.key),r)}}function a(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var c=n(8764).Buffer,u=n(2361).inspect,l=u&&u.custom||"inspect";e.exports=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.head=null,this.tail=null,this.length=0}var t,n,r;return t=e,(n=[{key:"push",value:function(e){var t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length}},{key:"unshift",value:function(e){var t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length}},{key:"shift",value:function(){if(0!==this.length){var e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(e){if(0===this.length)return"";for(var t=this.head,n=""+t.data;t=t.next;)n+=e+t.data;return n}},{key:"concat",value:function(e){if(0===this.length)return c.alloc(0);for(var t,n,r,i=c.allocUnsafe(e>>>0),o=this.head,s=0;o;)t=o.data,n=i,r=s,c.prototype.copy.call(t,n,r),s+=o.data.length,o=o.next;return i}},{key:"consume",value:function(e,t){var n;return e<this.head.data.length?(n=this.head.data.slice(0,e),this.head.data=this.head.data.slice(e)):n=e===this.head.data.length?this.shift():t?this._getString(e):this._getBuffer(e),n}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(e){var t=this.head,n=1,r=t.data;for(e-=r.length;t=t.next;){var i=t.data,o=e>i.length?i.length:e;if(o===i.length?r+=i:r+=i.slice(0,e),0==(e-=o)){o===i.length?(++n,t.next?this.head=t.next:this.head=this.tail=null):(this.head=t,t.data=i.slice(o));break}++n}return this.length-=n,r}},{key:"_getBuffer",value:function(e){var t=c.allocUnsafe(e),n=this.head,r=1;for(n.data.copy(t),e-=n.data.length;n=n.next;){var i=n.data,o=e>i.length?i.length:e;if(i.copy(t,t.length-e,0,o),0==(e-=o)){o===i.length?(++r,n.next?this.head=n.next:this.head=this.tail=null):(this.head=n,n.data=i.slice(o));break}++r}return this.length-=r,t}},{key:l,value:function(e,t){return u(this,i(i({},t),{},{depth:0,customInspect:!1}))}}])&&s(t.prototype,n),r&&s(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}()},1195:(e,t,n)=>{"use strict";var r=n(4155);function i(e,t){s(e,t),o(e)}function o(e){e._writableState&&!e._writableState.emitClose||e._readableState&&!e._readableState.emitClose||e.emit("close")}function s(e,t){e.emit("error",t)}e.exports={destroy:function(e,t){var n=this,a=this._readableState&&this._readableState.destroyed,c=this._writableState&&this._writableState.destroyed;return a||c?(t?t(e):e&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,r.nextTick(s,this,e)):r.nextTick(s,this,e)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(e||null,(function(e){!t&&e?n._writableState?n._writableState.errorEmitted?r.nextTick(o,n):(n._writableState.errorEmitted=!0,r.nextTick(i,n,e)):r.nextTick(i,n,e):t?(r.nextTick(o,n),t(e)):r.nextTick(o,n)})),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(e,t){var n=e._readableState,r=e._writableState;n&&n.autoDestroy||r&&r.autoDestroy?e.destroy(t):e.emit("error",t)}}},8610:(e,t,n)=>{"use strict";var r=n(4281).q.ERR_STREAM_PREMATURE_CLOSE;function i(){}e.exports=function e(t,n,o){if("function"==typeof n)return e(t,null,n);n||(n={}),o=function(e){var t=!1;return function(){if(!t){t=!0;for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];e.apply(this,r)}}}(o||i);var s=n.readable||!1!==n.readable&&t.readable,a=n.writable||!1!==n.writable&&t.writable,c=function(){t.writable||l()},u=t._writableState&&t._writableState.finished,l=function(){a=!1,u=!0,s||o.call(t)},h=t._readableState&&t._readableState.endEmitted,d=function(){s=!1,h=!0,a||o.call(t)},f=function(e){o.call(t,e)},p=function(){var e;return s&&!h?(t._readableState&&t._readableState.ended||(e=new r),o.call(t,e)):a&&!u?(t._writableState&&t._writableState.ended||(e=new r),o.call(t,e)):void 0},m=function(){t.req.on("finish",l)};return!function(e){return e.setHeader&&"function"==typeof e.abort}(t)?a&&!t._writableState&&(t.on("end",c),t.on("close",c)):(t.on("complete",l),t.on("abort",p),t.req?m():t.on("request",m)),t.on("end",d),t.on("finish",l),!1!==n.error&&t.on("error",f),t.on("close",p),function(){t.removeListener("complete",l),t.removeListener("abort",p),t.removeListener("request",m),t.req&&t.req.removeListener("finish",l),t.removeListener("end",c),t.removeListener("close",c),t.removeListener("finish",l),t.removeListener("end",d),t.removeListener("error",f),t.removeListener("close",p)}}},5167:e=>{e.exports=function(){throw new Error("Readable.from is not available in the browser")}},9946:(e,t,n)=>{"use strict";var r;var i=n(4281).q,o=i.ERR_MISSING_ARGS,s=i.ERR_STREAM_DESTROYED;function a(e){if(e)throw e}function c(e){e()}function u(e,t){return e.pipe(t)}e.exports=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];var l,h=function(e){return e.length?"function"!=typeof e[e.length-1]?a:e.pop():a}(t);if(Array.isArray(t[0])&&(t=t[0]),t.length<2)throw new o("streams");var d=t.map((function(e,i){var o=i<t.length-1;return function(e,t,i,o){o=function(e){var t=!1;return function(){t||(t=!0,e.apply(void 0,arguments))}}(o);var a=!1;e.on("close",(function(){a=!0})),void 0===r&&(r=n(8610)),r(e,{readable:t,writable:i},(function(e){if(e)return o(e);a=!0,o()}));var c=!1;return function(t){if(!a&&!c)return c=!0,function(e){return e.setHeader&&"function"==typeof e.abort}(e)?e.abort():"function"==typeof e.destroy?e.destroy():void o(t||new s("pipe"))}}(e,o,i>0,(function(e){l||(l=e),e&&d.forEach(c),o||(d.forEach(c),h(l))}))}));return t.reduce(u)}},2457:(e,t,n)=>{"use strict";var r=n(4281).q.ERR_INVALID_OPT_VALUE;e.exports={getHighWaterMark:function(e,t,n,i){var o=function(e,t,n){return null!=e.highWaterMark?e.highWaterMark:t?e[n]:null}(t,i,n);if(null!=o){if(!isFinite(o)||Math.floor(o)!==o||o<0)throw new r(i?n:"highWaterMark",o);return Math.floor(o)}return e.objectMode?16:16384}}},2503:(e,t,n)=>{e.exports=n(7187).EventEmitter},8473:(e,t,n)=>{(t=e.exports=n(9481)).Stream=t,t.Readable=t,t.Writable=n(4229),t.Duplex=n(6753),t.Transform=n(4605),t.PassThrough=n(2725),t.finished=n(8610),t.pipeline=n(9946)},6515:(e,t,n)=>{"use strict";n.d(t,{X:()=>i});var r=n(7582),i=function(e){function t(t){var n=e.call(this)||this;return n._value=t,n}return(0,r.ZT)(t,e),Object.defineProperty(t.prototype,"value",{get:function(){return this.getValue()},enumerable:!1,configurable:!0}),t.prototype._subscribe=function(t){var n=e.prototype._subscribe.call(this,t);return!n.closed&&t.next(this._value),n},t.prototype.getValue=function(){var e=this,t=e.hasError,n=e.thrownError,r=e._value;if(t)throw n;return this._throwIfClosed(),r},t.prototype.next=function(t){e.prototype.next.call(this,this._value=t)},t}(n(6716).x)},1480:(e,t,n)=>{"use strict";n.d(t,{y:()=>h});var r=n(5642),i=n(5720),o=n(6766),s=n(278);function a(e){return 0===e.length?s.y:1===e.length?e[0]:function(t){return e.reduce((function(e,t){return t(e)}),t)}}var c=n(3912),u=n(8474),l=n(8846),h=function(){function e(e){e&&(this._subscribe=e)}return e.prototype.lift=function(t){var n=new e;return n.source=this,n.operator=t,n},e.prototype.subscribe=function(e,t,n){var o,s=this,a=(o=e)&&o instanceof r.Lv||function(e){return e&&(0,u.m)(e.next)&&(0,u.m)(e.error)&&(0,u.m)(e.complete)}(o)&&(0,i.Nn)(o)?e:new r.Hp(e,t,n);return(0,l.x)((function(){var e=s,t=e.operator,n=e.source;a.add(t?t.call(a,n):n?s._subscribe(a):s._trySubscribe(a))})),a},e.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){e.error(t)}},e.prototype.forEach=function(e,t){var n=this;return new(t=d(t))((function(t,i){var o=new r.Hp({next:function(t){try{e(t)}catch(e){i(e),o.unsubscribe()}},error:i,complete:t});n.subscribe(o)}))},e.prototype._subscribe=function(e){var t;return null===(t=this.source)||void 0===t?void 0:t.subscribe(e)},e.prototype[o.L]=function(){return this},e.prototype.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return a(e)(this)},e.prototype.toPromise=function(e){var t=this;return new(e=d(e))((function(e,n){var r;t.subscribe((function(e){return r=e}),(function(e){return n(e)}),(function(){return e(r)}))}))},e.create=function(t){return new e(t)},e}();function d(e){var t;return null!==(t=null!=e?e:c.v.Promise)&&void 0!==t?t:Promise}},6716:(e,t,n)=>{"use strict";n.d(t,{x:()=>u});var r=n(7582),i=n(1480),o=n(5720),s=(0,n(1819).d)((function(e){return function(){e(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}})),a=n(3699),c=n(8846),u=function(e){function t(){var t=e.call(this)||this;return t.closed=!1,t.currentObservers=null,t.observers=[],t.isStopped=!1,t.hasError=!1,t.thrownError=null,t}return(0,r.ZT)(t,e),t.prototype.lift=function(e){var t=new l(this,this);return t.operator=e,t},t.prototype._throwIfClosed=function(){if(this.closed)throw new s},t.prototype.next=function(e){var t=this;(0,c.x)((function(){var n,i;if(t._throwIfClosed(),!t.isStopped){t.currentObservers||(t.currentObservers=Array.from(t.observers));try{for(var o=(0,r.XA)(t.currentObservers),s=o.next();!s.done;s=o.next()){s.value.next(e)}}catch(e){n={error:e}}finally{try{s&&!s.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}}}))},t.prototype.error=function(e){var t=this;(0,c.x)((function(){if(t._throwIfClosed(),!t.isStopped){t.hasError=t.isStopped=!0,t.thrownError=e;for(var n=t.observers;n.length;)n.shift().error(e)}}))},t.prototype.complete=function(){var e=this;(0,c.x)((function(){if(e._throwIfClosed(),!e.isStopped){e.isStopped=!0;for(var t=e.observers;t.length;)t.shift().complete()}}))},t.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(t.prototype,"observed",{get:function(){var e;return(null===(e=this.observers)||void 0===e?void 0:e.length)>0},enumerable:!1,configurable:!0}),t.prototype._trySubscribe=function(t){return this._throwIfClosed(),e.prototype._trySubscribe.call(this,t)},t.prototype._subscribe=function(e){return this._throwIfClosed(),this._checkFinalizedStatuses(e),this._innerSubscribe(e)},t.prototype._innerSubscribe=function(e){var t=this,n=this,r=n.hasError,i=n.isStopped,s=n.observers;return r||i?o.Lc:(this.currentObservers=null,s.push(e),new o.w0((function(){t.currentObservers=null,(0,a.P)(s,e)})))},t.prototype._checkFinalizedStatuses=function(e){var t=this,n=t.hasError,r=t.thrownError,i=t.isStopped;n?e.error(r):i&&e.complete()},t.prototype.asObservable=function(){var e=new i.y;return e.source=this,e},t.create=function(e,t){return new l(e,t)},t}(i.y),l=function(e){function t(t,n){var r=e.call(this)||this;return r.destination=t,r.source=n,r}return(0,r.ZT)(t,e),t.prototype.next=function(e){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.next)||void 0===n||n.call(t,e)},t.prototype.error=function(e){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.error)||void 0===n||n.call(t,e)},t.prototype.complete=function(){var e,t;null===(t=null===(e=this.destination)||void 0===e?void 0:e.complete)||void 0===t||t.call(e)},t.prototype._subscribe=function(e){var t,n;return null!==(n=null===(t=this.source)||void 0===t?void 0:t.subscribe(e))&&void 0!==n?n:o.Lc},t}(u)},5642:(e,t,n)=>{"use strict";n.d(t,{Hp:()=>v,Lv:()=>f});var r=n(7582),i=n(8474),o=n(5720),s=n(3912),a=n(5);function c(){}var u=l("C",void 0,void 0);function l(e,t,n){return{kind:e,value:t,error:n}}var h=n(8380),d=n(8846),f=function(e){function t(t){var n=e.call(this)||this;return n.isStopped=!1,t?(n.destination=t,(0,o.Nn)(t)&&t.add(n)):n.destination=w,n}return(0,r.ZT)(t,e),t.create=function(e,t,n){return new v(e,t,n)},t.prototype.next=function(e){this.isStopped?b(function(e){return l("N",e,void 0)}(e),this):this._next(e)},t.prototype.error=function(e){this.isStopped?b(l("E",void 0,e),this):(this.isStopped=!0,this._error(e))},t.prototype.complete=function(){this.isStopped?b(u,this):(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this),this.destination=null)},t.prototype._next=function(e){this.destination.next(e)},t.prototype._error=function(e){try{this.destination.error(e)}finally{this.unsubscribe()}},t.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},t}(o.w0),p=Function.prototype.bind;function m(e,t){return p.call(e,t)}var y=function(){function e(e){this.partialObserver=e}return e.prototype.next=function(e){var t=this.partialObserver;if(t.next)try{t.next(e)}catch(e){g(e)}},e.prototype.error=function(e){var t=this.partialObserver;if(t.error)try{t.error(e)}catch(e){g(e)}else g(e)},e.prototype.complete=function(){var e=this.partialObserver;if(e.complete)try{e.complete()}catch(e){g(e)}},e}(),v=function(e){function t(t,n,r){var o,a,c=e.call(this)||this;(0,i.m)(t)||!t?o={next:null!=t?t:void 0,error:null!=n?n:void 0,complete:null!=r?r:void 0}:c&&s.v.useDeprecatedNextContext?((a=Object.create(t)).unsubscribe=function(){return c.unsubscribe()},o={next:t.next&&m(t.next,a),error:t.error&&m(t.error,a),complete:t.complete&&m(t.complete,a)}):o=t;return c.destination=new y(o),c}return(0,r.ZT)(t,e),t}(f);function g(e){s.v.useDeprecatedSynchronousErrorHandling?(0,d.O)(e):(0,a.h)(e)}function b(e,t){var n=s.v.onStoppedNotification;n&&h.z.setTimeout((function(){return n(e,t)}))}var w={closed:!0,next:c,error:function(e){throw e},complete:c}},5720:(e,t,n)=>{"use strict";n.d(t,{Lc:()=>c,w0:()=>a,Nn:()=>u});var r=n(7582),i=n(8474),o=(0,n(1819).d)((function(e){return function(t){e(this),this.message=t?t.length+" errors occurred during unsubscription:\n"+t.map((function(e,t){return t+1+") "+e.toString()})).join("\n  "):"",this.name="UnsubscriptionError",this.errors=t}})),s=n(3699),a=function(){function e(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}var t;return e.prototype.unsubscribe=function(){var e,t,n,s,a;if(!this.closed){this.closed=!0;var c=this._parentage;if(c)if(this._parentage=null,Array.isArray(c))try{for(var u=(0,r.XA)(c),h=u.next();!h.done;h=u.next()){h.value.remove(this)}}catch(t){e={error:t}}finally{try{h&&!h.done&&(t=u.return)&&t.call(u)}finally{if(e)throw e.error}}else c.remove(this);var d=this.initialTeardown;if((0,i.m)(d))try{d()}catch(e){a=e instanceof o?e.errors:[e]}var f=this._finalizers;if(f){this._finalizers=null;try{for(var p=(0,r.XA)(f),m=p.next();!m.done;m=p.next()){var y=m.value;try{l(y)}catch(e){a=null!=a?a:[],e instanceof o?a=(0,r.ev)((0,r.ev)([],(0,r.CR)(a)),(0,r.CR)(e.errors)):a.push(e)}}}catch(e){n={error:e}}finally{try{m&&!m.done&&(s=p.return)&&s.call(p)}finally{if(n)throw n.error}}}if(a)throw new o(a)}},e.prototype.add=function(t){var n;if(t&&t!==this)if(this.closed)l(t);else{if(t instanceof e){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=null!==(n=this._finalizers)&&void 0!==n?n:[]).push(t)}},e.prototype._hasParent=function(e){var t=this._parentage;return t===e||Array.isArray(t)&&t.includes(e)},e.prototype._addParent=function(e){var t=this._parentage;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e},e.prototype._removeParent=function(e){var t=this._parentage;t===e?this._parentage=null:Array.isArray(t)&&(0,s.P)(t,e)},e.prototype.remove=function(t){var n=this._finalizers;n&&(0,s.P)(n,t),t instanceof e&&t._removeParent(this)},e.EMPTY=((t=new e).closed=!0,t),e}(),c=a.EMPTY;function u(e){return e instanceof a||e&&"closed"in e&&(0,i.m)(e.remove)&&(0,i.m)(e.add)&&(0,i.m)(e.unsubscribe)}function l(e){(0,i.m)(e)?e():e.unsubscribe()}},3912:(e,t,n)=>{"use strict";n.d(t,{v:()=>r});var r={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1}},7795:(e,t,n)=>{"use strict";n.d(t,{z:()=>o});var r=(0,n(1819).d)((function(e){return function(){e(this),this.name="EmptyError",this.message="no elements in sequence"}})),i=n(5642);function o(e,t){var n="object"==typeof t;return new Promise((function(o,s){var a=new i.Hp({next:function(e){o(e),a.unsubscribe()},error:s,complete:function(){n?o(t.defaultValue):s(new r)}});e.subscribe(a)}))}},1954:(e,t,n)=>{"use strict";n.d(t,{D:()=>_});var r=n(7878),i=n(7845),o=n(6798),s=n(2566);function a(e,t){return void 0===t&&(t=0),(0,o.e)((function(n,r){n.subscribe((0,s.x)(r,(function(n){return(0,i.f)(r,e,(function(){return r.next(n)}),t)}),(function(){return(0,i.f)(r,e,(function(){return r.complete()}),t)}),(function(n){return(0,i.f)(r,e,(function(){return r.error(n)}),t)})))}))}function c(e,t){return void 0===t&&(t=0),(0,o.e)((function(n,r){r.add(e.schedule((function(){return n.subscribe(r)}),t))}))}var u=n(1480);var l=n(9768),h=n(8474);function d(e,t){if(!e)throw new Error("Iterable cannot be null");return new u.y((function(n){(0,i.f)(n,t,(function(){var r=e[Symbol.asyncIterator]();(0,i.f)(n,t,(function(){r.next().then((function(e){e.done?n.complete():n.next(e.value)}))}),0,!0)}))}))}var f=n(1764),p=n(3841),m=n(5685),y=n(1837),v=n(8430),g=n(8729),b=n(8671);function w(e,t){if(null!=e){if((0,f.c)(e))return function(e,t){return(0,r.Xf)(e).pipe(c(t),a(t))}(e,t);if((0,m.z)(e))return function(e,t){return new u.y((function(n){var r=0;return t.schedule((function(){r===e.length?n.complete():(n.next(e[r++]),n.closed||this.schedule())}))}))}(e,t);if((0,p.t)(e))return function(e,t){return(0,r.Xf)(e).pipe(c(t),a(t))}(e,t);if((0,v.D)(e))return d(e,t);if((0,y.T)(e))return function(e,t){return new u.y((function(n){var r;return(0,i.f)(n,t,(function(){r=e[l.h](),(0,i.f)(n,t,(function(){var e,t,i;try{t=(e=r.next()).value,i=e.done}catch(e){return void n.error(e)}i?n.complete():n.next(t)}),0,!0)})),function(){return(0,h.m)(null==r?void 0:r.return)&&r.return()}}))}(e,t);if((0,b.L)(e))return function(e,t){return d((0,b.Q)(e),t)}(e,t)}throw(0,g.z)(e)}function _(e,t){return t?w(e,t):(0,r.Xf)(e)}},7878:(e,t,n)=>{"use strict";n.d(t,{Xf:()=>m});var r=n(7582),i=n(5685),o=n(3841),s=n(1480),a=n(1764),c=n(8430),u=n(8729),l=n(1837),h=n(8671),d=n(8474),f=n(5),p=n(6766);function m(e){if(e instanceof s.y)return e;if(null!=e){if((0,a.c)(e))return g=e,new s.y((function(e){var t=g[p.L]();if((0,d.m)(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")}));if((0,i.z)(e))return v=e,new s.y((function(e){for(var t=0;t<v.length&&!e.closed;t++)e.next(v[t]);e.complete()}));if((0,o.t)(e))return m=e,new s.y((function(e){m.then((function(t){e.closed||(e.next(t),e.complete())}),(function(t){return e.error(t)})).then(null,f.h)}));if((0,c.D)(e))return y(e);if((0,l.T)(e))return n=e,new s.y((function(e){var t,i;try{for(var o=(0,r.XA)(n),s=o.next();!s.done;s=o.next()){var a=s.value;if(e.next(a),e.closed)return}}catch(e){t={error:e}}finally{try{s&&!s.done&&(i=o.return)&&i.call(o)}finally{if(t)throw t.error}}e.complete()}));if((0,h.L)(e))return t=e,y((0,h.Q)(t))}var t,n,m,v,g;throw(0,u.z)(e)}function y(e){return new s.y((function(t){(function(e,t){var n,i,o,s;return(0,r.mG)(this,void 0,void 0,(function(){var a,c;return(0,r.Jh)(this,(function(u){switch(u.label){case 0:u.trys.push([0,5,6,11]),n=(0,r.KL)(e),u.label=1;case 1:return[4,n.next()];case 2:if((i=u.sent()).done)return[3,4];if(a=i.value,t.next(a),t.closed)return[2];u.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return c=u.sent(),o={error:c},[3,11];case 6:return u.trys.push([6,,9,10]),i&&!i.done&&(s=n.return)?[4,s.call(n)]:[3,8];case 7:u.sent(),u.label=8;case 8:return[3,10];case 9:if(o)throw o.error;return[7];case 10:return[7];case 11:return t.complete(),[2]}}))}))})(e,t).catch((function(e){return t.error(e)}))}))}},2566:(e,t,n)=>{"use strict";n.d(t,{x:()=>i});var r=n(7582);function i(e,t,n,r,i){return new o(e,t,n,r,i)}var o=function(e){function t(t,n,r,i,o,s){var a=e.call(this,t)||this;return a.onFinalize=o,a.shouldUnsubscribe=s,a._next=n?function(e){try{n(e)}catch(e){t.error(e)}}:e.prototype._next,a._error=i?function(e){try{i(e)}catch(e){t.error(e)}finally{this.unsubscribe()}}:e.prototype._error,a._complete=r?function(){try{r()}catch(e){t.error(e)}finally{this.unsubscribe()}}:e.prototype._complete,a}return(0,r.ZT)(t,e),t.prototype.unsubscribe=function(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var n=this.closed;e.prototype.unsubscribe.call(this),!n&&(null===(t=this.onFinalize)||void 0===t||t.call(this))}},t}(n(5642).Lv)},3741:(e,t,n)=>{"use strict";n.d(t,{x:()=>s});var r=n(278),i=n(6798),o=n(2566);function s(e,t){return void 0===t&&(t=r.y),e=null!=e?e:a,(0,i.e)((function(n,r){var i,s=!0;n.subscribe((0,o.x)(r,(function(n){var o=t(n);!s&&e(i,o)||(s=!1,i=o,r.next(n))})))}))}function a(e,t){return e===t}},4975:(e,t,n)=>{"use strict";n.d(t,{h:()=>o});var r=n(6798),i=n(2566);function o(e,t){return(0,r.e)((function(n,r){var o=0;n.subscribe((0,i.x)(r,(function(n){return e.call(t,n,o++)&&r.next(n)})))}))}},9127:(e,t,n)=>{"use strict";n.d(t,{U:()=>o});var r=n(6798),i=n(2566);function o(e,t){return(0,r.e)((function(n,r){var o=0;n.subscribe((0,i.x)(r,(function(n){r.next(e.call(t,n,o++))})))}))}},4367:(e,t,n)=>{"use strict";n.d(t,{J:()=>o});var r=n(7877),i=n(278);function o(e){return void 0===e&&(e=1/0),(0,r.z)(i.y,e)}},7877:(e,t,n)=>{"use strict";n.d(t,{z:()=>u});var r=n(9127),i=n(7878),o=n(6798),s=n(7845),a=n(2566);var c=n(8474);function u(e,t,n){return void 0===n&&(n=1/0),(0,c.m)(t)?u((function(n,o){return(0,r.U)((function(e,r){return t(n,e,o,r)}))((0,i.Xf)(e(n,o)))}),n):("number"==typeof t&&(n=t),(0,o.e)((function(t,r){return function(e,t,n,r,o,c,u,l){var h=[],d=0,f=0,p=!1,m=function(){!p||h.length||d||t.complete()},y=function(e){return d<r?v(e):h.push(e)},v=function(e){c&&t.next(e),d++;var l=!1;(0,i.Xf)(n(e,f++)).subscribe((0,a.x)(t,(function(e){null==o||o(e),c?y(e):t.next(e)}),(function(){l=!0}),void 0,(function(){if(l)try{d--;for(var e=function(){var e=h.shift();u?(0,s.f)(t,u,(function(){return v(e)})):v(e)};h.length&&d<r;)e();m()}catch(e){t.error(e)}})))};return e.subscribe((0,a.x)(t,y,(function(){p=!0,m()}))),function(){null==l||l()}}(t,r,e,n)})))}},7020:(e,t,n)=>{"use strict";n.d(t,{d:()=>h});var r=n(7582),i=n(6716),o={now:function(){return(o.delegate||Date).now()},delegate:void 0},s=function(e){function t(t,n,r){void 0===t&&(t=1/0),void 0===n&&(n=1/0),void 0===r&&(r=o);var i=e.call(this)||this;return i._bufferSize=t,i._windowTime=n,i._timestampProvider=r,i._buffer=[],i._infiniteTimeWindow=!0,i._infiniteTimeWindow=n===1/0,i._bufferSize=Math.max(1,t),i._windowTime=Math.max(1,n),i}return(0,r.ZT)(t,e),t.prototype.next=function(t){var n=this,r=n.isStopped,i=n._buffer,o=n._infiniteTimeWindow,s=n._timestampProvider,a=n._windowTime;r||(i.push(t),!o&&i.push(s.now()+a)),this._trimBuffer(),e.prototype.next.call(this,t)},t.prototype._subscribe=function(e){this._throwIfClosed(),this._trimBuffer();for(var t=this._innerSubscribe(e),n=this._infiniteTimeWindow,r=this._buffer.slice(),i=0;i<r.length&&!e.closed;i+=n?1:2)e.next(r[i]);return this._checkFinalizedStatuses(e),t},t.prototype._trimBuffer=function(){var e=this,t=e._bufferSize,n=e._timestampProvider,r=e._buffer,i=e._infiniteTimeWindow,o=(i?1:2)*t;if(t<1/0&&o<r.length&&r.splice(0,r.length-o),!i){for(var s=n.now(),a=0,c=1;c<r.length&&r[c]<=s;c+=2)a=c;a&&r.splice(0,a+1)}},t}(i.x),a=n(7878),c=n(5642),u=n(6798);function l(e,t){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];if(!0!==t){if(!1!==t){var o=new c.Hp({next:function(){o.unsubscribe(),e()}});return(0,a.Xf)(t.apply(void 0,(0,r.ev)([],(0,r.CR)(n)))).subscribe(o)}}else e()}function h(e,t,n){var r,o,h,d,f=!1;return e&&"object"==typeof e?(r=e.bufferSize,d=void 0===r?1/0:r,o=e.windowTime,t=void 0===o?1/0:o,f=void 0!==(h=e.refCount)&&h,n=e.scheduler):d=null!=e?e:1/0,function(e){void 0===e&&(e={});var t=e.connector,n=void 0===t?function(){return new i.x}:t,r=e.resetOnError,o=void 0===r||r,s=e.resetOnComplete,h=void 0===s||s,d=e.resetOnRefCountZero,f=void 0===d||d;return function(e){var t,r,i,s=0,d=!1,p=!1,m=function(){null==r||r.unsubscribe(),r=void 0},y=function(){m(),t=i=void 0,d=p=!1},v=function(){var e=t;y(),null==e||e.unsubscribe()};return(0,u.e)((function(e,u){s++,p||d||m();var g=i=null!=i?i:n();u.add((function(){0!=--s||p||d||(r=l(v,f))})),g.subscribe(u),!t&&s>0&&(t=new c.Hp({next:function(e){return g.next(e)},error:function(e){p=!0,m(),r=l(y,o,e),g.error(e)},complete:function(){d=!0,m(),r=l(y,h),g.complete()}}),(0,a.Xf)(e).subscribe(t))}))(e)}}({connector:function(){return new s(d,t,n)},resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:f})}},8536:(e,t,n)=>{"use strict";n.d(t,{O:()=>c});var r=n(4367);var i=n(7617),o=n(1954);function s(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return(0,r.J)(1)((0,o.D)(e,(0,i.yG)(e)))}var a=n(6798);function c(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=(0,i.yG)(e);return(0,a.e)((function(t,r){(n?s(e,t,n):s(e,t)).subscribe(r)}))}},8380:(e,t,n)=>{"use strict";n.d(t,{z:()=>i});var r=n(7582),i={setTimeout:function(e,t){for(var n=[],o=2;o<arguments.length;o++)n[o-2]=arguments[o];var s=i.delegate;return(null==s?void 0:s.setTimeout)?s.setTimeout.apply(s,(0,r.ev)([e,t],(0,r.CR)(n))):setTimeout.apply(void 0,(0,r.ev)([e,t],(0,r.CR)(n)))},clearTimeout:function(e){var t=i.delegate;return((null==t?void 0:t.clearTimeout)||clearTimeout)(e)},delegate:void 0}},9768:(e,t,n)=>{"use strict";n.d(t,{h:()=>r});var r="function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"},6766:(e,t,n)=>{"use strict";n.d(t,{L:()=>r});var r="function"==typeof Symbol&&Symbol.observable||"@@observable"},7617:(e,t,n)=>{"use strict";n.d(t,{_6:()=>a,jO:()=>o,yG:()=>s});var r=n(8474);function i(e){return e[e.length-1]}function o(e){return(0,r.m)(i(e))?e.pop():void 0}function s(e){return(t=i(e))&&(0,r.m)(t.schedule)?e.pop():void 0;var t}function a(e,t){return"number"==typeof i(e)?e.pop():t}},3699:(e,t,n)=>{"use strict";function r(e,t){if(e){var n=e.indexOf(t);0<=n&&e.splice(n,1)}}n.d(t,{P:()=>r})},1819:(e,t,n)=>{"use strict";function r(e){var t=e((function(e){Error.call(e),e.stack=(new Error).stack}));return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}n.d(t,{d:()=>r})},8846:(e,t,n)=>{"use strict";n.d(t,{O:()=>s,x:()=>o});var r=n(3912),i=null;function o(e){if(r.v.useDeprecatedSynchronousErrorHandling){var t=!i;if(t&&(i={errorThrown:!1,error:null}),e(),t){var n=i,o=n.errorThrown,s=n.error;if(i=null,o)throw s}}else e()}function s(e){r.v.useDeprecatedSynchronousErrorHandling&&i&&(i.errorThrown=!0,i.error=e)}},7845:(e,t,n)=>{"use strict";function r(e,t,n,r,i){void 0===r&&(r=0),void 0===i&&(i=!1);var o=t.schedule((function(){n(),i?e.add(this.schedule(null,r)):this.unsubscribe()}),r);if(e.add(o),!i)return o}n.d(t,{f:()=>r})},278:(e,t,n)=>{"use strict";function r(e){return e}n.d(t,{y:()=>r})},5685:(e,t,n)=>{"use strict";n.d(t,{z:()=>r});var r=function(e){return e&&"number"==typeof e.length&&"function"!=typeof e}},8430:(e,t,n)=>{"use strict";n.d(t,{D:()=>i});var r=n(8474);function i(e){return Symbol.asyncIterator&&(0,r.m)(null==e?void 0:e[Symbol.asyncIterator])}},8474:(e,t,n)=>{"use strict";function r(e){return"function"==typeof e}n.d(t,{m:()=>r})},1764:(e,t,n)=>{"use strict";n.d(t,{c:()=>o});var r=n(6766),i=n(8474);function o(e){return(0,i.m)(e[r.L])}},1837:(e,t,n)=>{"use strict";n.d(t,{T:()=>o});var r=n(9768),i=n(8474);function o(e){return(0,i.m)(null==e?void 0:e[r.h])}},3841:(e,t,n)=>{"use strict";n.d(t,{t:()=>i});var r=n(8474);function i(e){return(0,r.m)(null==e?void 0:e.then)}},8671:(e,t,n)=>{"use strict";n.d(t,{L:()=>s,Q:()=>o});var r=n(7582),i=n(8474);function o(e){return(0,r.FC)(this,arguments,(function(){var t,n,i;return(0,r.Jh)(this,(function(o){switch(o.label){case 0:t=e.getReader(),o.label=1;case 1:o.trys.push([1,,9,10]),o.label=2;case 2:return[4,(0,r.qq)(t.read())];case 3:return n=o.sent(),i=n.value,n.done?[4,(0,r.qq)(void 0)]:[3,5];case 4:return[2,o.sent()];case 5:return[4,(0,r.qq)(i)];case 6:return[4,o.sent()];case 7:return o.sent(),[3,2];case 8:return[3,10];case 9:return t.releaseLock(),[7];case 10:return[2]}}))}))}function s(e){return(0,i.m)(null==e?void 0:e.getReader)}},6798:(e,t,n)=>{"use strict";n.d(t,{e:()=>i});var r=n(8474);function i(e){return function(t){if(function(e){return(0,r.m)(null==e?void 0:e.lift)}(t))return t.lift((function(t){try{return e(t,this)}catch(e){this.error(e)}}));throw new TypeError("Unable to lift unknown Observable type")}}},5:(e,t,n)=>{"use strict";n.d(t,{h:()=>o});var r=n(3912),i=n(8380);function o(e){i.z.setTimeout((function(){var t=r.v.onUnhandledError;if(!t)throw e;t(e)}))}},8729:(e,t,n)=>{"use strict";function r(e){return new TypeError("You provided "+(null!==e&&"object"==typeof e?"an invalid object":"'"+e+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}n.d(t,{z:()=>r})},9509:(e,t,n)=>{var r=n(8764),i=r.Buffer;function o(e,t){for(var n in e)t[n]=e[n]}function s(e,t,n){return i(e,t,n)}i.from&&i.alloc&&i.allocUnsafe&&i.allocUnsafeSlow?e.exports=r:(o(r,t),t.Buffer=s),s.prototype=Object.create(i.prototype),o(i,s),s.from=function(e,t,n){if("number"==typeof e)throw new TypeError("Argument must not be a number");return i(e,t,n)},s.alloc=function(e,t,n){if("number"!=typeof e)throw new TypeError("Argument must be a number");var r=i(e);return void 0!==t?"string"==typeof n?r.fill(t,n):r.fill(t):r.fill(0),r},s.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return i(e)},s.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return r.SlowBuffer(e)}},8853:(e,t,n)=>{const r=n(1227)("simple-peer"),i=n(5177),o=n(1798),s=n(8473),a=n(4375),c=n(2114),{Buffer:u}=n(8764),l=65536;function h(e){return e.replace(/a=ice-options:trickle\s\n/g,"")}class d extends s.Duplex{constructor(e){if(super(e=Object.assign({allowHalfOpen:!1},e)),this._id=o(4).toString("hex").slice(0,7),this._debug("new peer %o",e),this.channelName=e.initiator?e.channelName||o(20).toString("hex"):null,this.initiator=e.initiator||!1,this.channelConfig=e.channelConfig||d.channelConfig,this.channelNegotiated=this.channelConfig.negotiated,this.config=Object.assign({},d.config,e.config),this.offerOptions=e.offerOptions||{},this.answerOptions=e.answerOptions||{},this.sdpTransform=e.sdpTransform||(e=>e),this.streams=e.streams||(e.stream?[e.stream]:[]),this.trickle=void 0===e.trickle||e.trickle,this.allowHalfTrickle=void 0!==e.allowHalfTrickle&&e.allowHalfTrickle,this.iceCompleteTimeout=e.iceCompleteTimeout||5e3,this.destroyed=!1,this.destroying=!1,this._connected=!1,this.remoteAddress=void 0,this.remoteFamily=void 0,this.remotePort=void 0,this.localAddress=void 0,this.localFamily=void 0,this.localPort=void 0,this._wrtc=e.wrtc&&"object"==typeof e.wrtc?e.wrtc:i(),!this._wrtc)throw"undefined"==typeof window?c(new Error("No WebRTC support: Specify `opts.wrtc` option in this environment"),"ERR_WEBRTC_SUPPORT"):c(new Error("No WebRTC support: Not a supported browser"),"ERR_WEBRTC_SUPPORT");this._pcReady=!1,this._channelReady=!1,this._iceComplete=!1,this._iceCompleteTimer=null,this._channel=null,this._pendingCandidates=[],this._isNegotiating=!1,this._firstNegotiation=!0,this._batchedNegotiation=!1,this._queuedNegotiation=!1,this._sendersAwaitingStable=[],this._senderMap=new Map,this._closingInterval=null,this._remoteTracks=[],this._remoteStreams=[],this._chunk=null,this._cb=null,this._interval=null;try{this._pc=new this._wrtc.RTCPeerConnection(this.config)}catch(e){return void this.destroy(c(e,"ERR_PC_CONSTRUCTOR"))}this._isReactNativeWebrtc="number"==typeof this._pc._peerConnectionId,this._pc.oniceconnectionstatechange=()=>{this._onIceStateChange()},this._pc.onicegatheringstatechange=()=>{this._onIceStateChange()},this._pc.onconnectionstatechange=()=>{this._onConnectionStateChange()},this._pc.onsignalingstatechange=()=>{this._onSignalingStateChange()},this._pc.onicecandidate=e=>{this._onIceCandidate(e)},"object"==typeof this._pc.peerIdentity&&this._pc.peerIdentity.catch((e=>{this.destroy(c(e,"ERR_PC_PEER_IDENTITY"))})),this.initiator||this.channelNegotiated?this._setupData({channel:this._pc.createDataChannel(this.channelName,this.channelConfig)}):this._pc.ondatachannel=e=>{this._setupData(e)},this.streams&&this.streams.forEach((e=>{this.addStream(e)})),this._pc.ontrack=e=>{this._onTrack(e)},this._debug("initial negotiation"),this._needsNegotiation(),this._onFinishBound=()=>{this._onFinish()},this.once("finish",this._onFinishBound)}get bufferSize(){return this._channel&&this._channel.bufferedAmount||0}get connected(){return this._connected&&"open"===this._channel.readyState}address(){return{port:this.localPort,family:this.localFamily,address:this.localAddress}}signal(e){if(!this.destroying){if(this.destroyed)throw c(new Error("cannot signal after peer is destroyed"),"ERR_DESTROYED");if("string"==typeof e)try{e=JSON.parse(e)}catch(t){e={}}this._debug("signal()"),e.renegotiate&&this.initiator&&(this._debug("got request to renegotiate"),this._needsNegotiation()),e.transceiverRequest&&this.initiator&&(this._debug("got request for transceiver"),this.addTransceiver(e.transceiverRequest.kind,e.transceiverRequest.init)),e.candidate&&(this._pc.remoteDescription&&this._pc.remoteDescription.type?this._addIceCandidate(e.candidate):this._pendingCandidates.push(e.candidate)),e.sdp&&this._pc.setRemoteDescription(new this._wrtc.RTCSessionDescription(e)).then((()=>{this.destroyed||(this._pendingCandidates.forEach((e=>{this._addIceCandidate(e)})),this._pendingCandidates=[],"offer"===this._pc.remoteDescription.type&&this._createAnswer())})).catch((e=>{this.destroy(c(e,"ERR_SET_REMOTE_DESCRIPTION"))})),e.sdp||e.candidate||e.renegotiate||e.transceiverRequest||this.destroy(c(new Error("signal() called with invalid signal data"),"ERR_SIGNALING"))}}_addIceCandidate(e){const t=new this._wrtc.RTCIceCandidate(e);this._pc.addIceCandidate(t).catch((e=>{var n;!t.address||t.address.endsWith(".local")?(n="Ignoring unsupported ICE candidate.",console.warn(n)):this.destroy(c(e,"ERR_ADD_ICE_CANDIDATE"))}))}send(e){if(!this.destroying){if(this.destroyed)throw c(new Error("cannot send after peer is destroyed"),"ERR_DESTROYED");this._channel.send(e)}}addTransceiver(e,t){if(!this.destroying){if(this.destroyed)throw c(new Error("cannot addTransceiver after peer is destroyed"),"ERR_DESTROYED");if(this._debug("addTransceiver()"),this.initiator)try{this._pc.addTransceiver(e,t),this._needsNegotiation()}catch(e){this.destroy(c(e,"ERR_ADD_TRANSCEIVER"))}else this.emit("signal",{type:"transceiverRequest",transceiverRequest:{kind:e,init:t}})}}addStream(e){if(!this.destroying){if(this.destroyed)throw c(new Error("cannot addStream after peer is destroyed"),"ERR_DESTROYED");this._debug("addStream()"),e.getTracks().forEach((t=>{this.addTrack(t,e)}))}}addTrack(e,t){if(this.destroying)return;if(this.destroyed)throw c(new Error("cannot addTrack after peer is destroyed"),"ERR_DESTROYED");this._debug("addTrack()");const n=this._senderMap.get(e)||new Map;let r=n.get(t);if(r)throw r.removed?c(new Error("Track has been removed. You should enable/disable tracks that you want to re-add."),"ERR_SENDER_REMOVED"):c(new Error("Track has already been added to that stream."),"ERR_SENDER_ALREADY_ADDED");r=this._pc.addTrack(e,t),n.set(t,r),this._senderMap.set(e,n),this._needsNegotiation()}replaceTrack(e,t,n){if(this.destroying)return;if(this.destroyed)throw c(new Error("cannot replaceTrack after peer is destroyed"),"ERR_DESTROYED");this._debug("replaceTrack()");const r=this._senderMap.get(e),i=r?r.get(n):null;if(!i)throw c(new Error("Cannot replace track that was never added."),"ERR_TRACK_NOT_ADDED");t&&this._senderMap.set(t,r),null!=i.replaceTrack?i.replaceTrack(t):this.destroy(c(new Error("replaceTrack is not supported in this browser"),"ERR_UNSUPPORTED_REPLACETRACK"))}removeTrack(e,t){if(this.destroying)return;if(this.destroyed)throw c(new Error("cannot removeTrack after peer is destroyed"),"ERR_DESTROYED");this._debug("removeSender()");const n=this._senderMap.get(e),r=n?n.get(t):null;if(!r)throw c(new Error("Cannot remove track that was never added."),"ERR_TRACK_NOT_ADDED");try{r.removed=!0,this._pc.removeTrack(r)}catch(e){"NS_ERROR_UNEXPECTED"===e.name?this._sendersAwaitingStable.push(r):this.destroy(c(e,"ERR_REMOVE_TRACK"))}this._needsNegotiation()}removeStream(e){if(!this.destroying){if(this.destroyed)throw c(new Error("cannot removeStream after peer is destroyed"),"ERR_DESTROYED");this._debug("removeSenders()"),e.getTracks().forEach((t=>{this.removeTrack(t,e)}))}}_needsNegotiation(){this._debug("_needsNegotiation"),this._batchedNegotiation||(this._batchedNegotiation=!0,a((()=>{this._batchedNegotiation=!1,this.initiator||!this._firstNegotiation?(this._debug("starting batched negotiation"),this.negotiate()):this._debug("non-initiator initial negotiation request discarded"),this._firstNegotiation=!1})))}negotiate(){if(!this.destroying){if(this.destroyed)throw c(new Error("cannot negotiate after peer is destroyed"),"ERR_DESTROYED");this.initiator?this._isNegotiating?(this._queuedNegotiation=!0,this._debug("already negotiating, queueing")):(this._debug("start negotiation"),setTimeout((()=>{this._createOffer()}),0)):this._isNegotiating?(this._queuedNegotiation=!0,this._debug("already negotiating, queueing")):(this._debug("requesting negotiation from initiator"),this.emit("signal",{type:"renegotiate",renegotiate:!0})),this._isNegotiating=!0}}destroy(e){this._destroy(e,(()=>{}))}_destroy(e,t){this.destroyed||this.destroying||(this.destroying=!0,this._debug("destroying (error: %s)",e&&(e.message||e)),a((()=>{if(this.destroyed=!0,this.destroying=!1,this._debug("destroy (error: %s)",e&&(e.message||e)),this.readable=this.writable=!1,this._readableState.ended||this.push(null),this._writableState.finished||this.end(),this._connected=!1,this._pcReady=!1,this._channelReady=!1,this._remoteTracks=null,this._remoteStreams=null,this._senderMap=null,clearInterval(this._closingInterval),this._closingInterval=null,clearInterval(this._interval),this._interval=null,this._chunk=null,this._cb=null,this._onFinishBound&&this.removeListener("finish",this._onFinishBound),this._onFinishBound=null,this._channel){try{this._channel.close()}catch(e){}this._channel.onmessage=null,this._channel.onopen=null,this._channel.onclose=null,this._channel.onerror=null}if(this._pc){try{this._pc.close()}catch(e){}this._pc.oniceconnectionstatechange=null,this._pc.onicegatheringstatechange=null,this._pc.onsignalingstatechange=null,this._pc.onicecandidate=null,this._pc.ontrack=null,this._pc.ondatachannel=null}this._pc=null,this._channel=null,e&&this.emit("error",e),this.emit("close"),t()})))}_setupData(e){if(!e.channel)return this.destroy(c(new Error("Data channel event is missing `channel` property"),"ERR_DATA_CHANNEL"));this._channel=e.channel,this._channel.binaryType="arraybuffer","number"==typeof this._channel.bufferedAmountLowThreshold&&(this._channel.bufferedAmountLowThreshold=l),this.channelName=this._channel.label,this._channel.onmessage=e=>{this._onChannelMessage(e)},this._channel.onbufferedamountlow=()=>{this._onChannelBufferedAmountLow()},this._channel.onopen=()=>{this._onChannelOpen()},this._channel.onclose=()=>{this._onChannelClose()},this._channel.onerror=e=>{const t=e.error instanceof Error?e.error:new Error(`Datachannel error: ${e.message} ${e.filename}:${e.lineno}:${e.colno}`);this.destroy(c(t,"ERR_DATA_CHANNEL"))};let t=!1;this._closingInterval=setInterval((()=>{this._channel&&"closing"===this._channel.readyState?(t&&this._onChannelClose(),t=!0):t=!1}),5e3)}_read(){}_write(e,t,n){if(this.destroyed)return n(c(new Error("cannot write after peer is destroyed"),"ERR_DATA_CHANNEL"));if(this._connected){try{this.send(e)}catch(e){return this.destroy(c(e,"ERR_DATA_CHANNEL"))}this._channel.bufferedAmount>l?(this._debug("start backpressure: bufferedAmount %d",this._channel.bufferedAmount),this._cb=n):n(null)}else this._debug("write before connect"),this._chunk=e,this._cb=n}_onFinish(){if(this.destroyed)return;const e=()=>{setTimeout((()=>this.destroy()),1e3)};this._connected?e():this.once("connect",e)}_startIceCompleteTimeout(){this.destroyed||this._iceCompleteTimer||(this._debug("started iceComplete timeout"),this._iceCompleteTimer=setTimeout((()=>{this._iceComplete||(this._iceComplete=!0,this._debug("iceComplete timeout completed"),this.emit("iceTimeout"),this.emit("_iceComplete"))}),this.iceCompleteTimeout))}_createOffer(){this.destroyed||this._pc.createOffer(this.offerOptions).then((e=>{if(this.destroyed)return;this.trickle||this.allowHalfTrickle||(e.sdp=h(e.sdp)),e.sdp=this.sdpTransform(e.sdp);const t=()=>{if(this.destroyed)return;const t=this._pc.localDescription||e;this._debug("signal"),this.emit("signal",{type:t.type,sdp:t.sdp})};this._pc.setLocalDescription(e).then((()=>{this._debug("createOffer success"),this.destroyed||(this.trickle||this._iceComplete?t():this.once("_iceComplete",t))})).catch((e=>{this.destroy(c(e,"ERR_SET_LOCAL_DESCRIPTION"))}))})).catch((e=>{this.destroy(c(e,"ERR_CREATE_OFFER"))}))}_requestMissingTransceivers(){this._pc.getTransceivers&&this._pc.getTransceivers().forEach((e=>{e.mid||!e.sender.track||e.requested||(e.requested=!0,this.addTransceiver(e.sender.track.kind))}))}_createAnswer(){this.destroyed||this._pc.createAnswer(this.answerOptions).then((e=>{if(this.destroyed)return;this.trickle||this.allowHalfTrickle||(e.sdp=h(e.sdp)),e.sdp=this.sdpTransform(e.sdp);const t=()=>{if(this.destroyed)return;const t=this._pc.localDescription||e;this._debug("signal"),this.emit("signal",{type:t.type,sdp:t.sdp}),this.initiator||this._requestMissingTransceivers()};this._pc.setLocalDescription(e).then((()=>{this.destroyed||(this.trickle||this._iceComplete?t():this.once("_iceComplete",t))})).catch((e=>{this.destroy(c(e,"ERR_SET_LOCAL_DESCRIPTION"))}))})).catch((e=>{this.destroy(c(e,"ERR_CREATE_ANSWER"))}))}_onConnectionStateChange(){this.destroyed||"failed"===this._pc.connectionState&&this.destroy(c(new Error("Connection failed."),"ERR_CONNECTION_FAILURE"))}_onIceStateChange(){if(this.destroyed)return;const e=this._pc.iceConnectionState,t=this._pc.iceGatheringState;this._debug("iceStateChange (connection: %s) (gathering: %s)",e,t),this.emit("iceStateChange",e,t),"connected"!==e&&"completed"!==e||(this._pcReady=!0,this._maybeReady()),"failed"===e&&this.destroy(c(new Error("Ice connection failed."),"ERR_ICE_CONNECTION_FAILURE")),"closed"===e&&this.destroy(c(new Error("Ice connection closed."),"ERR_ICE_CONNECTION_CLOSED"))}getStats(e){const t=e=>("[object Array]"===Object.prototype.toString.call(e.values)&&e.values.forEach((t=>{Object.assign(e,t)})),e);0===this._pc.getStats.length||this._isReactNativeWebrtc?this._pc.getStats().then((n=>{const r=[];n.forEach((e=>{r.push(t(e))})),e(null,r)}),(t=>e(t))):this._pc.getStats.length>0?this._pc.getStats((n=>{if(this.destroyed)return;const r=[];n.result().forEach((e=>{const n={};e.names().forEach((t=>{n[t]=e.stat(t)})),n.id=e.id,n.type=e.type,n.timestamp=e.timestamp,r.push(t(n))})),e(null,r)}),(t=>e(t))):e(null,[])}_maybeReady(){if(this._debug("maybeReady pc %s channel %s",this._pcReady,this._channelReady),this._connected||this._connecting||!this._pcReady||!this._channelReady)return;this._connecting=!0;const e=()=>{this.destroyed||this.getStats(((t,n)=>{if(this.destroyed)return;t&&(n=[]);const r={},i={},o={};let s=!1;n.forEach((e=>{"remotecandidate"!==e.type&&"remote-candidate"!==e.type||(r[e.id]=e),"localcandidate"!==e.type&&"local-candidate"!==e.type||(i[e.id]=e),"candidatepair"!==e.type&&"candidate-pair"!==e.type||(o[e.id]=e)}));const a=e=>{s=!0;let t=i[e.localCandidateId];t&&(t.ip||t.address)?(this.localAddress=t.ip||t.address,this.localPort=Number(t.port)):t&&t.ipAddress?(this.localAddress=t.ipAddress,this.localPort=Number(t.portNumber)):"string"==typeof e.googLocalAddress&&(t=e.googLocalAddress.split(":"),this.localAddress=t[0],this.localPort=Number(t[1])),this.localAddress&&(this.localFamily=this.localAddress.includes(":")?"IPv6":"IPv4");let n=r[e.remoteCandidateId];n&&(n.ip||n.address)?(this.remoteAddress=n.ip||n.address,this.remotePort=Number(n.port)):n&&n.ipAddress?(this.remoteAddress=n.ipAddress,this.remotePort=Number(n.portNumber)):"string"==typeof e.googRemoteAddress&&(n=e.googRemoteAddress.split(":"),this.remoteAddress=n[0],this.remotePort=Number(n[1])),this.remoteAddress&&(this.remoteFamily=this.remoteAddress.includes(":")?"IPv6":"IPv4"),this._debug("connect local: %s:%s remote: %s:%s",this.localAddress,this.localPort,this.remoteAddress,this.remotePort)};if(n.forEach((e=>{"transport"===e.type&&e.selectedCandidatePairId&&a(o[e.selectedCandidatePairId]),("googCandidatePair"===e.type&&"true"===e.googActiveConnection||("candidatepair"===e.type||"candidate-pair"===e.type)&&e.selected)&&a(e)})),s||Object.keys(o).length&&!Object.keys(i).length){if(this._connecting=!1,this._connected=!0,this._chunk){try{this.send(this._chunk)}catch(t){return this.destroy(c(t,"ERR_DATA_CHANNEL"))}this._chunk=null,this._debug('sent chunk from "write before connect"');const e=this._cb;this._cb=null,e(null)}"number"!=typeof this._channel.bufferedAmountLowThreshold&&(this._interval=setInterval((()=>this._onInterval()),150),this._interval.unref&&this._interval.unref()),this._debug("connect"),this.emit("connect")}else setTimeout(e,100)}))};e()}_onInterval(){!this._cb||!this._channel||this._channel.bufferedAmount>l||this._onChannelBufferedAmountLow()}_onSignalingStateChange(){this.destroyed||("stable"===this._pc.signalingState&&(this._isNegotiating=!1,this._debug("flushing sender queue",this._sendersAwaitingStable),this._sendersAwaitingStable.forEach((e=>{this._pc.removeTrack(e),this._queuedNegotiation=!0})),this._sendersAwaitingStable=[],this._queuedNegotiation?(this._debug("flushing negotiation queue"),this._queuedNegotiation=!1,this._needsNegotiation()):(this._debug("negotiated"),this.emit("negotiated"))),this._debug("signalingStateChange %s",this._pc.signalingState),this.emit("signalingStateChange",this._pc.signalingState))}_onIceCandidate(e){this.destroyed||(e.candidate&&this.trickle?this.emit("signal",{type:"candidate",candidate:{candidate:e.candidate.candidate,sdpMLineIndex:e.candidate.sdpMLineIndex,sdpMid:e.candidate.sdpMid}}):e.candidate||this._iceComplete||(this._iceComplete=!0,this.emit("_iceComplete")),e.candidate&&this._startIceCompleteTimeout())}_onChannelMessage(e){if(this.destroyed)return;let t=e.data;t instanceof ArrayBuffer&&(t=u.from(t)),this.push(t)}_onChannelBufferedAmountLow(){if(this.destroyed||!this._cb)return;this._debug("ending backpressure: bufferedAmount %d",this._channel.bufferedAmount);const e=this._cb;this._cb=null,e(null)}_onChannelOpen(){this._connected||this.destroyed||(this._debug("on channel open"),this._channelReady=!0,this._maybeReady())}_onChannelClose(){this.destroyed||(this._debug("on channel close"),this.destroy())}_onTrack(e){this.destroyed||e.streams.forEach((t=>{this._debug("on track"),this.emit("track",e.track,t),this._remoteTracks.push({track:e.track,stream:t}),this._remoteStreams.some((e=>e.id===t.id))||(this._remoteStreams.push(t),a((()=>{this._debug("on stream"),this.emit("stream",t)})))}))}_debug(){const e=[].slice.call(arguments);e[0]="["+this._id+"] "+e[0],r.apply(null,e)}}d.WEBRTC_SUPPORT=!!i(),d.config={iceServers:[{urls:["stun:stun.l.google.com:19302","stun:global.stun.twilio.com:3478"]}],sdpSemantics:"unified-plan"},d.channelConfig={},e.exports=d},2553:(e,t,n)=>{"use strict";var r=n(9509).Buffer,i=r.isEncoding||function(e){switch((e=""+e)&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function o(e){var t;switch(this.encoding=function(e){var t=function(e){if(!e)return"utf8";for(var t;;)switch(e){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return e;default:if(t)return;e=(""+e).toLowerCase(),t=!0}}(e);if("string"!=typeof t&&(r.isEncoding===i||!i(e)))throw new Error("Unknown encoding: "+e);return t||e}(e),this.encoding){case"utf16le":this.text=c,this.end=u,t=4;break;case"utf8":this.fillLast=a,t=4;break;case"base64":this.text=l,this.end=h,t=3;break;default:return this.write=d,void(this.end=f)}this.lastNeed=0,this.lastTotal=0,this.lastChar=r.allocUnsafe(t)}function s(e){return e<=127?0:e>>5==6?2:e>>4==14?3:e>>3==30?4:e>>6==2?-1:-2}function a(e){var t=this.lastTotal-this.lastNeed,n=function(e,t,n){if(128!=(192&t[0]))return e.lastNeed=0,"�";if(e.lastNeed>1&&t.length>1){if(128!=(192&t[1]))return e.lastNeed=1,"�";if(e.lastNeed>2&&t.length>2&&128!=(192&t[2]))return e.lastNeed=2,"�"}}(this,e);return void 0!==n?n:this.lastNeed<=e.length?(e.copy(this.lastChar,t,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(e.copy(this.lastChar,t,0,e.length),void(this.lastNeed-=e.length))}function c(e,t){if((e.length-t)%2==0){var n=e.toString("utf16le",t);if(n){var r=n.charCodeAt(n.length-1);if(r>=55296&&r<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1],n.slice(0,-1)}return n}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=e[e.length-1],e.toString("utf16le",t,e.length-1)}function u(e){var t=e&&e.length?this.write(e):"";if(this.lastNeed){var n=this.lastTotal-this.lastNeed;return t+this.lastChar.toString("utf16le",0,n)}return t}function l(e,t){var n=(e.length-t)%3;return 0===n?e.toString("base64",t):(this.lastNeed=3-n,this.lastTotal=3,1===n?this.lastChar[0]=e[e.length-1]:(this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1]),e.toString("base64",t,e.length-n))}function h(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+this.lastChar.toString("base64",0,3-this.lastNeed):t}function d(e){return e.toString(this.encoding)}function f(e){return e&&e.length?this.write(e):""}t.s=o,o.prototype.write=function(e){if(0===e.length)return"";var t,n;if(this.lastNeed){if(void 0===(t=this.fillLast(e)))return"";n=this.lastNeed,this.lastNeed=0}else n=0;return n<e.length?t?t+this.text(e,n):this.text(e,n):t||""},o.prototype.end=function(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+"�":t},o.prototype.text=function(e,t){var n=function(e,t,n){var r=t.length-1;if(r<n)return 0;var i=s(t[r]);if(i>=0)return i>0&&(e.lastNeed=i-1),i;if(--r<n||-2===i)return 0;if(i=s(t[r]),i>=0)return i>0&&(e.lastNeed=i-2),i;if(--r<n||-2===i)return 0;if(i=s(t[r]),i>=0)return i>0&&(2===i?i=0:e.lastNeed=i-3),i;return 0}(this,e,t);if(!this.lastNeed)return e.toString("utf8",t);this.lastTotal=n;var r=e.length-(n-this.lastNeed);return e.copy(this.lastChar,0,r),e.toString("utf8",t,r)},o.prototype.fillLast=function(e){if(this.lastNeed<=e.length)return e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,e.length),this.lastNeed-=e.length}},4927:(e,t,n)=>{function r(e){try{if(!n.g.localStorage)return!1}catch(e){return!1}var t=n.g.localStorage[e];return null!=t&&"true"===String(t).toLowerCase()}e.exports=function(e,t){if(r("noDeprecation"))return e;var n=!1;return function(){if(!n){if(r("throwDeprecation"))throw new Error(t);r("traceDeprecation")?console.trace(t):console.warn(t),n=!0}return e.apply(this,arguments)}}},2361:()=>{},4616:()=>{},1656:(e,t,n)=>{"use strict";function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function i(e){var t=function(e,t){if("object"!==r(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!==r(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===r(t)?t:String(t)}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,i(r.key),r)}}function s(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}n.d(t,{Z:()=>s})},395:(e,t,n)=>{"use strict";n.d(t,{i:()=>r});class r{ttl;map=new Map;_to=!1;constructor(e){this.ttl=e}has(e){return this.map.has(e)}add(e){this.map.set(e,i()),this._to||(this._to=!0,setTimeout((()=>{this._to=!1,function(e){const t=i()-e.ttl,n=e.map[Symbol.iterator]();for(;;){const r=n.next().value;if(!r)return;const i=r[0];if(!(r[1]<t))return;e.map.delete(i)}}(this)}),0))}clear(){this.map.clear()}}function i(){return Date.now()}},5872:(e,t,n)=>{"use strict";n.d(t,{B:()=>h,K:()=>l});var r=n(1656),i=n(1831),o=n(1462),s=n(327),a=n(5052),c=n(442),u=n(3461),l=function(){function e(e,t,n){this.cacheItemByDocId=new Map,this.registry="function"==typeof FinalizationRegistry?new FinalizationRegistry((e=>{var t=e.docId,n=this.cacheItemByDocId.get(t);n&&(n.byRev.delete(e.revisionHeight),0===n.byRev.size&&this.cacheItemByDocId.delete(t))})):void 0,this.registerIdleTasks=[],this.primaryPath=e,this.changes$=t,this.documentCreator=n,t.subscribe((e=>{var t=e.documentId,n=this.cacheItemByDocId.get(t);if(n){var r=(0,u.IA)(e);n.last=r}}))}var t=e.prototype;return t.getLatestDocumentData=function(e){return(0,i.e)(this.cacheItemByDocId,e).last},t.getLatestDocumentDataIfExists=function(e){var t=this.cacheItemByDocId.get(e);if(t)return t.last},(0,r.Z)(e,[{key:"getCachedRxDocument",get:function(){var e=function(e){var t=e.primaryPath,n=e.cacheItemByDocId,r=e.registry,o=c.j.deepFreezeWhenDevMode,u=e.documentCreator,l=c=>{var l=c[t],h=(0,s.Ac)(c._rev),f=(0,i.c)(n,l,(()=>function(e){return{byRev:new Map,last:e}}(c))),p=f.byRev,m=p.get(h),y=m?m.deref():void 0;return y||(c=o(c),y=u(c),p.set(h,d(y)),r&&(e.registerIdleTasks.push(y),e.registerIdlePromise||(e.registerIdlePromise=(0,a.y$)().then((()=>{e.registerIdlePromise=void 0;var t=e.registerIdleTasks;0!==t.length&&(e.registerIdleTasks=[],t.forEach((e=>{r.register(e,{docId:e.primary,revisionHeight:(0,s.Ac)(e.revision)})})))}))))),y};return l}(this);return(0,o.IK)(this,"getCachedRxDocument",e)}}]),e}();function h(e,t){for(var n=e.getCachedRxDocument,r=[],i=0;i<t.length;i++){var o=n(t[i]);r.push(o)}return r}var d="function"==typeof WeakRef?function(e){return new WeakRef(e)}:function(e){return{deref:()=>e}}},8655:(e,t,n)=>{"use strict";n.d(t,{BU:()=>o,Cb:()=>i,cF:()=>r});var r={preAddRxPlugin:[],preCreateRxDatabase:[],createRxDatabase:[],preCreateRxCollection:[],createRxCollection:[],postDestroyRxCollection:[],postRemoveRxCollection:[],preCreateRxSchema:[],createRxSchema:[],preCreateRxQuery:[],prePrepareQuery:[],createRxDocument:[],postCreateRxDocument:[],preCreateRxStorageInstance:[],preMigrateDocument:[],postMigrateDocument:[],preDestroyRxDatabase:[],postRemoveRxDatabase:[],preReplicationMasterWrite:[],preReplicationMasterWriteDocumentsHandle:[]};function i(e,t){r[e]&&r[e].forEach((e=>e(t)))}function o(e,t){return Promise.all(r[e].map((e=>e(t))))}},7458:(e,t,n)=>{"use strict";n.d(t,{Ll:()=>l,_l:()=>u});var r=n(109),i=n(1831),o=n(5688),s=n(1462),a=n(6069),c=n(327),u=function(){function e(e,t,n,r){this.queueByDocId=new Map,this.isRunning=!1,this.storageInstance=e,this.primaryPath=t,this.preWrite=n,this.postWrite=r}var t=e.prototype;return t.addWrite=function(e,t){var n=e[this.primaryPath],r=(0,i.c)(this.queueByDocId,n,(()=>[]));return new Promise(((n,i)=>{var s={lastKnownDocumentState:e,modifier:t,resolve:n,reject:i};(0,o.Is)(r).push(s),this.triggerRun()}))},t.triggerRun=async function(){if(!0!==this.isRunning&&0!==this.queueByDocId.size){this.isRunning=!0;var e=[],t=this.queueByDocId;this.queueByDocId=new Map,await Promise.all(Array.from(t.entries()).map((async([t,n])=>{var r,i,o,a=(r=n.map((e=>e.lastKnownDocumentState)),i=r[0],o=(0,c.Tz)(i._rev).height,r.forEach((e=>{var t=(0,c.Tz)(e._rev).height;t>o&&(i=e,o=t)})),i),u=a;for(var l of n)try{u=await l.modifier((0,s.d9)(u))}catch(e){l.reject(e),l.reject=()=>{},l.resolve=()=>{}}try{await this.preWrite(u,a)}catch(e){return void n.forEach((t=>t.reject(e)))}e.push({previous:a,document:u})})));var n=e.length>0?await this.storageInstance.bulkWrite(e,"incremental-write"):{error:[],success:[]};return await Promise.all(n.success.map((e=>{var n=e[this.primaryPath];this.postWrite(e),(0,i.e)(t,n).forEach((t=>t.resolve(e)))}))),n.error.forEach((e=>{var n=e.documentId,s=(0,i.e)(t,n),a=(0,r.pi)(e);if(a){var c=(0,i.c)(this.queueByDocId,n,(()=>[]));s.reverse().forEach((e=>{e.lastKnownDocumentState=(0,o.Is)(a.documentInDb),(0,o.Is)(c).unshift(e)}))}else{var u=(0,r.A2)(e);s.forEach((e=>e.reject(u)))}})),this.isRunning=!1,this.triggerRun()}},e}();function l(e){return async t=>{var n=(0,a.Ly)(t);n._deleted=t._deleted;var r=await e(n),i=Object.assign({},r,{_meta:t._meta,_attachments:t._attachments,_rev:t._rev,_deleted:void 0!==r._deleted?r._deleted:t._deleted});return void 0===i._deleted&&(i._deleted=!1),i}}},442:(e,t,n)=>{"use strict";n.d(t,{j:()=>r});var r={isDevMode:()=>!1,deepFreezeWhenDevMode:e=>e,tunnelErrorMessage:e=>"RxDB Error-Code "+e+".\n        Error messages are not included in RxDB core to reduce build size.\n        - To find out what this error means, either use the dev-mode-plugin https://rxdb.info/dev-mode.html\n        - or search for the error code here: https://github.com/pubkey/rxdb/search?q="+e+"\n        "}},8006:(e,t,n)=>{"use strict";n.d(t,{l4:()=>ir,aS:()=>ar,S9:()=>cr,Yi:()=>dr,N$:()=>mr,k4:()=>fr,dU:()=>gr,Gl:()=>vr,z4:()=>hr,Kj:()=>wr});const r="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:global,i=Object.keys,o=Array.isArray;function s(e,t){return"object"!=typeof t||i(t).forEach((function(n){e[n]=t[n]})),e}"undefined"==typeof Promise||r.Promise||(r.Promise=Promise);const a=Object.getPrototypeOf,c={}.hasOwnProperty;function u(e,t){return c.call(e,t)}function l(e,t){"function"==typeof t&&(t=t(a(e))),("undefined"==typeof Reflect?i:Reflect.ownKeys)(t).forEach((n=>{d(e,n,t[n])}))}const h=Object.defineProperty;function d(e,t,n,r){h(e,t,s(n&&u(n,"get")&&"function"==typeof n.get?{get:n.get,set:n.set,configurable:!0}:{value:n,configurable:!0,writable:!0},r))}function f(e){return{from:function(t){return e.prototype=Object.create(t.prototype),d(e.prototype,"constructor",e),{extend:l.bind(null,e.prototype)}}}}const p=Object.getOwnPropertyDescriptor;function m(e,t){let n;return p(e,t)||(n=a(e))&&m(n,t)}const y=[].slice;function v(e,t,n){return y.call(e,t,n)}function g(e,t){return t(e)}function b(e){if(!e)throw new Error("Assertion Failed")}function w(e){r.setImmediate?setImmediate(e):setTimeout(e,0)}function _(e,t){return e.reduce(((e,n,r)=>{var i=t(n,r);return i&&(e[i[0]]=i[1]),e}),{})}function E(e,t){if(u(e,t))return e[t];if(!t)return e;if("string"!=typeof t){for(var n=[],r=0,i=t.length;r<i;++r){var o=E(e,t[r]);n.push(o)}return n}var s=t.indexOf(".");if(-1!==s){var a=e[t.substr(0,s)];return void 0===a?void 0:E(a,t.substr(s+1))}}function k(e,t,n){if(e&&void 0!==t&&(!("isFrozen"in Object)||!Object.isFrozen(e)))if("string"!=typeof t&&"length"in t){b("string"!=typeof n&&"length"in n);for(var r=0,i=t.length;r<i;++r)k(e,t[r],n[r])}else{var s=t.indexOf(".");if(-1!==s){var a=t.substr(0,s),c=t.substr(s+1);if(""===c)void 0===n?o(e)&&!isNaN(parseInt(a))?e.splice(a,1):delete e[a]:e[a]=n;else{var l=e[a];l&&u(e,a)||(l=e[a]={}),k(l,c,n)}}else void 0===n?o(e)&&!isNaN(parseInt(t))?e.splice(t,1):delete e[t]:e[t]=n}}function S(e){var t={};for(var n in e)u(e,n)&&(t[n]=e[n]);return t}const x=[].concat;function C(e){return x.apply([],e)}const O="Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(C([8,16,32,64].map((e=>["Int","Uint","Float"].map((t=>t+e+"Array")))))).filter((e=>r[e])),R=O.map((e=>r[e]));_(O,(e=>[e,!0]));let I=null;function P(e){I="undefined"!=typeof WeakMap&&new WeakMap;const t=D(e);return I=null,t}function D(e){if(!e||"object"!=typeof e)return e;let t=I&&I.get(e);if(t)return t;if(o(e)){t=[],I&&I.set(e,t);for(var n=0,r=e.length;n<r;++n)t.push(D(e[n]))}else if(R.indexOf(e.constructor)>=0)t=e;else{const n=a(e);for(var i in t=n===Object.prototype?{}:Object.create(n),I&&I.set(e,t),e)u(e,i)&&(t[i]=D(e[i]))}return t}const{toString:T}={};function A(e){return T.call(e).slice(8,-1)}const j="undefined"!=typeof Symbol?Symbol.iterator:"@@iterator",M="symbol"==typeof j?function(e){var t;return null!=e&&(t=e[j])&&t.apply(e)}:function(){return null},N={};function L(e){var t,n,r,i;if(1===arguments.length){if(o(e))return e.slice();if(this===N&&"string"==typeof e)return[e];if(i=M(e)){for(n=[];!(r=i.next()).done;)n.push(r.value);return n}if(null==e)return[e];if("number"==typeof(t=e.length)){for(n=new Array(t);t--;)n[t]=e[t];return n}return[e]}for(t=arguments.length,n=new Array(t);t--;)n[t]=arguments[t];return n}const B="undefined"!=typeof Symbol?e=>"AsyncFunction"===e[Symbol.toStringTag]:()=>!1;var F="undefined"!=typeof location&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function $(e,t){F=e,q=t}var q=()=>!0;const K=!new Error("").stack;function U(){if(K)try{throw U.arguments,new Error}catch(e){return e}return new Error}function W(e,t){var n=e.stack;return n?(t=t||0,0===n.indexOf(e.name)&&(t+=(e.name+e.message).split("\n").length),n.split("\n").slice(t).filter(q).map((e=>"\n"+e)).join("")):""}var z=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],H=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(z),Q={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function V(e,t){this._e=U(),this.name=e,this.message=t}function Y(e,t){return e+". Errors: "+Object.keys(t).map((e=>t[e].toString())).filter(((e,t,n)=>n.indexOf(e)===t)).join("\n")}function G(e,t,n,r){this._e=U(),this.failures=t,this.failedKeys=r,this.successCount=n,this.message=Y(e,t)}function J(e,t){this._e=U(),this.name="BulkError",this.failures=Object.keys(t).map((e=>t[e])),this.failuresByPos=t,this.message=Y(e,t)}f(V).from(Error).extend({stack:{get:function(){return this._stack||(this._stack=this.name+": "+this.message+W(this._e,2))}},toString:function(){return this.name+": "+this.message}}),f(G).from(V),f(J).from(V);var Z=H.reduce(((e,t)=>(e[t]=t+"Error",e)),{});const X=V;var ee=H.reduce(((e,t)=>{var n=t+"Error";function r(e,r){this._e=U(),this.name=n,e?"string"==typeof e?(this.message=`${e}${r?"\n "+r:""}`,this.inner=r||null):"object"==typeof e&&(this.message=`${e.name} ${e.message}`,this.inner=e):(this.message=Q[t]||n,this.inner=null)}return f(r).from(X),e[t]=r,e}),{});ee.Syntax=SyntaxError,ee.Type=TypeError,ee.Range=RangeError;var te=z.reduce(((e,t)=>(e[t+"Error"]=ee[t],e)),{}),ne=H.reduce(((e,t)=>(-1===["Syntax","Type","Range"].indexOf(t)&&(e[t+"Error"]=ee[t]),e)),{});function re(){}function ie(e){return e}function oe(e,t){return null==e||e===ie?t:function(n){return t(e(n))}}function se(e,t){return function(){e.apply(this,arguments),t.apply(this,arguments)}}function ae(e,t){return e===re?t:function(){var n=e.apply(this,arguments);void 0!==n&&(arguments[0]=n);var r=this.onsuccess,i=this.onerror;this.onsuccess=null,this.onerror=null;var o=t.apply(this,arguments);return r&&(this.onsuccess=this.onsuccess?se(r,this.onsuccess):r),i&&(this.onerror=this.onerror?se(i,this.onerror):i),void 0!==o?o:n}}function ce(e,t){return e===re?t:function(){e.apply(this,arguments);var n=this.onsuccess,r=this.onerror;this.onsuccess=this.onerror=null,t.apply(this,arguments),n&&(this.onsuccess=this.onsuccess?se(n,this.onsuccess):n),r&&(this.onerror=this.onerror?se(r,this.onerror):r)}}function ue(e,t){return e===re?t:function(n){var r=e.apply(this,arguments);s(n,r);var i=this.onsuccess,o=this.onerror;this.onsuccess=null,this.onerror=null;var a=t.apply(this,arguments);return i&&(this.onsuccess=this.onsuccess?se(i,this.onsuccess):i),o&&(this.onerror=this.onerror?se(o,this.onerror):o),void 0===r?void 0===a?void 0:a:s(r,a)}}function le(e,t){return e===re?t:function(){return!1!==t.apply(this,arguments)&&e.apply(this,arguments)}}function he(e,t){return e===re?t:function(){var n=e.apply(this,arguments);if(n&&"function"==typeof n.then){for(var r=this,i=arguments.length,o=new Array(i);i--;)o[i]=arguments[i];return n.then((function(){return t.apply(r,o)}))}return t.apply(this,arguments)}}ne.ModifyError=G,ne.DexieError=V,ne.BulkError=J;var de={};const[fe,pe,me]="undefined"==typeof Promise?[]:(()=>{let e=Promise.resolve();if("undefined"==typeof crypto||!crypto.subtle)return[e,a(e),e];const t=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[t,a(t),e]})(),ye=pe&&pe.then,ve=fe&&fe.constructor,ge=!!me;var be=!1,we=me?()=>{me.then(Ue)}:r.setImmediate?setImmediate.bind(null,Ue):r.MutationObserver?()=>{var e=document.createElement("div");new MutationObserver((()=>{Ue(),e=null})).observe(e,{attributes:!0}),e.setAttribute("i","1")}:()=>{setTimeout(Ue,0)},_e=function(e,t){Pe.push([e,t]),ke&&(we(),ke=!1)},Ee=!0,ke=!0,Se=[],xe=[],Ce=null,Oe=ie,Re={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:ft,pgp:!1,env:{},finalize:function(){this.unhandleds.forEach((e=>{try{ft(e[0],e[1])}catch(e){}}))}},Ie=Re,Pe=[],De=0,Te=[];function Ae(e){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");this._listeners=[],this.onuncatched=re,this._lib=!1;var t=this._PSD=Ie;if(F&&(this._stackHolder=U(),this._prev=null,this._numPrev=0),"function"!=typeof e){if(e!==de)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(!1===this._state&&Le(this,this._value))}this._state=null,this._value=null,++t.ref,Ne(this,e)}const je={get:function(){var e=Ie,t=Xe;function n(n,r){var i=!e.global&&(e!==Ie||t!==Xe);const o=i&&!rt();var s=new Ae(((t,s)=>{Fe(this,new Me(ht(n,e,i,o),ht(r,e,i,o),t,s,e))}));return F&&Ke(s,this),s}return n.prototype=de,n},set:function(e){d(this,"then",e&&e.prototype===de?je:{get:function(){return e},set:je.set})}};function Me(e,t,n,r,i){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.resolve=n,this.reject=r,this.psd=i}function Ne(e,t){try{t((t=>{if(null===e._state){if(t===e)throw new TypeError("A promise cannot be resolved with itself.");var n=e._lib&&We();t&&"function"==typeof t.then?Ne(e,((e,n)=>{t instanceof Ae?t._then(e,n):t.then(e,n)})):(e._state=!0,e._value=t,Be(e)),n&&ze()}}),Le.bind(null,e))}catch(t){Le(e,t)}}function Le(e,t){if(xe.push(t),null===e._state){var n=e._lib&&We();t=Oe(t),e._state=!1,e._value=t,F&&null!==t&&"object"==typeof t&&!t._promise&&function(e,t,n){try{e.apply(null,void 0)}catch(e){}}((()=>{var n=m(t,"stack");t._promise=e,d(t,"stack",{get:()=>be?n&&(n.get?n.get.apply(t):n.value):e.stack})})),function(e){Se.some((t=>t._value===e._value))||Se.push(e)}(e),Be(e),n&&ze()}}function Be(e){var t=e._listeners;e._listeners=[];for(var n=0,r=t.length;n<r;++n)Fe(e,t[n]);var i=e._PSD;--i.ref||i.finalize(),0===De&&(++De,_e((()=>{0==--De&&He()}),[]))}function Fe(e,t){if(null!==e._state){var n=e._state?t.onFulfilled:t.onRejected;if(null===n)return(e._state?t.resolve:t.reject)(e._value);++t.psd.ref,++De,_e($e,[n,e,t])}else e._listeners.push(t)}function $e(e,t,n){try{Ce=t;var r,i=t._value;t._state?r=e(i):(xe.length&&(xe=[]),r=e(i),-1===xe.indexOf(i)&&function(e){for(var t=Se.length;t;)if(Se[--t]._value===e._value)return void Se.splice(t,1)}(t)),n.resolve(r)}catch(e){n.reject(e)}finally{Ce=null,0==--De&&He(),--n.psd.ref||n.psd.finalize()}}function qe(e,t,n){if(t.length===n)return t;var r="";if(!1===e._state){var i,o,s=e._value;null!=s?(i=s.name||"Error",o=s.message||s,r=W(s,0)):(i=s,o=""),t.push(i+(o?": "+o:"")+r)}return F&&((r=W(e._stackHolder,2))&&-1===t.indexOf(r)&&t.push(r),e._prev&&qe(e._prev,t,n)),t}function Ke(e,t){var n=t?t._numPrev+1:0;n<100&&(e._prev=t,e._numPrev=n)}function Ue(){We()&&ze()}function We(){var e=Ee;return Ee=!1,ke=!1,e}function ze(){var e,t,n;do{for(;Pe.length>0;)for(e=Pe,Pe=[],n=e.length,t=0;t<n;++t){var r=e[t];r[0].apply(null,r[1])}}while(Pe.length>0);Ee=!0,ke=!0}function He(){var e=Se;Se=[],e.forEach((e=>{e._PSD.onunhandled.call(null,e._value,e)}));for(var t=Te.slice(0),n=t.length;n;)t[--n]()}function Qe(e){return new Ae(de,!1,e)}function Ve(e,t){var n=Ie;return function(){var r=We(),i=Ie;try{return at(n,!0),e.apply(this,arguments)}catch(e){t&&t(e)}finally{at(i,!1),r&&ze()}}}l(Ae.prototype,{then:je,_then:function(e,t){Fe(this,new Me(null,null,e,t,Ie))},catch:function(e){if(1===arguments.length)return this.then(null,e);var t=arguments[0],n=arguments[1];return"function"==typeof t?this.then(null,(e=>e instanceof t?n(e):Qe(e))):this.then(null,(e=>e&&e.name===t?n(e):Qe(e)))},finally:function(e){return this.then((t=>(e(),t)),(t=>(e(),Qe(t))))},stack:{get:function(){if(this._stack)return this._stack;try{be=!0;var e=qe(this,[],20).join("\nFrom previous: ");return null!==this._state&&(this._stack=e),e}finally{be=!1}}},timeout:function(e,t){return e<1/0?new Ae(((n,r)=>{var i=setTimeout((()=>r(new ee.Timeout(t))),e);this.then(n,r).finally(clearTimeout.bind(null,i))})):this}}),"undefined"!=typeof Symbol&&Symbol.toStringTag&&d(Ae.prototype,Symbol.toStringTag,"Dexie.Promise"),Re.env=ct(),l(Ae,{all:function(){var e=L.apply(null,arguments).map(it);return new Ae((function(t,n){0===e.length&&t([]);var r=e.length;e.forEach(((i,o)=>Ae.resolve(i).then((n=>{e[o]=n,--r||t(e)}),n)))}))},resolve:e=>{if(e instanceof Ae)return e;if(e&&"function"==typeof e.then)return new Ae(((t,n)=>{e.then(t,n)}));var t=new Ae(de,!0,e);return Ke(t,Ce),t},reject:Qe,race:function(){var e=L.apply(null,arguments).map(it);return new Ae(((t,n)=>{e.map((e=>Ae.resolve(e).then(t,n)))}))},PSD:{get:()=>Ie,set:e=>Ie=e},totalEchoes:{get:()=>Xe},newPSD:tt,usePSD:ut,scheduler:{get:()=>_e,set:e=>{_e=e}},rejectionMapper:{get:()=>Oe,set:e=>{Oe=e}},follow:(e,t)=>new Ae(((n,r)=>tt(((t,n)=>{var r=Ie;r.unhandleds=[],r.onunhandled=n,r.finalize=se((function(){!function(e){Te.push((function t(){e(),Te.splice(Te.indexOf(t),1)})),++De,_e((()=>{0==--De&&He()}),[])}((()=>{0===this.unhandleds.length?t():n(this.unhandleds[0])}))}),r.finalize),e()}),t,n,r)))}),ve&&(ve.allSettled&&d(Ae,"allSettled",(function(){const e=L.apply(null,arguments).map(it);return new Ae((t=>{0===e.length&&t([]);let n=e.length;const r=new Array(n);e.forEach(((e,i)=>Ae.resolve(e).then((e=>r[i]={status:"fulfilled",value:e}),(e=>r[i]={status:"rejected",reason:e})).then((()=>--n||t(r)))))}))})),ve.any&&"undefined"!=typeof AggregateError&&d(Ae,"any",(function(){const e=L.apply(null,arguments).map(it);return new Ae(((t,n)=>{0===e.length&&n(new AggregateError([]));let r=e.length;const i=new Array(r);e.forEach(((e,o)=>Ae.resolve(e).then((e=>t(e)),(e=>{i[o]=e,--r||n(new AggregateError(i))}))))}))})));const Ye={awaits:0,echoes:0,id:0};var Ge=0,Je=[],Ze=0,Xe=0,et=0;function tt(e,t,n,r){var i=Ie,o=Object.create(i);o.parent=i,o.ref=0,o.global=!1,o.id=++et;var a=Re.env;o.env=ge?{Promise:Ae,PromiseProp:{value:Ae,configurable:!0,writable:!0},all:Ae.all,race:Ae.race,allSettled:Ae.allSettled,any:Ae.any,resolve:Ae.resolve,reject:Ae.reject,nthen:dt(a.nthen,o),gthen:dt(a.gthen,o)}:{},t&&s(o,t),++i.ref,o.finalize=function(){--this.parent.ref||this.parent.finalize()};var c=ut(o,e,n,r);return 0===o.ref&&o.finalize(),c}function nt(){return Ye.id||(Ye.id=++Ge),++Ye.awaits,Ye.echoes+=100,Ye.id}function rt(){return!!Ye.awaits&&(0==--Ye.awaits&&(Ye.id=0),Ye.echoes=100*Ye.awaits,!0)}function it(e){return Ye.echoes&&e&&e.constructor===ve?(nt(),e.then((e=>(rt(),e)),(e=>(rt(),pt(e))))):e}function ot(e){++Xe,Ye.echoes&&0!=--Ye.echoes||(Ye.echoes=Ye.id=0),Je.push(Ie),at(e,!0)}function st(){var e=Je[Je.length-1];Je.pop(),at(e,!1)}function at(e,t){var n=Ie;if((t?!Ye.echoes||Ze++&&e===Ie:!Ze||--Ze&&e===Ie)||lt(t?ot.bind(null,e):st),e!==Ie&&(Ie=e,n===Re&&(Re.env=ct()),ge)){var i=Re.env.Promise,o=e.env;pe.then=o.nthen,i.prototype.then=o.gthen,(n.global||e.global)&&(Object.defineProperty(r,"Promise",o.PromiseProp),i.all=o.all,i.race=o.race,i.resolve=o.resolve,i.reject=o.reject,o.allSettled&&(i.allSettled=o.allSettled),o.any&&(i.any=o.any))}}function ct(){var e=r.Promise;return ge?{Promise:e,PromiseProp:Object.getOwnPropertyDescriptor(r,"Promise"),all:e.all,race:e.race,allSettled:e.allSettled,any:e.any,resolve:e.resolve,reject:e.reject,nthen:pe.then,gthen:e.prototype.then}:{}}function ut(e,t,n,r,i){var o=Ie;try{return at(e,!0),t(n,r,i)}finally{at(o,!1)}}function lt(e){ye.call(fe,e)}function ht(e,t,n,r){return"function"!=typeof e?e:function(){var i=Ie;n&&nt(),at(t,!0);try{return e.apply(this,arguments)}finally{at(i,!1),r&&lt(rt)}}}function dt(e,t){return function(n,r){return e.call(this,ht(n,t),ht(r,t))}}function ft(e,t){var n;try{n=t.onuncatched(e)}catch(e){}if(!1!==n)try{var i,o={promise:t,reason:e};if(r.document&&document.createEvent?((i=document.createEvent("Event")).initEvent("unhandledrejection",!0,!0),s(i,o)):r.CustomEvent&&s(i=new CustomEvent("unhandledrejection",{detail:o}),o),i&&r.dispatchEvent&&(dispatchEvent(i),!r.PromiseRejectionEvent&&r.onunhandledrejection))try{r.onunhandledrejection(i)}catch(e){}F&&i&&!i.defaultPrevented&&console.warn(`Unhandled rejection: ${e.stack||e}`)}catch(e){}}-1===(""+ye).indexOf("[native code]")&&(nt=rt=re);var pt=Ae.reject;function mt(e,t,n,r){if(e.idbdb&&(e._state.openComplete||Ie.letThrough||e._vip)){var i=e._createTransaction(t,n,e._dbSchema);try{i.create(),e._state.PR1398_maxLoop=3}catch(i){return i.name===Z.InvalidState&&e.isOpen()&&--e._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),e._close(),e.open().then((()=>mt(e,t,n,r)))):pt(i)}return i._promise(t,((e,t)=>tt((()=>(Ie.trans=i,r(e,t,i)))))).then((e=>i._completion.then((()=>e))))}if(e._state.openComplete)return pt(new ee.DatabaseClosed(e._state.dbOpenError));if(!e._state.isBeingOpened){if(!e._options.autoOpen)return pt(new ee.DatabaseClosed);e.open().catch(re)}return e._state.dbReadyPromise.then((()=>mt(e,t,n,r)))}const yt=String.fromCharCode(65535),vt="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",gt=[],bt="undefined"!=typeof navigator&&/(MSIE|Trident|Edge)/.test(navigator.userAgent),wt=bt,_t=bt,Et=e=>!/(dexie\.js|dexie\.min\.js)/.test(e);function kt(e,t){return e?t?function(){return e.apply(this,arguments)&&t.apply(this,arguments)}:e:t}const St={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function xt(e){return"string"!=typeof e||/\./.test(e)?e=>e:t=>(void 0===t[e]&&e in t&&delete(t=P(t))[e],t)}function Ct(){throw ee.Type()}class Ot{_trans(e,t,n){const r=this._tx||Ie.trans,i=this.name;function o(e,n,r){if(!r.schema[i])throw new ee.NotFound("Table "+i+" not part of transaction");return t(r.idbtrans,r)}const s=We();try{return r&&r.db===this.db?r===Ie.trans?r._promise(e,o,n):tt((()=>r._promise(e,o,n)),{trans:r,transless:Ie.transless||Ie}):mt(this.db,e,[this.name],o)}finally{s&&ze()}}get(e,t){return e&&e.constructor===Object?this.where(e).first(t):this._trans("readonly",(t=>this.core.get({trans:t,key:e}).then((e=>this.hook.reading.fire(e))))).then(t)}where(e){if("string"==typeof e)return new this.db.WhereClause(this,e);if(o(e))return new this.db.WhereClause(this,`[${e.join("+")}]`);const t=i(e);if(1===t.length)return this.where(t[0]).equals(e[t[0]]);const n=this.schema.indexes.concat(this.schema.primKey).filter((e=>e.compound&&t.every((t=>e.keyPath.indexOf(t)>=0))&&e.keyPath.every((e=>t.indexOf(e)>=0))))[0];if(n&&this.db._maxKey!==yt)return this.where(n.name).equals(n.keyPath.map((t=>e[t])));!n&&F&&console.warn(`The query ${JSON.stringify(e)} on ${this.name} would benefit of a compound index [${t.join("+")}]`);const{idxByName:r}=this.schema,s=this.db._deps.indexedDB;function a(e,t){try{return 0===s.cmp(e,t)}catch(e){return!1}}const[c,u]=t.reduce((([t,n],i)=>{const s=r[i],c=e[i];return[t||s,t||!s?kt(n,s&&s.multi?e=>{const t=E(e,i);return o(t)&&t.some((e=>a(c,e)))}:e=>a(c,E(e,i))):n]}),[null,null]);return c?this.where(c.name).equals(e[c.keyPath]).filter(u):n?this.filter(u):this.where(t).equals("")}filter(e){return this.toCollection().and(e)}count(e){return this.toCollection().count(e)}offset(e){return this.toCollection().offset(e)}limit(e){return this.toCollection().limit(e)}each(e){return this.toCollection().each(e)}toArray(e){return this.toCollection().toArray(e)}toCollection(){return new this.db.Collection(new this.db.WhereClause(this))}orderBy(e){return new this.db.Collection(new this.db.WhereClause(this,o(e)?`[${e.join("+")}]`:e))}reverse(){return this.toCollection().reverse()}mapToClass(e){const{db:t,name:n}=this;this.schema.mappedClass=e,e.prototype instanceof Ct&&(e=class extends e{get db(){return t}table(){return n}});const r=new Set;for(let t=e.prototype;t;t=a(t))Object.getOwnPropertyNames(t).forEach((e=>r.add(e)));const i=t=>{if(!t)return t;const n=Object.create(e.prototype);for(let e in t)if(!r.has(e))try{n[e]=t[e]}catch(e){}return n};return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=i,this.hook("reading",i),e}defineClass(){return this.mapToClass((function(e){s(this,e)}))}add(e,t){const{auto:n,keyPath:r}=this.schema.primKey;let i=e;return r&&n&&(i=xt(r)(e)),this._trans("readwrite",(e=>this.core.mutate({trans:e,type:"add",keys:null!=t?[t]:null,values:[i]}))).then((e=>e.numFailures?Ae.reject(e.failures[0]):e.lastResult)).then((t=>{if(r)try{k(e,r,t)}catch(e){}return t}))}update(e,t){if("object"!=typeof e||o(e))return this.where(":id").equals(e).modify(t);{const n=E(e,this.schema.primKey.keyPath);if(void 0===n)return pt(new ee.InvalidArgument("Given object does not contain its primary key"));try{"function"!=typeof t?i(t).forEach((n=>{k(e,n,t[n])})):t(e,{value:e,primKey:n})}catch(e){}return this.where(":id").equals(n).modify(t)}}put(e,t){const{auto:n,keyPath:r}=this.schema.primKey;let i=e;return r&&n&&(i=xt(r)(e)),this._trans("readwrite",(e=>this.core.mutate({trans:e,type:"put",values:[i],keys:null!=t?[t]:null}))).then((e=>e.numFailures?Ae.reject(e.failures[0]):e.lastResult)).then((t=>{if(r)try{k(e,r,t)}catch(e){}return t}))}delete(e){return this._trans("readwrite",(t=>this.core.mutate({trans:t,type:"delete",keys:[e]}))).then((e=>e.numFailures?Ae.reject(e.failures[0]):void 0))}clear(){return this._trans("readwrite",(e=>this.core.mutate({trans:e,type:"deleteRange",range:St}))).then((e=>e.numFailures?Ae.reject(e.failures[0]):void 0))}bulkGet(e){return this._trans("readonly",(t=>this.core.getMany({keys:e,trans:t}).then((e=>e.map((e=>this.hook.reading.fire(e)))))))}bulkAdd(e,t,n){const r=Array.isArray(t)?t:void 0,i=(n=n||(r?void 0:t))?n.allKeys:void 0;return this._trans("readwrite",(t=>{const{auto:n,keyPath:o}=this.schema.primKey;if(o&&r)throw new ee.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(r&&r.length!==e.length)throw new ee.InvalidArgument("Arguments objects and keys must have the same length");const s=e.length;let a=o&&n?e.map(xt(o)):e;return this.core.mutate({trans:t,type:"add",keys:r,values:a,wantResults:i}).then((({numFailures:e,results:t,lastResult:n,failures:r})=>{if(0===e)return i?t:n;throw new J(`${this.name}.bulkAdd(): ${e} of ${s} operations failed`,r)}))}))}bulkPut(e,t,n){const r=Array.isArray(t)?t:void 0,i=(n=n||(r?void 0:t))?n.allKeys:void 0;return this._trans("readwrite",(t=>{const{auto:n,keyPath:o}=this.schema.primKey;if(o&&r)throw new ee.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(r&&r.length!==e.length)throw new ee.InvalidArgument("Arguments objects and keys must have the same length");const s=e.length;let a=o&&n?e.map(xt(o)):e;return this.core.mutate({trans:t,type:"put",keys:r,values:a,wantResults:i}).then((({numFailures:e,results:t,lastResult:n,failures:r})=>{if(0===e)return i?t:n;throw new J(`${this.name}.bulkPut(): ${e} of ${s} operations failed`,r)}))}))}bulkDelete(e){const t=e.length;return this._trans("readwrite",(t=>this.core.mutate({trans:t,type:"delete",keys:e}))).then((({numFailures:e,lastResult:n,failures:r})=>{if(0===e)return n;throw new J(`${this.name}.bulkDelete(): ${e} of ${t} operations failed`,r)}))}}function Rt(e){var t={},n=function(n,r){if(r){for(var i=arguments.length,o=new Array(i-1);--i;)o[i-1]=arguments[i];return t[n].subscribe.apply(null,o),e}if("string"==typeof n)return t[n]};n.addEventType=a;for(var r=1,s=arguments.length;r<s;++r)a(arguments[r]);return n;function a(e,r,i){if("object"==typeof e)return c(e);r||(r=le),i||(i=re);var o={subscribers:[],fire:i,subscribe:function(e){-1===o.subscribers.indexOf(e)&&(o.subscribers.push(e),o.fire=r(o.fire,e))},unsubscribe:function(e){o.subscribers=o.subscribers.filter((function(t){return t!==e})),o.fire=o.subscribers.reduce(r,i)}};return t[e]=n[e]=o,o}function c(e){i(e).forEach((function(t){var n=e[t];if(o(n))a(t,e[t][0],e[t][1]);else{if("asap"!==n)throw new ee.InvalidArgument("Invalid event config");var r=a(t,ie,(function(){for(var e=arguments.length,t=new Array(e);e--;)t[e]=arguments[e];r.subscribers.forEach((function(e){w((function(){e.apply(null,t)}))}))}))}}))}}function It(e,t){return f(t).from({prototype:e}),t}function Pt(e,t){return!(e.filter||e.algorithm||e.or)&&(t?e.justLimit:!e.replayFilter)}function Dt(e,t){e.filter=kt(e.filter,t)}function Tt(e,t,n){var r=e.replayFilter;e.replayFilter=r?()=>kt(r(),t()):t,e.justLimit=n&&!r}function At(e,t){if(e.isPrimKey)return t.primaryKey;const n=t.getIndexByKeyPath(e.index);if(!n)throw new ee.Schema("KeyPath "+e.index+" on object store "+t.name+" is not indexed");return n}function jt(e,t,n){const r=At(e,t.schema);return t.openCursor({trans:n,values:!e.keysOnly,reverse:"prev"===e.dir,unique:!!e.unique,query:{index:r,range:e.range}})}function Mt(e,t,n,r){const i=e.replayFilter?kt(e.filter,e.replayFilter()):e.filter;if(e.or){const o={},s=(e,n,r)=>{if(!i||i(n,r,(e=>n.stop(e)),(e=>n.fail(e)))){var s=n.primaryKey,a=""+s;"[object ArrayBuffer]"===a&&(a=""+new Uint8Array(s)),u(o,a)||(o[a]=!0,t(e,n,r))}};return Promise.all([e.or._iterate(s,n),Nt(jt(e,r,n),e.algorithm,s,!e.keysOnly&&e.valueMapper)])}return Nt(jt(e,r,n),kt(e.algorithm,i),t,!e.keysOnly&&e.valueMapper)}function Nt(e,t,n,r){var i=Ve(r?(e,t,i)=>n(r(e),t,i):n);return e.then((e=>{if(e)return e.start((()=>{var n=()=>e.continue();t&&!t(e,(e=>n=e),(t=>{e.stop(t),n=re}),(t=>{e.fail(t),n=re}))||i(e.value,e,(e=>n=e)),n()}))}))}function Lt(e,t){try{const n=Bt(e),r=Bt(t);if(n!==r)return"Array"===n?1:"Array"===r?-1:"binary"===n?1:"binary"===r?-1:"string"===n?1:"string"===r?-1:"Date"===n?1:"Date"!==r?NaN:-1;switch(n){case"number":case"Date":case"string":return e>t?1:e<t?-1:0;case"binary":return function(e,t){const n=e.length,r=t.length,i=n<r?n:r;for(let n=0;n<i;++n)if(e[n]!==t[n])return e[n]<t[n]?-1:1;return n===r?0:n<r?-1:1}(Ft(e),Ft(t));case"Array":return function(e,t){const n=e.length,r=t.length,i=n<r?n:r;for(let n=0;n<i;++n){const r=Lt(e[n],t[n]);if(0!==r)return r}return n===r?0:n<r?-1:1}(e,t)}}catch(e){}return NaN}function Bt(e){const t=typeof e;if("object"!==t)return t;if(ArrayBuffer.isView(e))return"binary";const n=A(e);return"ArrayBuffer"===n?"binary":n}function Ft(e){return e instanceof Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(e)}class $t{_read(e,t){var n=this._ctx;return n.error?n.table._trans(null,pt.bind(null,n.error)):n.table._trans("readonly",e).then(t)}_write(e){var t=this._ctx;return t.error?t.table._trans(null,pt.bind(null,t.error)):t.table._trans("readwrite",e,"locked")}_addAlgorithm(e){var t=this._ctx;t.algorithm=kt(t.algorithm,e)}_iterate(e,t){return Mt(this._ctx,e,t,this._ctx.table.core)}clone(e){var t=Object.create(this.constructor.prototype),n=Object.create(this._ctx);return e&&s(n,e),t._ctx=n,t}raw(){return this._ctx.valueMapper=null,this}each(e){var t=this._ctx;return this._read((n=>Mt(t,e,n,t.table.core)))}count(e){return this._read((e=>{const t=this._ctx,n=t.table.core;if(Pt(t,!0))return n.count({trans:e,query:{index:At(t,n.schema),range:t.range}}).then((e=>Math.min(e,t.limit)));var r=0;return Mt(t,(()=>(++r,!1)),e,n).then((()=>r))})).then(e)}sortBy(e,t){const n=e.split(".").reverse(),r=n[0],i=n.length-1;function o(e,t){return t?o(e[n[t]],t-1):e[r]}var s="next"===this._ctx.dir?1:-1;function a(e,t){var n=o(e,i),r=o(t,i);return n<r?-s:n>r?s:0}return this.toArray((function(e){return e.sort(a)})).then(t)}toArray(e){return this._read((e=>{var t=this._ctx;if("next"===t.dir&&Pt(t,!0)&&t.limit>0){const{valueMapper:n}=t,r=At(t,t.table.core.schema);return t.table.core.query({trans:e,limit:t.limit,values:!0,query:{index:r,range:t.range}}).then((({result:e})=>n?e.map(n):e))}{const n=[];return Mt(t,(e=>n.push(e)),e,t.table.core).then((()=>n))}}),e)}offset(e){var t=this._ctx;return e<=0||(t.offset+=e,Pt(t)?Tt(t,(()=>{var t=e;return(e,n)=>0===t||(1===t?(--t,!1):(n((()=>{e.advance(t),t=0})),!1))})):Tt(t,(()=>{var t=e;return()=>--t<0}))),this}limit(e){return this._ctx.limit=Math.min(this._ctx.limit,e),Tt(this._ctx,(()=>{var t=e;return function(e,n,r){return--t<=0&&n(r),t>=0}}),!0),this}until(e,t){return Dt(this._ctx,(function(n,r,i){return!e(n.value)||(r(i),t)})),this}first(e){return this.limit(1).toArray((function(e){return e[0]})).then(e)}last(e){return this.reverse().first(e)}filter(e){var t,n;return Dt(this._ctx,(function(t){return e(t.value)})),t=this._ctx,n=e,t.isMatch=kt(t.isMatch,n),this}and(e){return this.filter(e)}or(e){return new this.db.WhereClause(this._ctx.table,e,this)}reverse(){return this._ctx.dir="prev"===this._ctx.dir?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this}desc(){return this.reverse()}eachKey(e){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each((function(t,n){e(n.key,n)}))}eachUniqueKey(e){return this._ctx.unique="unique",this.eachKey(e)}eachPrimaryKey(e){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each((function(t,n){e(n.primaryKey,n)}))}keys(e){var t=this._ctx;t.keysOnly=!t.isMatch;var n=[];return this.each((function(e,t){n.push(t.key)})).then((function(){return n})).then(e)}primaryKeys(e){var t=this._ctx;if("next"===t.dir&&Pt(t,!0)&&t.limit>0)return this._read((e=>{var n=At(t,t.table.core.schema);return t.table.core.query({trans:e,values:!1,limit:t.limit,query:{index:n,range:t.range}})})).then((({result:e})=>e)).then(e);t.keysOnly=!t.isMatch;var n=[];return this.each((function(e,t){n.push(t.primaryKey)})).then((function(){return n})).then(e)}uniqueKeys(e){return this._ctx.unique="unique",this.keys(e)}firstKey(e){return this.limit(1).keys((function(e){return e[0]})).then(e)}lastKey(e){return this.reverse().firstKey(e)}distinct(){var e=this._ctx,t=e.index&&e.table.schema.idxByName[e.index];if(!t||!t.multi)return this;var n={};return Dt(this._ctx,(function(e){var t=e.primaryKey.toString(),r=u(n,t);return n[t]=!0,!r})),this}modify(e){var t=this._ctx;return this._write((n=>{var r;if("function"==typeof e)r=e;else{var o=i(e),s=o.length;r=function(t){for(var n=!1,r=0;r<s;++r){var i=o[r],a=e[i];E(t,i)!==a&&(k(t,i,a),n=!0)}return n}}const a=t.table.core,{outbound:c,extractKey:u}=a.schema.primaryKey,l=this.db._options.modifyChunkSize||200,h=[];let d=0;const f=[],p=(e,t)=>{const{failures:n,numFailures:r}=t;d+=e-r;for(let e of i(n))h.push(n[e])};return this.clone().primaryKeys().then((i=>{const o=s=>{const h=Math.min(l,i.length-s);return a.getMany({trans:n,keys:i.slice(s,s+h),cache:"immutable"}).then((d=>{const f=[],m=[],y=c?[]:null,v=[];for(let e=0;e<h;++e){const t=d[e],n={value:P(t),primKey:i[s+e]};!1!==r.call(n,n.value,n)&&(null==n.value?v.push(i[s+e]):c||0===Lt(u(t),u(n.value))?(m.push(n.value),c&&y.push(i[s+e])):(v.push(i[s+e]),f.push(n.value)))}const g=Pt(t)&&t.limit===1/0&&("function"!=typeof e||e===qt)&&{index:t.index,range:t.range};return Promise.resolve(f.length>0&&a.mutate({trans:n,type:"add",values:f}).then((e=>{for(let t in e.failures)v.splice(parseInt(t),1);p(f.length,e)}))).then((()=>(m.length>0||g&&"object"==typeof e)&&a.mutate({trans:n,type:"put",keys:y,values:m,criteria:g,changeSpec:"function"!=typeof e&&e}).then((e=>p(m.length,e))))).then((()=>(v.length>0||g&&e===qt)&&a.mutate({trans:n,type:"delete",keys:v,criteria:g}).then((e=>p(v.length,e))))).then((()=>i.length>s+h&&o(s+l)))}))};return o(0).then((()=>{if(h.length>0)throw new G("Error modifying one or more objects",h,d,f);return i.length}))}))}))}delete(){var e=this._ctx,t=e.range;return Pt(e)&&(e.isPrimKey&&!_t||3===t.type)?this._write((n=>{const{primaryKey:r}=e.table.core.schema,i=t;return e.table.core.count({trans:n,query:{index:r,range:i}}).then((t=>e.table.core.mutate({trans:n,type:"deleteRange",range:i}).then((({failures:e,lastResult:n,results:r,numFailures:i})=>{if(i)throw new G("Could not delete some values",Object.keys(e).map((t=>e[t])),t-i);return t-i}))))})):this.modify(qt)}}const qt=(e,t)=>t.value=null;function Kt(e,t){return e<t?-1:e===t?0:1}function Ut(e,t){return e>t?-1:e===t?0:1}function Wt(e,t,n){var r=e instanceof Gt?new e.Collection(e):e;return r._ctx.error=n?new n(t):new TypeError(t),r}function zt(e){return new e.Collection(e,(()=>Yt(""))).limit(0)}function Ht(e,t,n,r,i,o){for(var s=Math.min(e.length,r.length),a=-1,c=0;c<s;++c){var u=t[c];if(u!==r[c])return i(e[c],n[c])<0?e.substr(0,c)+n[c]+n.substr(c+1):i(e[c],r[c])<0?e.substr(0,c)+r[c]+n.substr(c+1):a>=0?e.substr(0,a)+t[a]+n.substr(a+1):null;i(e[c],u)<0&&(a=c)}return s<r.length&&"next"===o?e+n.substr(e.length):s<e.length&&"prev"===o?e.substr(0,n.length):a<0?null:e.substr(0,a)+r[a]+n.substr(a+1)}function Qt(e,t,n,r){var i,o,s,a,c,u,l,h=n.length;if(!n.every((e=>"string"==typeof e)))return Wt(e,"String expected.");function d(e){i=function(e){return"next"===e?e=>e.toUpperCase():e=>e.toLowerCase()}(e),o=function(e){return"next"===e?e=>e.toLowerCase():e=>e.toUpperCase()}(e),s="next"===e?Kt:Ut;var t=n.map((function(e){return{lower:o(e),upper:i(e)}})).sort((function(e,t){return s(e.lower,t.lower)}));a=t.map((function(e){return e.upper})),c=t.map((function(e){return e.lower})),u=e,l="next"===e?"":r}d("next");var f=new e.Collection(e,(()=>Vt(a[0],c[h-1]+r)));f._ondirectionchange=function(e){d(e)};var p=0;return f._addAlgorithm((function(e,n,r){var i=e.key;if("string"!=typeof i)return!1;var d=o(i);if(t(d,c,p))return!0;for(var f=null,m=p;m<h;++m){var y=Ht(i,d,a[m],c[m],s,u);null===y&&null===f?p=m+1:(null===f||s(f,y)>0)&&(f=y)}return n(null!==f?function(){e.continue(f+l)}:r),!1})),f}function Vt(e,t,n,r){return{type:2,lower:e,upper:t,lowerOpen:n,upperOpen:r}}function Yt(e){return{type:1,lower:e,upper:e}}class Gt{get Collection(){return this._ctx.table.db.Collection}between(e,t,n,r){n=!1!==n,r=!0===r;try{return this._cmp(e,t)>0||0===this._cmp(e,t)&&(n||r)&&(!n||!r)?zt(this):new this.Collection(this,(()=>Vt(e,t,!n,!r)))}catch(e){return Wt(this,vt)}}equals(e){return null==e?Wt(this,vt):new this.Collection(this,(()=>Yt(e)))}above(e){return null==e?Wt(this,vt):new this.Collection(this,(()=>Vt(e,void 0,!0)))}aboveOrEqual(e){return null==e?Wt(this,vt):new this.Collection(this,(()=>Vt(e,void 0,!1)))}below(e){return null==e?Wt(this,vt):new this.Collection(this,(()=>Vt(void 0,e,!1,!0)))}belowOrEqual(e){return null==e?Wt(this,vt):new this.Collection(this,(()=>Vt(void 0,e)))}startsWith(e){return"string"!=typeof e?Wt(this,"String expected."):this.between(e,e+yt,!0,!0)}startsWithIgnoreCase(e){return""===e?this.startsWith(e):Qt(this,((e,t)=>0===e.indexOf(t[0])),[e],yt)}equalsIgnoreCase(e){return Qt(this,((e,t)=>e===t[0]),[e],"")}anyOfIgnoreCase(){var e=L.apply(N,arguments);return 0===e.length?zt(this):Qt(this,((e,t)=>-1!==t.indexOf(e)),e,"")}startsWithAnyOfIgnoreCase(){var e=L.apply(N,arguments);return 0===e.length?zt(this):Qt(this,((e,t)=>t.some((t=>0===e.indexOf(t)))),e,yt)}anyOf(){const e=L.apply(N,arguments);let t=this._cmp;try{e.sort(t)}catch(e){return Wt(this,vt)}if(0===e.length)return zt(this);const n=new this.Collection(this,(()=>Vt(e[0],e[e.length-1])));n._ondirectionchange=n=>{t="next"===n?this._ascending:this._descending,e.sort(t)};let r=0;return n._addAlgorithm(((n,i,o)=>{const s=n.key;for(;t(s,e[r])>0;)if(++r,r===e.length)return i(o),!1;return 0===t(s,e[r])||(i((()=>{n.continue(e[r])})),!1)})),n}notEqual(e){return this.inAnyRange([[-1/0,e],[e,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})}noneOf(){const e=L.apply(N,arguments);if(0===e.length)return new this.Collection(this);try{e.sort(this._ascending)}catch(e){return Wt(this,vt)}const t=e.reduce(((e,t)=>e?e.concat([[e[e.length-1][1],t]]):[[-1/0,t]]),null);return t.push([e[e.length-1],this.db._maxKey]),this.inAnyRange(t,{includeLowers:!1,includeUppers:!1})}inAnyRange(e,t){const n=this._cmp,r=this._ascending,i=this._descending,o=this._min,s=this._max;if(0===e.length)return zt(this);if(!e.every((e=>void 0!==e[0]&&void 0!==e[1]&&r(e[0],e[1])<=0)))return Wt(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",ee.InvalidArgument);const a=!t||!1!==t.includeLowers,c=t&&!0===t.includeUppers;let u,l=r;function h(e,t){return l(e[0],t[0])}try{u=e.reduce((function(e,t){let r=0,i=e.length;for(;r<i;++r){const i=e[r];if(n(t[0],i[1])<0&&n(t[1],i[0])>0){i[0]=o(i[0],t[0]),i[1]=s(i[1],t[1]);break}}return r===i&&e.push(t),e}),[]),u.sort(h)}catch(e){return Wt(this,vt)}let d=0;const f=c?e=>r(e,u[d][1])>0:e=>r(e,u[d][1])>=0,p=a?e=>i(e,u[d][0])>0:e=>i(e,u[d][0])>=0;let m=f;const y=new this.Collection(this,(()=>Vt(u[0][0],u[u.length-1][1],!a,!c)));return y._ondirectionchange=e=>{"next"===e?(m=f,l=r):(m=p,l=i),u.sort(h)},y._addAlgorithm(((e,t,n)=>{for(var i=e.key;m(i);)if(++d,d===u.length)return t(n),!1;return!!function(e){return!f(e)&&!p(e)}(i)||(0===this._cmp(i,u[d][1])||0===this._cmp(i,u[d][0])||t((()=>{l===r?e.continue(u[d][0]):e.continue(u[d][1])})),!1)})),y}startsWithAnyOf(){const e=L.apply(N,arguments);return e.every((e=>"string"==typeof e))?0===e.length?zt(this):this.inAnyRange(e.map((e=>[e,e+yt]))):Wt(this,"startsWithAnyOf() only works with strings")}}function Jt(e){return Ve((function(t){return Zt(t),e(t.target.error),!1}))}function Zt(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault()}const Xt=Rt(null,"storagemutated");class en{_lock(){return b(!Ie.global),++this._reculock,1!==this._reculock||Ie.global||(Ie.lockOwnerFor=this),this}_unlock(){if(b(!Ie.global),0==--this._reculock)for(Ie.global||(Ie.lockOwnerFor=null);this._blockedFuncs.length>0&&!this._locked();){var e=this._blockedFuncs.shift();try{ut(e[1],e[0])}catch(e){}}return this}_locked(){return this._reculock&&Ie.lockOwnerFor!==this}create(e){if(!this.mode)return this;const t=this.db.idbdb,n=this.db._state.dbOpenError;if(b(!this.idbtrans),!e&&!t)switch(n&&n.name){case"DatabaseClosedError":throw new ee.DatabaseClosed(n);case"MissingAPIError":throw new ee.MissingAPI(n.message,n);default:throw new ee.OpenFailed(n)}if(!this.active)throw new ee.TransactionInactive;return b(null===this._completion._state),(e=this.idbtrans=e||(this.db.core?this.db.core.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}):t.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}))).onerror=Ve((t=>{Zt(t),this._reject(e.error)})),e.onabort=Ve((t=>{Zt(t),this.active&&this._reject(new ee.Abort(e.error)),this.active=!1,this.on("abort").fire(t)})),e.oncomplete=Ve((()=>{this.active=!1,this._resolve(),"mutatedParts"in e&&Xt.storagemutated.fire(e.mutatedParts)})),this}_promise(e,t,n){if("readwrite"===e&&"readwrite"!==this.mode)return pt(new ee.ReadOnly("Transaction is readonly"));if(!this.active)return pt(new ee.TransactionInactive);if(this._locked())return new Ae(((r,i)=>{this._blockedFuncs.push([()=>{this._promise(e,t,n).then(r,i)},Ie])}));if(n)return tt((()=>{var e=new Ae(((e,n)=>{this._lock();const r=t(e,n,this);r&&r.then&&r.then(e,n)}));return e.finally((()=>this._unlock())),e._lib=!0,e}));var r=new Ae(((e,n)=>{var r=t(e,n,this);r&&r.then&&r.then(e,n)}));return r._lib=!0,r}_root(){return this.parent?this.parent._root():this}waitFor(e){var t=this._root();const n=Ae.resolve(e);if(t._waitingFor)t._waitingFor=t._waitingFor.then((()=>n));else{t._waitingFor=n,t._waitingQueue=[];var r=t.idbtrans.objectStore(t.storeNames[0]);!function e(){for(++t._spinCount;t._waitingQueue.length;)t._waitingQueue.shift()();t._waitingFor&&(r.get(-1/0).onsuccess=e)}()}var i=t._waitingFor;return new Ae(((e,r)=>{n.then((n=>t._waitingQueue.push(Ve(e.bind(null,n)))),(e=>t._waitingQueue.push(Ve(r.bind(null,e))))).finally((()=>{t._waitingFor===i&&(t._waitingFor=null)}))}))}abort(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new ee.Abort))}table(e){const t=this._memoizedTables||(this._memoizedTables={});if(u(t,e))return t[e];const n=this.schema[e];if(!n)throw new ee.NotFound("Table "+e+" not part of transaction");const r=new this.db.Table(e,n,this);return r.core=this.db.core.table(e),t[e]=r,r}}function tn(e,t,n,r,i,o,s){return{name:e,keyPath:t,unique:n,multi:r,auto:i,compound:o,src:(n&&!s?"&":"")+(r?"*":"")+(i?"++":"")+nn(t)}}function nn(e){return"string"==typeof e?e:e?"["+[].join.call(e,"+")+"]":""}function rn(e,t,n){return{name:e,primKey:t,indexes:n,mappedClass:null,idxByName:_(n,(e=>[e.name,e]))}}let on=e=>{try{return e.only([[]]),on=()=>[[]],[[]]}catch(e){return on=()=>yt,yt}};function sn(e){return null==e?()=>{}:"string"==typeof e?function(e){return 1===e.split(".").length?t=>t[e]:t=>E(t,e)}(e):t=>E(t,e)}function an(e){return[].slice.call(e)}let cn=0;function un(e){return null==e?":id":"string"==typeof e?e:`[${e.join("+")}]`}function ln(e,t,n){function r(e){if(3===e.type)return null;if(4===e.type)throw new Error("Cannot convert never type to IDBKeyRange");const{lower:n,upper:r,lowerOpen:i,upperOpen:o}=e;return void 0===n?void 0===r?null:t.upperBound(r,!!o):void 0===r?t.lowerBound(n,!!i):t.bound(n,r,!!i,!!o)}const{schema:i,hasGetAll:s}=function(e,t){const n=an(e.objectStoreNames);return{schema:{name:e.name,tables:n.map((e=>t.objectStore(e))).map((e=>{const{keyPath:t,autoIncrement:n}=e,r=o(t),i=null==t,s={},a={name:e.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:i,compound:r,keyPath:t,autoIncrement:n,unique:!0,extractKey:sn(t)},indexes:an(e.indexNames).map((t=>e.index(t))).map((e=>{const{name:t,unique:n,multiEntry:r,keyPath:i}=e,a={name:t,compound:o(i),keyPath:i,unique:n,multiEntry:r,extractKey:sn(i)};return s[un(i)]=a,a})),getIndexByKeyPath:e=>s[un(e)]};return s[":id"]=a.primaryKey,null!=t&&(s[un(t)]=a.primaryKey),a}))},hasGetAll:n.length>0&&"getAll"in t.objectStore(n[0])&&!("undefined"!=typeof navigator&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}}(e,n),a=i.tables.map((e=>function(e){const t=e.name;return{name:t,schema:e,mutate:function({trans:e,type:n,keys:i,values:o,range:s}){return new Promise(((a,c)=>{a=Ve(a);const u=e.objectStore(t),l=null==u.keyPath,h="put"===n||"add"===n;if(!h&&"delete"!==n&&"deleteRange"!==n)throw new Error("Invalid operation type: "+n);const{length:d}=i||o||{length:1};if(i&&o&&i.length!==o.length)throw new Error("Given keys array must have same length as given values array.");if(0===d)return a({numFailures:0,failures:{},results:[],lastResult:void 0});let f;const p=[],m=[];let y=0;const v=e=>{++y,Zt(e)};if("deleteRange"===n){if(4===s.type)return a({numFailures:y,failures:m,results:[],lastResult:void 0});3===s.type?p.push(f=u.clear()):p.push(f=u.delete(r(s)))}else{const[e,t]=h?l?[o,i]:[o,null]:[i,null];if(h)for(let r=0;r<d;++r)p.push(f=t&&void 0!==t[r]?u[n](e[r],t[r]):u[n](e[r])),f.onerror=v;else for(let t=0;t<d;++t)p.push(f=u[n](e[t])),f.onerror=v}const g=e=>{const t=e.target.result;p.forEach(((e,t)=>null!=e.error&&(m[t]=e.error))),a({numFailures:y,failures:m,results:"delete"===n?i:p.map((e=>e.result)),lastResult:t})};f.onerror=e=>{v(e),g(e)},f.onsuccess=g}))},getMany:({trans:e,keys:n})=>new Promise(((r,i)=>{r=Ve(r);const o=e.objectStore(t),s=n.length,a=new Array(s);let c,u=0,l=0;const h=e=>{const t=e.target;a[t._pos]=t.result,++l===u&&r(a)},d=Jt(i);for(let e=0;e<s;++e)null!=n[e]&&(c=o.get(n[e]),c._pos=e,c.onsuccess=h,c.onerror=d,++u);0===u&&r(a)})),get:({trans:e,key:n})=>new Promise(((r,i)=>{r=Ve(r);const o=e.objectStore(t).get(n);o.onsuccess=e=>r(e.target.result),o.onerror=Jt(i)})),query:function(e){return n=>new Promise(((i,o)=>{i=Ve(i);const{trans:s,values:a,limit:c,query:u}=n,l=c===1/0?void 0:c,{index:h,range:d}=u,f=s.objectStore(t),p=h.isPrimaryKey?f:f.index(h.name),m=r(d);if(0===c)return i({result:[]});if(e){const e=a?p.getAll(m,l):p.getAllKeys(m,l);e.onsuccess=e=>i({result:e.target.result}),e.onerror=Jt(o)}else{let e=0;const t=a||!("openKeyCursor"in p)?p.openCursor(m):p.openKeyCursor(m),n=[];t.onsuccess=r=>{const o=t.result;return o?(n.push(a?o.value:o.primaryKey),++e===c?i({result:n}):void o.continue()):i({result:n})},t.onerror=Jt(o)}}))}(s),openCursor:function({trans:e,values:n,query:i,reverse:o,unique:s}){return new Promise(((a,c)=>{a=Ve(a);const{index:u,range:l}=i,h=e.objectStore(t),d=u.isPrimaryKey?h:h.index(u.name),f=o?s?"prevunique":"prev":s?"nextunique":"next",p=n||!("openKeyCursor"in d)?d.openCursor(r(l),f):d.openKeyCursor(r(l),f);p.onerror=Jt(c),p.onsuccess=Ve((t=>{const n=p.result;if(!n)return void a(null);n.___id=++cn,n.done=!1;const r=n.continue.bind(n);let i=n.continuePrimaryKey;i&&(i=i.bind(n));const o=n.advance.bind(n),s=()=>{throw new Error("Cursor not stopped")};n.trans=e,n.stop=n.continue=n.continuePrimaryKey=n.advance=()=>{throw new Error("Cursor not started")},n.fail=Ve(c),n.next=function(){let e=1;return this.start((()=>e--?this.continue():this.stop())).then((()=>this))},n.start=e=>{const t=new Promise(((e,t)=>{e=Ve(e),p.onerror=Jt(t),n.fail=t,n.stop=t=>{n.stop=n.continue=n.continuePrimaryKey=n.advance=s,e(t)}})),a=()=>{if(p.result)try{e()}catch(e){n.fail(e)}else n.done=!0,n.start=()=>{throw new Error("Cursor behind last entry")},n.stop()};return p.onsuccess=Ve((e=>{p.onsuccess=a,a()})),n.continue=r,n.continuePrimaryKey=i,n.advance=o,a(),t},a(n)}),c)}))},count({query:e,trans:n}){const{index:i,range:o}=e;return new Promise(((e,s)=>{const a=n.objectStore(t),c=i.isPrimaryKey?a:a.index(i.name),u=r(o),l=u?c.count(u):c.count();l.onsuccess=Ve((t=>e(t.target.result))),l.onerror=Jt(s)}))}}}(e))),c={};return a.forEach((e=>c[e.name]=e)),{stack:"dbcore",transaction:e.transaction.bind(e),table(e){if(!c[e])throw new Error(`Table '${e}' not found`);return c[e]},MIN_KEY:-1/0,MAX_KEY:on(t),schema:i}}function hn({_novip:e},t){const n=t.db,r=function(e,t,{IDBKeyRange:n,indexedDB:r},i){const o=function(e,t){return t.reduce(((e,{create:t})=>({...e,...t(e)})),e)}(ln(t,n,i),e.dbcore);return{dbcore:o}}(e._middlewares,n,e._deps,t);e.core=r.dbcore,e.tables.forEach((t=>{const n=t.name;e.core.schema.tables.some((e=>e.name===n))&&(t.core=e.core.table(n),e[n]instanceof e.Table&&(e[n].core=t.core))}))}function dn({_novip:e},t,n,r){n.forEach((n=>{const i=r[n];t.forEach((t=>{const r=m(t,n);(!r||"value"in r&&void 0===r.value)&&(t===e.Transaction.prototype||t instanceof e.Transaction?d(t,n,{get(){return this.table(n)},set(e){h(this,n,{value:e,writable:!0,configurable:!0,enumerable:!0})}}):t[n]=new e.Table(n,i))}))}))}function fn({_novip:e},t){t.forEach((t=>{for(let n in t)t[n]instanceof e.Table&&delete t[n]}))}function pn(e,t){return e._cfg.version-t._cfg.version}function mn(e,t,n,r){const o=e._dbSchema,s=e._createTransaction("readwrite",e._storeNames,o);s.create(n),s._completion.catch(r);const a=s._reject.bind(s),c=Ie.transless||Ie;tt((()=>{Ie.trans=s,Ie.transless=c,0===t?(i(o).forEach((e=>{vn(n,e,o[e].primKey,o[e].indexes)})),hn(e,n),Ae.follow((()=>e.on.populate.fire(s))).catch(a)):function({_novip:e},t,n,r){const o=[],s=e._versions;let a=e._dbSchema=bn(e,e.idbdb,r),c=!1;return s.filter((e=>e._cfg.version>=t)).forEach((s=>{o.push((()=>{const o=a,u=s._cfg.dbschema;wn(e,o,r),wn(e,u,r),a=e._dbSchema=u;const l=yn(o,u);l.add.forEach((e=>{vn(r,e[0],e[1].primKey,e[1].indexes)})),l.change.forEach((e=>{if(e.recreate)throw new ee.Upgrade("Not yet support for changing primary key");{const t=r.objectStore(e.name);e.add.forEach((e=>gn(t,e))),e.change.forEach((e=>{t.deleteIndex(e.name),gn(t,e)})),e.del.forEach((e=>t.deleteIndex(e)))}}));const h=s._cfg.contentUpgrade;if(h&&s._cfg.version>t){hn(e,r),n._memoizedTables={},c=!0;let t=S(u);l.del.forEach((e=>{t[e]=o[e]})),fn(e,[e.Transaction.prototype]),dn(e,[e.Transaction.prototype],i(t),t),n.schema=t;const s=B(h);let a;s&&nt();const d=Ae.follow((()=>{if(a=h(n),a&&s){var e=rt.bind(null,null);a.then(e,e)}}));return a&&"function"==typeof a.then?Ae.resolve(a):d.then((()=>a))}})),o.push((t=>{c&&wt||function(e,t){[].slice.call(t.db.objectStoreNames).forEach((n=>null==e[n]&&t.db.deleteObjectStore(n)))}(s._cfg.dbschema,t),fn(e,[e.Transaction.prototype]),dn(e,[e.Transaction.prototype],e._storeNames,e._dbSchema),n.schema=e._dbSchema}))})),function e(){return o.length?Ae.resolve(o.shift()(n.idbtrans)).then(e):Ae.resolve()}().then((()=>{var e,t;t=r,i(e=a).forEach((n=>{t.db.objectStoreNames.contains(n)||vn(t,n,e[n].primKey,e[n].indexes)}))}))}(e,t,s,n).catch(a)}))}function yn(e,t){const n={del:[],add:[],change:[]};let r;for(r in e)t[r]||n.del.push(r);for(r in t){const i=e[r],o=t[r];if(i){const e={name:r,def:o,recreate:!1,del:[],add:[],change:[]};if(""+(i.primKey.keyPath||"")!=""+(o.primKey.keyPath||"")||i.primKey.auto!==o.primKey.auto&&!bt)e.recreate=!0,n.change.push(e);else{const t=i.idxByName,r=o.idxByName;let s;for(s in t)r[s]||e.del.push(s);for(s in r){const n=t[s],i=r[s];n?n.src!==i.src&&e.change.push(i):e.add.push(i)}(e.del.length>0||e.add.length>0||e.change.length>0)&&n.change.push(e)}}else n.add.push([r,o])}return n}function vn(e,t,n,r){const i=e.db.createObjectStore(t,n.keyPath?{keyPath:n.keyPath,autoIncrement:n.auto}:{autoIncrement:n.auto});return r.forEach((e=>gn(i,e))),i}function gn(e,t){e.createIndex(t.name,t.keyPath,{unique:t.unique,multiEntry:t.multi})}function bn(e,t,n){const r={};return v(t.objectStoreNames,0).forEach((e=>{const t=n.objectStore(e);let i=t.keyPath;const o=tn(nn(i),i||"",!1,!1,!!t.autoIncrement,i&&"string"!=typeof i,!0),s=[];for(let e=0;e<t.indexNames.length;++e){const n=t.index(t.indexNames[e]);i=n.keyPath;var a=tn(n.name,i,!!n.unique,!!n.multiEntry,!1,i&&"string"!=typeof i,!1);s.push(a)}r[e]=rn(e,o,s)})),r}function wn({_novip:e},t,n){const i=n.db.objectStoreNames;for(let r=0;r<i.length;++r){const o=i[r],s=n.objectStore(o);e._hasGetAll="getAll"in s;for(let e=0;e<s.indexNames.length;++e){const n=s.indexNames[e],r=s.index(n).keyPath,i="string"==typeof r?r:"["+v(r).join("+")+"]";if(t[o]){const e=t[o].idxByName[i];e&&(e.name=n,delete t[o].idxByName[i],t[o].idxByName[n]=e)}}}"undefined"!=typeof navigator&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&r.WorkerGlobalScope&&r instanceof r.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(e._hasGetAll=!1)}class _n{_parseStoresSpec(e,t){i(e).forEach((n=>{if(null!==e[n]){var r=e[n].split(",").map(((e,t)=>{const n=(e=e.trim()).replace(/([&*]|\+\+)/g,""),r=/^\[/.test(n)?n.match(/^\[(.*)\]$/)[1].split("+"):n;return tn(n,r||null,/\&/.test(e),/\*/.test(e),/\+\+/.test(e),o(r),0===t)})),i=r.shift();if(i.multi)throw new ee.Schema("Primary key cannot be multi-valued");r.forEach((e=>{if(e.auto)throw new ee.Schema("Only primary key can be marked as autoIncrement (++)");if(!e.keyPath)throw new ee.Schema("Index must have a name and cannot be an empty string")})),t[n]=rn(n,i,r)}}))}stores(e){const t=this.db;this._cfg.storesSource=this._cfg.storesSource?s(this._cfg.storesSource,e):e;const n=t._versions,r={};let o={};return n.forEach((e=>{s(r,e._cfg.storesSource),o=e._cfg.dbschema={},e._parseStoresSpec(r,o)})),t._dbSchema=o,fn(t,[t._allTables,t,t.Transaction.prototype]),dn(t,[t._allTables,t,t.Transaction.prototype,this._cfg.tables],i(o),o),t._storeNames=i(o),this}upgrade(e){return this._cfg.contentUpgrade=he(this._cfg.contentUpgrade||re,e),this}}function En(e,t){let n=e._dbNamesDB;return n||(n=e._dbNamesDB=new Un("__dbnames",{addons:[],indexedDB:e,IDBKeyRange:t}),n.version(1).stores({dbnames:"name"})),n.table("dbnames")}function kn(e){return e&&"function"==typeof e.databases}function Sn(e){return tt((function(){return Ie.letThrough=!0,e()}))}function xn(){var e;return!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise((function(t){var n=function(){return indexedDB.databases().finally(t)};e=setInterval(n,100),n()})).finally((function(){return clearInterval(e)})):Promise.resolve()}function Cn(e){var t=t=>e.next(t),n=i(t),r=i((t=>e.throw(t)));function i(e){return t=>{var i=e(t),s=i.value;return i.done?s:s&&"function"==typeof s.then?s.then(n,r):o(s)?Promise.all(s).then(n,r):n(s)}}return i(t)()}function On(e,t,n){var r=arguments.length;if(r<2)throw new ee.InvalidArgument("Too few arguments");for(var i=new Array(r-1);--r;)i[r-1]=arguments[r];return n=i.pop(),[e,C(i),n]}function Rn(e,t,n,r,i){return Ae.resolve().then((()=>{const o=Ie.transless||Ie,s=e._createTransaction(t,n,e._dbSchema,r),a={trans:s,transless:o};if(r)s.idbtrans=r.idbtrans;else try{s.create(),e._state.PR1398_maxLoop=3}catch(r){return r.name===Z.InvalidState&&e.isOpen()&&--e._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),e._close(),e.open().then((()=>Rn(e,t,n,null,i)))):pt(r)}const c=B(i);let u;c&&nt();const l=Ae.follow((()=>{if(u=i.call(s,s),u)if(c){var e=rt.bind(null,null);u.then(e,e)}else"function"==typeof u.next&&"function"==typeof u.throw&&(u=Cn(u))}),a);return(u&&"function"==typeof u.then?Ae.resolve(u).then((e=>s.active?e:pt(new ee.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn")))):l.then((()=>u))).then((e=>(r&&s._resolve(),s._completion.then((()=>e))))).catch((e=>(s._reject(e),pt(e))))}))}function In(e,t,n){const r=o(e)?e.slice():[e];for(let e=0;e<n;++e)r.push(t);return r}const Pn={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(e){return{...e,table(t){const n=e.table(t),{schema:r}=n,i={},o=[];function s(e,t,n){const r=un(e),a=i[r]=i[r]||[],c=null==e?0:"string"==typeof e?1:e.length,u=t>0,l={...n,isVirtual:u,keyTail:t,keyLength:c,extractKey:sn(e),unique:!u&&n.unique};return a.push(l),l.isPrimaryKey||o.push(l),c>1&&s(2===c?e[0]:e.slice(0,c-1),t+1,n),a.sort(((e,t)=>e.keyTail-t.keyTail)),l}const a=s(r.primaryKey.keyPath,0,r.primaryKey);i[":id"]=[a];for(const e of r.indexes)s(e.keyPath,0,e);function c(t){const n=t.query.index;return n.isVirtual?{...t,query:{index:n,range:(r=t.query.range,i=n.keyTail,{type:1===r.type?2:r.type,lower:In(r.lower,r.lowerOpen?e.MAX_KEY:e.MIN_KEY,i),lowerOpen:!0,upper:In(r.upper,r.upperOpen?e.MIN_KEY:e.MAX_KEY,i),upperOpen:!0})}}:t;var r,i}const u={...n,schema:{...r,primaryKey:a,indexes:o,getIndexByKeyPath:function(e){const t=i[un(e)];return t&&t[0]}},count:e=>n.count(c(e)),query:e=>n.query(c(e)),openCursor(t){const{keyTail:r,isVirtual:i,keyLength:o}=t.query.index;return i?n.openCursor(c(t)).then((n=>n&&function(n){const i=Object.create(n,{continue:{value:function(i){null!=i?n.continue(In(i,t.reverse?e.MAX_KEY:e.MIN_KEY,r)):t.unique?n.continue(n.key.slice(0,o).concat(t.reverse?e.MIN_KEY:e.MAX_KEY,r)):n.continue()}},continuePrimaryKey:{value(t,i){n.continuePrimaryKey(In(t,e.MAX_KEY,r),i)}},primaryKey:{get:()=>n.primaryKey},key:{get(){const e=n.key;return 1===o?e[0]:e.slice(0,o)}},value:{get:()=>n.value}});return i}(n))):n.openCursor(t)}};return u}}}};function Dn(e,t,n,r){return n=n||{},r=r||"",i(e).forEach((i=>{if(u(t,i)){var o=e[i],s=t[i];if("object"==typeof o&&"object"==typeof s&&o&&s){const e=A(o);e!==A(s)?n[r+i]=t[i]:"Object"===e?Dn(o,s,n,r+i+"."):o!==s&&(n[r+i]=t[i])}else o!==s&&(n[r+i]=t[i])}else n[r+i]=void 0})),i(t).forEach((i=>{u(e,i)||(n[r+i]=t[i])})),n}const Tn={stack:"dbcore",name:"HooksMiddleware",level:2,create:e=>({...e,table(t){const n=e.table(t),{primaryKey:r}=n.schema,i={...n,mutate(e){const i=Ie.trans,{deleting:o,creating:s,updating:a}=i.table(t).hook;switch(e.type){case"add":if(s.fire===re)break;return i._promise("readwrite",(()=>c(e)),!0);case"put":if(s.fire===re&&a.fire===re)break;return i._promise("readwrite",(()=>c(e)),!0);case"delete":if(o.fire===re)break;return i._promise("readwrite",(()=>c(e)),!0);case"deleteRange":if(o.fire===re)break;return i._promise("readwrite",(()=>function(e){return l(e.trans,e.range,1e4)}(e)),!0)}return n.mutate(e);function c(e){const t=Ie.trans,i=e.keys||function(e,t){return"delete"===t.type?t.keys:t.keys||t.values.map(e.extractKey)}(r,e);if(!i)throw new Error("Keys missing");return"delete"!==(e="add"===e.type||"put"===e.type?{...e,keys:i}:{...e}).type&&(e.values=[...e.values]),e.keys&&(e.keys=[...e.keys]),function(e,t,n){return"add"===t.type?Promise.resolve([]):e.getMany({trans:t.trans,keys:n,cache:"immutable"})}(n,e,i).then((c=>{const l=i.map(((n,i)=>{const l=c[i],h={onerror:null,onsuccess:null};if("delete"===e.type)o.fire.call(h,n,l,t);else if("add"===e.type||void 0===l){const o=s.fire.call(h,n,e.values[i],t);null==n&&null!=o&&(n=o,e.keys[i]=n,r.outbound||k(e.values[i],r.keyPath,n))}else{const r=Dn(l,e.values[i]),o=a.fire.call(h,r,n,l,t);if(o){const t=e.values[i];Object.keys(o).forEach((e=>{u(t,e)?t[e]=o[e]:k(t,e,o[e])}))}}return h}));return n.mutate(e).then((({failures:t,results:n,numFailures:r,lastResult:o})=>{for(let r=0;r<i.length;++r){const o=n?n[r]:i[r],s=l[r];null==o?s.onerror&&s.onerror(t[r]):s.onsuccess&&s.onsuccess("put"===e.type&&c[r]?e.values[r]:o)}return{failures:t,results:n,numFailures:r,lastResult:o}})).catch((e=>(l.forEach((t=>t.onerror&&t.onerror(e))),Promise.reject(e))))}))}function l(e,t,i){return n.query({trans:e,values:!1,query:{index:r,range:t},limit:i}).then((({result:n})=>c({type:"delete",keys:n,trans:e}).then((r=>r.numFailures>0?Promise.reject(r.failures[0]):n.length<i?{failures:[],numFailures:0,lastResult:void 0}:l(e,{...t,lower:n[n.length-1],lowerOpen:!0},i)))))}}};return i}})};function An(e,t,n){try{if(!t)return null;if(t.keys.length<e.length)return null;const r=[];for(let i=0,o=0;i<t.keys.length&&o<e.length;++i)0===Lt(t.keys[i],e[o])&&(r.push(n?P(t.values[i]):t.values[i]),++o);return r.length===e.length?r:null}catch(e){return null}}const jn={stack:"dbcore",level:-1,create:e=>({table:t=>{const n=e.table(t);return{...n,getMany:e=>{if(!e.cache)return n.getMany(e);const t=An(e.keys,e.trans._cache,"clone"===e.cache);return t?Ae.resolve(t):n.getMany(e).then((t=>(e.trans._cache={keys:e.keys,values:"clone"===e.cache?P(t):t},t)))},mutate:e=>("add"!==e.type&&(e.trans._cache=null),n.mutate(e))}}})};function Mn(e){return!("from"in e)}const Nn=function(e,t){if(!this){const t=new Nn;return e&&"d"in e&&s(t,e),t}s(this,arguments.length?{d:1,from:e,to:arguments.length>1?t:e}:{d:0})};function Ln(e,t,n){const r=Lt(t,n);if(isNaN(r))return;if(r>0)throw RangeError();if(Mn(e))return s(e,{from:t,to:n,d:1});const i=e.l,o=e.r;if(Lt(n,e.from)<0)return i?Ln(i,t,n):e.l={from:t,to:n,d:1,l:null,r:null},$n(e);if(Lt(t,e.to)>0)return o?Ln(o,t,n):e.r={from:t,to:n,d:1,l:null,r:null},$n(e);Lt(t,e.from)<0&&(e.from=t,e.l=null,e.d=o?o.d+1:1),Lt(n,e.to)>0&&(e.to=n,e.r=null,e.d=e.l?e.l.d+1:1);const a=!e.r;i&&!e.l&&Bn(e,i),o&&a&&Bn(e,o)}function Bn(e,t){Mn(t)||function e(t,{from:n,to:r,l:i,r:o}){Ln(t,n,r),i&&e(t,i),o&&e(t,o)}(e,t)}function Fn(e){let t=Mn(e)?null:{s:0,n:e};return{next(e){const n=arguments.length>0;for(;t;)switch(t.s){case 0:if(t.s=1,n)for(;t.n.l&&Lt(e,t.n.from)<0;)t={up:t,n:t.n.l,s:1};else for(;t.n.l;)t={up:t,n:t.n.l,s:1};case 1:if(t.s=2,!n||Lt(e,t.n.to)<=0)return{value:t.n,done:!1};case 2:if(t.n.r){t.s=3,t={up:t,n:t.n.r,s:0};continue}case 3:t=t.up}return{done:!0}}}}function $n(e){var t,n;const r=((null===(t=e.r)||void 0===t?void 0:t.d)||0)-((null===(n=e.l)||void 0===n?void 0:n.d)||0),i=r>1?"r":r<-1?"l":"";if(i){const t="r"===i?"l":"r",n={...e},r=e[i];e.from=r.from,e.to=r.to,e[i]=r[i],n[i]=r[t],e[t]=n,n.d=qn(n)}e.d=qn(e)}function qn({r:e,l:t}){return(e?t?Math.max(e.d,t.d):e.d:t?t.d:0)+1}l(Nn.prototype,{add(e){return Bn(this,e),this},addKey(e){return Ln(this,e,e),this},addKeys(e){return e.forEach((e=>Ln(this,e,e))),this},[j](){return Fn(this)}});const Kn={stack:"dbcore",level:0,create:e=>{const t=e.schema.name,n=new Nn(e.MIN_KEY,e.MAX_KEY);return{...e,table:r=>{const s=e.table(r),{schema:a}=s,{primaryKey:c}=a,{extractKey:u,outbound:l}=c,h={...s,mutate:e=>{const i=e.trans,c=i.mutatedParts||(i.mutatedParts={}),u=e=>{const n=`idb://${t}/${r}/${e}`;return c[n]||(c[n]=new Nn)},l=u(""),h=u(":dels"),{type:d}=e;let[f,p]="deleteRange"===e.type?[e.range]:"delete"===e.type?[e.keys]:e.values.length<50?[[],e.values]:[];const m=e.trans._cache;return s.mutate(e).then((e=>{if(o(f)){"delete"!==d&&(f=e.results),l.addKeys(f);const t=An(f,m);t||"add"===d||h.addKeys(f),(t||p)&&function(e,t,n,r){t.indexes.forEach((function(t){const i=e(t.name||"");function s(e){return null!=e?t.extractKey(e):null}const a=e=>t.multiEntry&&o(e)?e.forEach((e=>i.addKey(e))):i.addKey(e);(n||r).forEach(((e,t)=>{const i=n&&s(n[t]),o=r&&s(r[t]);0!==Lt(i,o)&&(null!=i&&a(i),null!=o&&a(o))}))}))}(u,a,t,p)}else if(f){const e={from:f.lower,to:f.upper};h.add(e),l.add(e)}else l.add(n),h.add(n),a.indexes.forEach((e=>u(e.name).add(n)));return e}))}},d=({query:{index:t,range:n}})=>{var r,i;return[t,new Nn(null!==(r=n.lower)&&void 0!==r?r:e.MIN_KEY,null!==(i=n.upper)&&void 0!==i?i:e.MAX_KEY)]},f={get:e=>[c,new Nn(e.key)],getMany:e=>[c,(new Nn).addKeys(e.keys)],count:d,query:d,openCursor:d};return i(f).forEach((e=>{h[e]=function(i){const{subscr:o}=Ie;if(o){const a=e=>{const n=`idb://${t}/${r}/${e}`;return o[n]||(o[n]=new Nn)},c=a(""),h=a(":dels"),[d,p]=f[e](i);if(a(d.name||"").add(p),!d.isPrimaryKey){if("count"!==e){const t="query"===e&&l&&i.values&&s.query({...i,values:!1});return s[e].apply(this,arguments).then((n=>{if("query"===e){if(l&&i.values)return t.then((({result:e})=>(c.addKeys(e),n)));const e=i.values?n.result.map(u):n.result;i.values?c.addKeys(e):h.addKeys(e)}else if("openCursor"===e){const e=n,t=i.values;return e&&Object.create(e,{key:{get:()=>(h.addKey(e.primaryKey),e.key)},primaryKey:{get(){const t=e.primaryKey;return h.addKey(t),t}},value:{get:()=>(t&&c.addKey(e.primaryKey),e.value)}})}return n}))}h.add(n)}}return s[e].apply(this,arguments)}})),h}}}};class Un{constructor(e,t){this._middlewares={},this.verno=0;const n=Un.dependencies;this._options=t={addons:Un.addons,autoOpen:!0,indexedDB:n.indexedDB,IDBKeyRange:n.IDBKeyRange,...t},this._deps={indexedDB:t.indexedDB,IDBKeyRange:t.IDBKeyRange};const{addons:r}=t;this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;const i={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:re,dbReadyPromise:null,cancelOpen:re,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3};var o;i.dbReadyPromise=new Ae((e=>{i.dbReadyResolve=e})),i.openCanceller=new Ae(((e,t)=>{i.cancelOpen=t})),this._state=i,this.name=e,this.on=Rt(this,"populate","blocked","versionchange","close",{ready:[he,re]}),this.on.ready.subscribe=g(this.on.ready.subscribe,(e=>(t,n)=>{Un.vip((()=>{const r=this._state;if(r.openComplete)r.dbOpenError||Ae.resolve().then(t),n&&e(t);else if(r.onReadyBeingFired)r.onReadyBeingFired.push(t),n&&e(t);else{e(t);const r=this;n||e((function e(){r.on.ready.unsubscribe(t),r.on.ready.unsubscribe(e)}))}}))})),this.Collection=(o=this,It($t.prototype,(function(e,t){this.db=o;let n=St,r=null;if(t)try{n=t()}catch(e){r=e}const i=e._ctx,s=i.table,a=s.hook.reading.fire;this._ctx={table:s,index:i.index,isPrimKey:!i.index||s.schema.primKey.keyPath&&i.index===s.schema.primKey.name,range:n,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:r,or:i.or,valueMapper:a!==ie?a:null}}))),this.Table=function(e){return It(Ot.prototype,(function(t,n,r){this.db=e,this._tx=r,this.name=t,this.schema=n,this.hook=e._allTables[t]?e._allTables[t].hook:Rt(null,{creating:[ae,re],reading:[oe,ie],updating:[ue,re],deleting:[ce,re]})}))}(this),this.Transaction=function(e){return It(en.prototype,(function(t,n,r,i,o){this.db=e,this.mode=t,this.storeNames=n,this.schema=r,this.chromeTransactionDurability=i,this.idbtrans=null,this.on=Rt(this,"complete","error","abort"),this.parent=o||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new Ae(((e,t)=>{this._resolve=e,this._reject=t})),this._completion.then((()=>{this.active=!1,this.on.complete.fire()}),(e=>{var t=this.active;return this.active=!1,this.on.error.fire(e),this.parent?this.parent._reject(e):t&&this.idbtrans&&this.idbtrans.abort(),pt(e)}))}))}(this),this.Version=function(e){return It(_n.prototype,(function(t){this.db=e,this._cfg={version:t,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}}))}(this),this.WhereClause=function(e){return It(Gt.prototype,(function(t,n,r){this.db=e,this._ctx={table:t,index:":id"===n?null:n,or:r};const i=e._deps.indexedDB;if(!i)throw new ee.MissingAPI;this._cmp=this._ascending=i.cmp.bind(i),this._descending=(e,t)=>i.cmp(t,e),this._max=(e,t)=>i.cmp(e,t)>0?e:t,this._min=(e,t)=>i.cmp(e,t)<0?e:t,this._IDBKeyRange=e._deps.IDBKeyRange}))}(this),this.on("versionchange",(e=>{e.newVersion>0?console.warn(`Another connection wants to upgrade database '${this.name}'. Closing db now to resume the upgrade.`):console.warn(`Another connection wants to delete database '${this.name}'. Closing db now to resume the delete request.`),this.close()})),this.on("blocked",(e=>{!e.newVersion||e.newVersion<e.oldVersion?console.warn(`Dexie.delete('${this.name}') was blocked`):console.warn(`Upgrade '${this.name}' blocked by other connection holding version ${e.oldVersion/10}`)})),this._maxKey=on(t.IDBKeyRange),this._createTransaction=(e,t,n,r)=>new this.Transaction(e,t,n,this._options.chromeTransactionDurability,r),this._fireOnBlocked=e=>{this.on("blocked").fire(e),gt.filter((e=>e.name===this.name&&e!==this&&!e._state.vcFired)).map((t=>t.on("versionchange").fire(e)))},this.use(Pn),this.use(Tn),this.use(Kn),this.use(jn),this.vip=Object.create(this,{_vip:{value:!0}}),r.forEach((e=>e(this)))}version(e){if(isNaN(e)||e<.1)throw new ee.Type("Given version is not a positive number");if(e=Math.round(10*e)/10,this.idbdb||this._state.isBeingOpened)throw new ee.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,e);const t=this._versions;var n=t.filter((t=>t._cfg.version===e))[0];return n||(n=new this.Version(e),t.push(n),t.sort(pn),n.stores({}),this._state.autoSchema=!1,n)}_whenReady(e){return this.idbdb&&(this._state.openComplete||Ie.letThrough||this._vip)?e():new Ae(((e,t)=>{if(this._state.openComplete)return t(new ee.DatabaseClosed(this._state.dbOpenError));if(!this._state.isBeingOpened){if(!this._options.autoOpen)return void t(new ee.DatabaseClosed);this.open().catch(re)}this._state.dbReadyPromise.then(e,t)})).then(e)}use({stack:e,create:t,level:n,name:r}){r&&this.unuse({stack:e,name:r});const i=this._middlewares[e]||(this._middlewares[e]=[]);return i.push({stack:e,create:t,level:null==n?10:n,name:r}),i.sort(((e,t)=>e.level-t.level)),this}unuse({stack:e,name:t,create:n}){return e&&this._middlewares[e]&&(this._middlewares[e]=this._middlewares[e].filter((e=>n?e.create!==n:!!t&&e.name!==t))),this}open(){return function(e){const t=e._state,{indexedDB:n}=e._deps;if(t.isBeingOpened||e.idbdb)return t.dbReadyPromise.then((()=>t.dbOpenError?pt(t.dbOpenError):e));F&&(t.openCanceller._stackHolder=U()),t.isBeingOpened=!0,t.dbOpenError=null,t.openComplete=!1;const r=t.openCanceller;function o(){if(t.openCanceller!==r)throw new ee.DatabaseClosed("db.open() was cancelled")}let s=t.dbReadyResolve,a=null,c=!1;return Ae.race([r,("undefined"==typeof navigator?Ae.resolve():xn()).then((()=>new Ae(((r,s)=>{if(o(),!n)throw new ee.MissingAPI;const u=e.name,l=t.autoSchema?n.open(u):n.open(u,Math.round(10*e.verno));if(!l)throw new ee.MissingAPI;l.onerror=Jt(s),l.onblocked=Ve(e._fireOnBlocked),l.onupgradeneeded=Ve((r=>{if(a=l.transaction,t.autoSchema&&!e._options.allowEmptyDB){l.onerror=Zt,a.abort(),l.result.close();const e=n.deleteDatabase(u);e.onsuccess=e.onerror=Ve((()=>{s(new ee.NoSuchDatabase(`Database ${u} doesnt exist`))}))}else{a.onerror=Jt(s);var i=r.oldVersion>Math.pow(2,62)?0:r.oldVersion;c=i<1,e._novip.idbdb=l.result,mn(e,i/10,a,s)}}),s),l.onsuccess=Ve((()=>{a=null;const n=e._novip.idbdb=l.result,o=v(n.objectStoreNames);if(o.length>0)try{const r=n.transaction(1===(s=o).length?s[0]:s,"readonly");t.autoSchema?function({_novip:e},t,n){e.verno=t.version/10;const r=e._dbSchema=bn(0,t,n);e._storeNames=v(t.objectStoreNames,0),dn(e,[e._allTables],i(r),r)}(e,n,r):(wn(e,e._dbSchema,r),function(e,t){const n=yn(bn(0,e.idbdb,t),e._dbSchema);return!(n.add.length||n.change.some((e=>e.add.length||e.change.length)))}(e,r)||console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Some queries may fail.")),hn(e,r)}catch(e){}var s;gt.push(e),n.onversionchange=Ve((n=>{t.vcFired=!0,e.on("versionchange").fire(n)})),n.onclose=Ve((t=>{e.on("close").fire(t)})),c&&function({indexedDB:e,IDBKeyRange:t},n){!kn(e)&&"__dbnames"!==n&&En(e,t).put({name:n}).catch(re)}(e._deps,u),r()}),s)}))))]).then((()=>(o(),t.onReadyBeingFired=[],Ae.resolve(Sn((()=>e.on.ready.fire(e.vip)))).then((function n(){if(t.onReadyBeingFired.length>0){let r=t.onReadyBeingFired.reduce(he,re);return t.onReadyBeingFired=[],Ae.resolve(Sn((()=>r(e.vip)))).then(n)}}))))).finally((()=>{t.onReadyBeingFired=null,t.isBeingOpened=!1})).then((()=>e)).catch((n=>{t.dbOpenError=n;try{a&&a.abort()}catch(e){}return r===t.openCanceller&&e._close(),pt(n)})).finally((()=>{t.openComplete=!0,s()}))}(this)}_close(){const e=this._state,t=gt.indexOf(this);if(t>=0&&gt.splice(t,1),this.idbdb){try{this.idbdb.close()}catch(e){}this._novip.idbdb=null}e.dbReadyPromise=new Ae((t=>{e.dbReadyResolve=t})),e.openCanceller=new Ae(((t,n)=>{e.cancelOpen=n}))}close(){this._close();const e=this._state;this._options.autoOpen=!1,e.dbOpenError=new ee.DatabaseClosed,e.isBeingOpened&&e.cancelOpen(e.dbOpenError)}delete(){const e=arguments.length>0,t=this._state;return new Ae(((n,r)=>{const i=()=>{this.close();var e=this._deps.indexedDB.deleteDatabase(this.name);e.onsuccess=Ve((()=>{!function({indexedDB:e,IDBKeyRange:t},n){!kn(e)&&"__dbnames"!==n&&En(e,t).delete(n).catch(re)}(this._deps,this.name),n()})),e.onerror=Jt(r),e.onblocked=this._fireOnBlocked};if(e)throw new ee.InvalidArgument("Arguments not allowed in db.delete()");t.isBeingOpened?t.dbReadyPromise.then(i):i()}))}backendDB(){return this.idbdb}isOpen(){return null!==this.idbdb}hasBeenClosed(){const e=this._state.dbOpenError;return e&&"DatabaseClosed"===e.name}hasFailed(){return null!==this._state.dbOpenError}dynamicallyOpened(){return this._state.autoSchema}get tables(){return i(this._allTables).map((e=>this._allTables[e]))}transaction(){const e=On.apply(this,arguments);return this._transaction.apply(this,e)}_transaction(e,t,n){let r=Ie.trans;r&&r.db===this&&-1===e.indexOf("!")||(r=null);const i=-1!==e.indexOf("?");let o,s;e=e.replace("!","").replace("?","");try{if(s=t.map((e=>{var t=e instanceof this.Table?e.name:e;if("string"!=typeof t)throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return t})),"r"==e||"readonly"===e)o="readonly";else{if("rw"!=e&&"readwrite"!=e)throw new ee.InvalidArgument("Invalid transaction mode: "+e);o="readwrite"}if(r){if("readonly"===r.mode&&"readwrite"===o){if(!i)throw new ee.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");r=null}r&&s.forEach((e=>{if(r&&-1===r.storeNames.indexOf(e)){if(!i)throw new ee.SubTransaction("Table "+e+" not included in parent transaction.");r=null}})),i&&r&&!r.active&&(r=null)}}catch(e){return r?r._promise(null,((t,n)=>{n(e)})):pt(e)}const a=Rn.bind(null,this,o,s,r,n);return r?r._promise(o,a,"lock"):Ie.trans?ut(Ie.transless,(()=>this._whenReady(a))):this._whenReady(a)}table(e){if(!u(this._allTables,e))throw new ee.InvalidTable(`Table ${e} does not exist`);return this._allTables[e]}}const Wn="undefined"!=typeof Symbol&&"observable"in Symbol?Symbol.observable:"@@observable";class zn{constructor(e){this._subscribe=e}subscribe(e,t,n){return this._subscribe(e&&"function"!=typeof e?e:{next:e,error:t,complete:n})}[Wn](){return this}}function Hn(e,t){return i(t).forEach((n=>{Bn(e[n]||(e[n]=new Nn),t[n])})),e}let Qn;try{Qn={indexedDB:r.indexedDB||r.mozIndexedDB||r.webkitIndexedDB||r.msIndexedDB,IDBKeyRange:r.IDBKeyRange||r.webkitIDBKeyRange}}catch(r){Qn={indexedDB:null,IDBKeyRange:null}}const Vn=Un;function Yn(e){let t=Gn;try{Gn=!0,Xt.storagemutated.fire(e)}finally{Gn=t}}l(Vn,{...ne,delete:e=>new Vn(e,{addons:[]}).delete(),exists:e=>new Vn(e,{addons:[]}).open().then((e=>(e.close(),!0))).catch("NoSuchDatabaseError",(()=>!1)),getDatabaseNames(e){try{return function({indexedDB:e,IDBKeyRange:t}){return kn(e)?Promise.resolve(e.databases()).then((e=>e.map((e=>e.name)).filter((e=>"__dbnames"!==e)))):En(e,t).toCollection().primaryKeys()}(Vn.dependencies).then(e)}catch(e){return pt(new ee.MissingAPI)}},defineClass:()=>function(e){s(this,e)},ignoreTransaction:e=>Ie.trans?ut(Ie.transless,e):e(),vip:Sn,async:function(e){return function(){try{var t=Cn(e.apply(this,arguments));return t&&"function"==typeof t.then?t:Ae.resolve(t)}catch(e){return pt(e)}}},spawn:function(e,t,n){try{var r=Cn(e.apply(n,t||[]));return r&&"function"==typeof r.then?r:Ae.resolve(r)}catch(e){return pt(e)}},currentTransaction:{get:()=>Ie.trans||null},waitFor:function(e,t){const n=Ae.resolve("function"==typeof e?Vn.ignoreTransaction(e):e).timeout(t||6e4);return Ie.trans?Ie.trans.waitFor(n):n},Promise:Ae,debug:{get:()=>F,set:e=>{$(e,"dexie"===e?()=>!0:Et)}},derive:f,extend:s,props:l,override:g,Events:Rt,on:Xt,liveQuery:function(e){return new zn((t=>{const n=B(e);let r=!1,o={},s={};const a={get closed(){return r},unsubscribe:()=>{r=!0,Xt.storagemutated.unsubscribe(h)}};t.start&&t.start(a);let c=!1,u=!1;function l(){return i(s).some((e=>o[e]&&function(e,t){const n=Fn(t);let r=n.next();if(r.done)return!1;let i=r.value;const o=Fn(e);let s=o.next(i.from),a=s.value;for(;!r.done&&!s.done;){if(Lt(a.from,i.to)<=0&&Lt(a.to,i.from)>=0)return!0;Lt(i.from,a.from)<0?i=(r=n.next(a.from)).value:a=(s=o.next(i.from)).value}return!1}(o[e],s[e])))}const h=e=>{Hn(o,e),l()&&d()},d=()=>{if(c||r)return;o={};const i={},f=function(t){n&&nt();const r=()=>tt(e,{subscr:t,trans:null}),i=Ie.trans?ut(Ie.transless,r):r();return n&&i.then(rt,rt),i}(i);u||(Xt("storagemutated",h),u=!0),c=!0,Promise.resolve(f).then((e=>{c=!1,r||(l()?d():(o={},s=i,t.next&&t.next(e)))}),(e=>{["DatabaseClosedError","AbortError"].includes(null==e?void 0:e.name)||(c=!1,t.error&&t.error(e),a.unsubscribe())}))};return d(),a}))},extendObservabilitySet:Hn,getByKeyPath:E,setByKeyPath:k,delByKeyPath:function(e,t){"string"==typeof t?k(e,t,void 0):"length"in t&&[].map.call(t,(function(t){k(e,t,void 0)}))},shallowClone:S,deepClone:P,getObjectDiff:Dn,cmp:Lt,asap:w,minKey:-1/0,addons:[],connections:gt,errnames:Z,dependencies:Qn,semVer:"4.0.0-alpha.4",version:"4.0.0-alpha.4".split(".").map((e=>parseInt(e))).reduce(((e,t,n)=>e+t/Math.pow(10,2*n)))}),Vn.maxKey=on(Vn.dependencies.IDBKeyRange),"undefined"!=typeof dispatchEvent&&"undefined"!=typeof addEventListener&&(Xt("storagemutated",(e=>{if(!Gn){let t;bt?(t=document.createEvent("CustomEvent"),t.initCustomEvent("x-storagemutated-1",!0,!0,e)):t=new CustomEvent("x-storagemutated-1",{detail:e}),Gn=!0,dispatchEvent(t),Gn=!1}})),addEventListener("x-storagemutated-1",(({detail:e})=>{Gn||Yn(e)})));let Gn=!1;if("undefined"!=typeof BroadcastChannel){const e=new BroadcastChannel("x-storagemutated-1");"function"==typeof e.unref&&e.unref(),Xt("storagemutated",(t=>{Gn||e.postMessage(t)})),e.onmessage=e=>{e.data&&Yn(e.data)}}else if("undefined"!=typeof self&&"undefined"!=typeof navigator){Xt("storagemutated",(e=>{try{Gn||("undefined"!=typeof localStorage&&localStorage.setItem("x-storagemutated-1",JSON.stringify({trig:Math.random(),changedParts:e})),"object"==typeof self.clients&&[...self.clients.matchAll({includeUncontrolled:!0})].forEach((t=>t.postMessage({type:"x-storagemutated-1",changedParts:e}))))}catch(e){}})),"undefined"!=typeof addEventListener&&addEventListener("storage",(e=>{if("x-storagemutated-1"===e.key){const t=JSON.parse(e.newValue);t&&Yn(t.changedParts)}}));const e=self.document&&navigator.serviceWorker;e&&e.addEventListener("message",(function({data:e}){e&&"x-storagemutated-1"===e.type&&Yn(e.changedParts)}))}Ae.rejectionMapper=function(e,t){if(!e||e instanceof V||e instanceof TypeError||e instanceof SyntaxError||!e.name||!te[e.name])return e;var n=new te[e.name](t||e.message,e);return"stack"in e&&d(n,"stack",{get:function(){return this.inner.stack}}),n},$(F,Et);var Jn=n(1831),Zn=n(1462),Xn=n(3333),er=n(109),tr=n(9300),nr=n(9334),rr={prepareQuery(e,t){if(!t.sort)throw(0,er.f3)("SNH",{query:t});return{query:t,queryPlan:(0,nr.O7)(e,t)}},checkpointSchema:tr.ui},ir="docs",or="deleted-docs",sr="changes",ar="dexie",cr=rr,ur=new Map,lr=new Map;function hr(e,t,n,r){var i=(0,tr.CT)(r.primaryKey),o="rxdb-dexie-"+e+"--"+r.version+"--"+t,s=(0,Jn.c)(ur,o,(()=>{var e=(async()=>{var e=(0,Zn.qu)(n);e.autoOpen=!1;var t=new Un(o,e),s={[ir]:br(r),[sr]:"++sequence, id",[or]:i+",_meta.lwt,[_meta.lwt+"+i+"]"};return t.version(1).stores(s),await t.open(),{dexieDb:t,dexieTable:t[ir],dexieDeletedTable:t[or]}})();return ur.set(o,s),lr.set(s,0),e}));return s}async function dr(e){var t=await e,n=lr.get(e)-1;0===n?(t.dexieDb.close(),lr.delete(e)):lr.set(e,n)}function fr(e){if(e.indexes){var t=new Set;e.indexes.forEach((n=>{(0,Xn.qo)(n).forEach((r=>{if(!t.has(r)&&(t.add(r),"boolean"===(0,tr._F)(e,r).type))throw(0,er.f3)("DXE1",{schema:e,index:n,field:r})}))}))}}var pr="__";function mr(e){var t=e.split(".");if(t.length>1)return t.map((e=>mr(e))).join(".");if(e.startsWith("|")){var n=e.substring(1);return pr+n}return e}function yr(e){var t=e.split(".");return t.length>1?t.map((e=>yr(e))).join("."):e.startsWith(pr)?"|"+e.substring(pr.length):e}function vr(e){if(!e||"string"==typeof e||"number"==typeof e||"boolean"==typeof e)return e;if(Array.isArray(e))return e.map((e=>vr(e)));if("object"==typeof e){var t={};return Object.entries(e).forEach((([e,n])=>{"object"==typeof n&&(n=vr(n)),t[mr(e)]=n})),t}}function gr(e){if(!e||"string"==typeof e||"number"==typeof e||"boolean"==typeof e)return e;if(Array.isArray(e))return e.map((e=>gr(e)));if("object"==typeof e){var t={};return Object.entries(e).forEach((([n,r])=>{("object"==typeof r||Array.isArray(e))&&(r=gr(r)),t[yr(n)]=r})),t}}function br(e){var t=[],n=(0,tr.CT)(e.primaryKey);return t.push([n]),e.indexes&&e.indexes.forEach((e=>{var n=(0,Xn.qo)(e);t.push(n)})),t.push(["_meta.lwt",n]),(t=t.map((e=>e.map((e=>mr(e)))))).map((e=>1===e.length?e[0]:"["+e.join("+")+"]")).join(", ")}async function wr(e,t){var n=await e,[r,i]=await Promise.all([n.dexieTable.bulkGet(t),n.dexieDeletedTable.bulkGet(t)]),o=i.slice(0);return r.forEach(((e,t)=>{e&&(o[t]=e)})),o}},3333:(e,t,n)=>{"use strict";function r(e){return e[e.length-1]}function i(e){return Array.isArray(e)?e.slice(0):[e]}function o(e,t){e=e.slice(0);for(var n=[];e.length;){var r=e.splice(0,t);n.push(r)}return n}function s(e){return Array.isArray(e)}function a(e){return null!=e}function c(e,t){var n=0,r=-1;for(var i of e){if(!t(i,r+=1))break;n+=1}return n}function u(e,t){for(var n=t.length,r=0;r<n;++r){var i=t[r];e.push(i)}}n.d(t,{AD:()=>s,S7:()=>a,SI:()=>r,gu:()=>u,o_:()=>o,qo:()=>i,r0:()=>c})},6069:(e,t,n)=>{"use strict";n.d(t,{Iy:()=>c,Ly:()=>s,Oy:()=>a,aA:()=>r,dy:()=>i,i1:()=>o});var r=1;function i(){return{lwt:r}}function o(){return""}function s(e){return Object.assign({},e,{_meta:void 0,_deleted:void 0,_rev:void 0})}function a(e,t,n){if(t.length!==n.length)return!1;for(var r=0,i=t.length;r<i;){var o=t[r],s=n[r];if(r++,o._rev!==s._rev||o[e]!==s[e])return!1}return!0}function c(e,t){return t.sort(function(e){return(t,n)=>t._meta.lwt===n._meta.lwt?n[e]<t[e]?1:-1:t._meta.lwt-n._meta.lwt}(e))}},7124:(e,t,n)=>{"use strict";n.d(t,{i:()=>o,k:()=>i});var r=n(5618);function i(e){var t=e.split("-"),n="RxDB";return t.forEach((e=>{n+=(0,r.Ps)(e)})),n+="Plugin",new Error("You are using a function which must be overwritten by a plugin.\n        You should either prevent the usage of this function or add the plugin via:\n            import { "+n+" } from 'rxdb/plugins/"+e+"';\n            addRxPlugin("+n+");\n        ")}function o(e){return{name:e.name,message:e.message,rxdb:e.rxdb,parameters:e.parameters,code:e.code,stack:e.stack?e.stack.replace(/\n/g," \n "):void 0}}},4369:(e,t,n)=>{"use strict";n.d(t,{nt:()=>p});Object.freeze({ignoreUnknown:!1,respectType:!1,respectFunctionNames:!1,respectFunctionProperties:!1,unorderedObjects:!0,unorderedArrays:!1,unorderedSets:!1,excludeKeys:void 0,excludeValues:void 0,replacer:void 0});Object.freeze(["prototype","__proto__","constructor"]);const r="[native code] }";r.length;class i{constructor(e,t){e=this.words=e||[],this.sigBytes=void 0===t?4*e.length:t}toString(e){return(e||o).stringify(this)}concat(e){if(this.clamp(),this.sigBytes%4)for(let t=0;t<e.sigBytes;t++){const n=e.words[t>>>2]>>>24-t%4*8&255;this.words[this.sigBytes+t>>>2]|=n<<24-(this.sigBytes+t)%4*8}else for(let t=0;t<e.sigBytes;t+=4)this.words[this.sigBytes+t>>>2]=e.words[t>>>2];return this.sigBytes+=e.sigBytes,this}clamp(){this.words[this.sigBytes>>>2]&=4294967295<<32-this.sigBytes%4*8,this.words.length=Math.ceil(this.sigBytes/4)}clone(){return new i([...this.words])}}const o={stringify(e){const t=[];for(let n=0;n<e.sigBytes;n++){const r=e.words[n>>>2]>>>24-n%4*8&255;t.push((r>>>4).toString(16),(15&r).toString(16))}return t.join("")}},s={parse(e){const t=e.length,n=[];for(let r=0;r<t;r++)n[r>>>2]|=(255&e.charCodeAt(r))<<24-r%4*8;return new i(n,t)}},a={parse:e=>s.parse(unescape(encodeURIComponent(e)))};class c{constructor(){this._data=new i,this._nDataBytes=0,this._minBufferSize=0,this.blockSize=16}reset(){this._data=new i,this._nDataBytes=0}_append(e){"string"==typeof e&&(e=a.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes}_doProcessBlock(e,t){}_process(e){let t,n=this._data.sigBytes/(4*this.blockSize);n=e?Math.ceil(n):Math.max((0|n)-this._minBufferSize,0);const r=n*this.blockSize,o=Math.min(4*r,this._data.sigBytes);if(r){for(let e=0;e<r;e+=this.blockSize)this._doProcessBlock(this._data.words,e);t=this._data.words.splice(0,r),this._data.sigBytes-=o}return new i(t,o)}}class u extends c{update(e){return this._append(e),this._process(),this}finalize(e){e&&this._append(e)}}const l=[1779033703,-1150833019,1013904242,-1521486534,1359893119,-1694144372,528734635,1541459225],h=[1116352408,1899447441,-1245643825,-373957723,961987163,1508970993,-1841331548,-1424204075,-670586216,310598401,607225278,1426881987,1925078388,-2132889090,-1680079193,-1046744716,-459576895,-272742522,264347078,604807628,770255983,1249150122,1555081692,1996064986,-1740746414,-1473132947,-1341970488,-1084653625,-958395405,-710438585,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,-2117940946,-1838011259,-1564481375,-1474664885,-1035236496,-949202525,-778901479,-694614492,-200395387,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,-2067236844,-1933114872,-1866530822,-1538233109,-1090935817,-965641998],d=[];class f extends u{constructor(){super(...arguments),this._hash=new i([...l])}reset(){super.reset(),this._hash=new i([...l])}_doProcessBlock(e,t){const n=this._hash.words;let r=n[0],i=n[1],o=n[2],s=n[3],a=n[4],c=n[5],u=n[6],l=n[7];for(let n=0;n<64;n++){if(n<16)d[n]=0|e[t+n];else{const e=d[n-15],t=(e<<25|e>>>7)^(e<<14|e>>>18)^e>>>3,r=d[n-2],i=(r<<15|r>>>17)^(r<<13|r>>>19)^r>>>10;d[n]=t+d[n-7]+i+d[n-16]}const f=r&i^r&o^i&o,p=(r<<30|r>>>2)^(r<<19|r>>>13)^(r<<10|r>>>22),m=l+((a<<26|a>>>6)^(a<<21|a>>>11)^(a<<7|a>>>25))+(a&c^~a&u)+h[n]+d[n];l=u,u=c,c=a,a=s+m|0,s=o,o=i,i=r,r=m+(p+f)|0}n[0]=n[0]+r|0,n[1]=n[1]+i|0,n[2]=n[2]+o|0,n[3]=n[3]+s|0,n[4]=n[4]+a|0,n[5]=n[5]+c|0,n[6]=n[6]+u|0,n[7]=n[7]+l|0}finalize(e){super.finalize(e);const t=8*this._nDataBytes,n=8*this._data.sigBytes;return this._data.words[n>>>5]|=128<<24-n%32,this._data.words[14+(n+64>>>9<<4)]=Math.floor(t/4294967296),this._data.words[15+(n+64>>>9<<4)]=t,this._data.sigBytes=4*this._data.words.length,this._process(),this._hash}}var p="undefined"!=typeof crypto&&void 0!==crypto.subtle&&"function"==typeof crypto.subtle.digest?async function(e){var t=(new TextEncoder).encode(e),n=await crypto.subtle.digest("SHA-256",t);return Array.prototype.map.call(new Uint8Array(n),(e=>("00"+e.toString(16)).slice(-2))).join("")}:function(e){return Promise.resolve((t=e,(new f).finalize(t).toString()));var t}},1831:(e,t,n)=>{"use strict";function r(e,t){var n=e.get(t);if(void 0===n)throw new Error("missing value from map "+t);return n}function i(e,t,n,r){var i=e.get(t);return void 0===i?(i=n(),e.set(t,i)):r&&r(i),i}n.d(t,{c:()=>i,e:()=>r})},1858:(e,t,n)=>{"use strict";function r(e,t){if(e===t)return!0;if(e&&t&&"object"==typeof e&&"object"==typeof t){if(e.constructor!==t.constructor)return!1;var n,i;if(Array.isArray(e)){if((n=e.length)!==t.length)return!1;for(i=n;0!=i--;)if(!r(e[i],t[i]))return!1;return!0}if(e.constructor===RegExp)return e.source===t.source&&e.flags===t.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===t.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===t.toString();var o=Object.keys(e);if((n=o.length)!==Object.keys(t).length)return!1;for(i=n;0!=i--;)if(!Object.prototype.hasOwnProperty.call(t,o[i]))return!1;for(i=n;0!=i--;){var s=o[i];if(!r(e[s],t[s]))return!1}return!0}return e!=e&&t!=t}n.d(t,{v:()=>r})},7475:(e,t,n)=>{"use strict";n.d(t,{$s:()=>c});var r=e=>{var t=typeof e;return null!==e&&("object"===t||"function"===t)},i=new Set(["__proto__","prototype","constructor"]),o=new Set("0123456789");function s(e){var t=[],n="",r="start",s=!1;for(var a of e)switch(a){case"\\":if("index"===r)throw new Error("Invalid character in an index");if("indexEnd"===r)throw new Error("Invalid character after an index");s&&(n+=a),r="property",s=!s;break;case".":if("index"===r)throw new Error("Invalid character in an index");if("indexEnd"===r){r="property";break}if(s){s=!1,n+=a;break}if(i.has(n))return[];t.push(n),n="",r="property";break;case"[":if("index"===r)throw new Error("Invalid character in an index");if("indexEnd"===r){r="index";break}if(s){s=!1,n+=a;break}if("property"===r){if(i.has(n))return[];t.push(n),n=""}r="index";break;case"]":if("index"===r){t.push(Number.parseInt(n,10)),n="",r="indexEnd";break}if("indexEnd"===r)throw new Error("Invalid character after an index");default:if("index"===r&&!o.has(a))throw new Error("Invalid character in an index");if("indexEnd"===r)throw new Error("Invalid character after an index");"start"===r&&(r="property"),s&&(s=!1,n+="\\"),n+=a}switch(s&&(n+="\\"),r){case"property":if(i.has(n))return[];t.push(n);break;case"index":throw new Error("Index was not closed");case"start":t.push("")}return t}function a(e,t){if("number"!=typeof t&&Array.isArray(e)){var n=Number.parseInt(t,10);return Number.isInteger(n)&&e[n]===e[t]}return!1}function c(e,t,n){if(Array.isArray(t)&&(t=t.join(".")),!t.includes(".")&&!t.includes("["))return e[t];if(!r(e)||"string"!=typeof t)return void 0===n?e:n;var i=s(t);if(0===i.length)return n;for(var o=0;o<i.length;o++){var c=i[o];if(null==(e=a(e,c)?o===i.length-1?void 0:null:e[c])){if(o!==i.length-1)return n;break}}return void 0===e?n:e}},1462:(e,t,n)=>{"use strict";function r(e){return Object.freeze(e),Object.getOwnPropertyNames(e).forEach((function(t){!e.hasOwnProperty(t)||null===e[t]||"object"!=typeof e[t]&&"function"!=typeof e[t]||Object.isFrozen(e[t])||r(e[t])})),e}function i(e){var t=e.split("."),n=t.length;return 1===n?t=>t[e]:e=>{for(var r=e,i=0;i<n;++i){if(void 0===(r=r[t[i]]))return r}return r}}function o(e){var t={};for(var n in e)if(e.hasOwnProperty(n))if("object"==typeof e[n]){var r=o(e[n]);for(var i in r)r.hasOwnProperty(i)&&(t[n+"."+i]=r[i])}else t[n]=e[n];return t}function s(e){return Object.assign({},e)}function a(e){return Object.keys(e)[0]}function c(e,t=!1){if(!e)return e;if(!t&&Array.isArray(e))return e.sort(((e,t)=>"string"==typeof e&&"string"==typeof t?e.localeCompare(t):"object"==typeof e?1:-1)).map((e=>c(e,t)));if("object"==typeof e&&!Array.isArray(e)){var n={};return Object.keys(e).sort(((e,t)=>e.localeCompare(t))).forEach((r=>{n[r]=c(e[r],t)})),n}return e}n.d(t,{BT:()=>a,CV:()=>c,FX:()=>o,IK:()=>l,_A:()=>r,d9:()=>u,qu:()=>s,wN:()=>i});var u=function e(t){if(!t)return t;if(null===t||"object"!=typeof t)return t;if(Array.isArray(t)){for(var n=new Array(t.length),r=n.length;r--;)n[r]=e(t[r]);return n}var i={};for(var o in t)i[o]=e(t[o]);return i};function l(e,t,n){return Object.defineProperty(e,t,{get:function(){return n}}),n}},5688:(e,t,n)=>{"use strict";function r(e){if(!e)throw new Error("ensureNotFalsy() is falsy");return e}n.d(t,{Is:()=>r,kv:()=>i});var i={bufferSize:1,refCount:!0}},5052:(e,t,n)=>{"use strict";function r(){return new Promise((e=>setTimeout(e,0)))}function i(e=0){return new Promise((t=>setTimeout(t,e)))}n.d(t,{$Y:()=>c,C2:()=>h,Y3:()=>r,YB:()=>i,Ze:()=>f,kZ:()=>s,m5:()=>a,uT:()=>d,wd:()=>o,y$:()=>u});var o=Promise.resolve(!0),s=Promise.resolve(!1),a=Promise.resolve(null),c=Promise.resolve();function u(e=1e4){return"function"==typeof requestIdleCallback?new Promise((t=>{requestIdleCallback((()=>t()),{timeout:e})})):i(0)}var l=c;function h(e=void 0){return l=l.then((()=>u(e)))}function d(e){"function"==typeof requestIdleCallback&&requestIdleCallback((()=>{e()}))}function f(e,t){return e.reduce(((e,t)=>e.then(t)),Promise.resolve(t))}},327:(e,t,n)=>{"use strict";function r(e){var t=e.split("-");if(2!==t.length)throw new Error("malformatted revision: "+e);return{height:parseInt(t[0],10),hash:t[1]}}function i(e){return parseInt(e.split("-")[0],10)}function o(e,t){var n=t?t._rev:null;return(n?r(n).height:0)+1+"-"+e}n.d(t,{Ac:()=>i,Tz:()=>r,Zo:()=>o})},7351:(e,t,n)=>{"use strict";n.d(t,{j:()=>r});var r="15.0.0-beta.42"},5618:(e,t,n)=>{"use strict";n.d(t,{Ny:()=>s,Ps:()=>o,Q8:()=>a,sc:()=>i});var r="abcdefghijklmnopqrstuvwxyz";function i(e=10){for(var t="",n=0;n<e;n++)t+=r.charAt(Math.floor(Math.random()*r.length));return t}function o(e){return(e+="").charAt(0).toUpperCase()+e.substr(1)}function s(e){for(;"."===e.charAt(0);)e=e.substr(1);for(;"."===e.slice(-1);)e=e.slice(0,-1);return e}function a(e){return!(!e.includes("/")&&!e.includes("\\"))}},6493:(e,t,n)=>{"use strict";n.d(t,{z:()=>i});var r=0;function i(){var e=Date.now();(e+=.01)<=r&&(e=r+.01);var t=parseFloat(e.toFixed(2));return r=t,t}},361:(e,t,n)=>{"use strict";n.d(t,{KQ:()=>a,XY:()=>d,vT:()=>p});var r=n(1831),i=n(6493),o=n(5052),s=function(){function e(){this._map=new Map}return e.prototype.getByQuery=function(e){var t=e.toString();return(0,r.c)(this._map,t,(()=>e))},e}();function a(){return new s}function c(e,t){t.uncached=!0;var n=t.toString();e._map.delete(n)}function u(e){return e.refCount$.observers.length}var l,h,d=(l=100,h=3e4,(e,t)=>{if(!(t._map.size<l)){var n=(0,i.z)()-h,r=[],o=Array.from(t._map.values());for(var s of o)u(s)>0||(0===s._lastEnsureEqual&&s._creationTime<n?c(t,s):r.push(s));var a=r.length-l;a<=0||r.sort(((e,t)=>e._lastEnsureEqual-t._lastEnsureEqual)).slice(0,a).forEach((e=>c(t,e)))}}),f=new WeakSet;function p(e){f.has(e)||(f.add(e),(0,o.Y3)().then((()=>(0,o.C2)(200))).then((()=>{e.destroyed||e.cacheReplacementPolicy(e,e._queryCache),f.delete(e)})))}},9334:(e,t,n)=>{"use strict";n.d(t,{O7:()=>a,Os:()=>c,eG:()=>s});var r=n(3333),i=n(9300),o=String.fromCharCode(65535),s=Number.MIN_VALUE;function a(e,t){var n=(0,i.CT)(e.primaryKey),a=t.selector,u=e.indexes?e.indexes.slice(0):[];t.index?u=[t.index]:u.push([n]);var l,d=t.sort.map((e=>Object.keys(e)[0])).join(","),f=!!t.sort.find((e=>"desc"===Object.values(e)[0])),p=-1;return u.forEach((e=>{var n=!0,i=!0,u=e.map((e=>{var t=a[e],r=t?Object.keys(t):[],u={};t&&r.length?r.forEach((e=>{if(c.has(e)){var n=function(e,t){switch(e){case"$eq":return{startKey:t,endKey:t};case"$lte":return{endKey:t};case"$gte":return{startKey:t};case"$lt":return{endKey:t,inclusiveEnd:!1};case"$gt":return{startKey:t,inclusiveStart:!1};default:throw new Error("SNH")}}(e,t[e]);u=Object.assign(u,n)}})):u={startKey:i?s:o,endKey:n?o:s,inclusiveStart:!0,inclusiveEnd:!0};return void 0===u.startKey&&(u.startKey=s),void 0===u.endKey&&(u.endKey=o),void 0===u.inclusiveStart&&(u.inclusiveStart=!0),void 0===u.inclusiveEnd&&(u.inclusiveEnd=!0),i&&!u.inclusiveStart&&(i=!1),n&&!u.inclusiveEnd&&(n=!1),u})),m={index:e,startKeys:u.map((e=>e.startKey)),endKeys:u.map((e=>e.endKey)),inclusiveEnd:n,inclusiveStart:i,sortFieldsSameAsIndexFields:!f&&d===e.join(","),selectorSatisfiedByIndex:h(e,t.selector)},y=function(e,t,n){var i=0,a=e=>{e>0&&(i+=e)},c=10,u=(0,r.r0)(n.startKeys,(e=>e!==s&&e!==o));a(u*c);var l=(0,r.r0)(n.startKeys,(e=>e!==o&&e!==s));a(l*c);var h=(0,r.r0)(n.startKeys,((e,t)=>e===n.endKeys[t]));a(h*c*1.5);var d=n.sortFieldsSameAsIndexFields?5:0;return a(d),i}(0,0,m);(y>0&&y>p||t.index)&&(p=y,l=m)})),l||(l={index:[n],startKeys:[s],endKeys:[o],inclusiveEnd:!0,inclusiveStart:!0,sortFieldsSameAsIndexFields:!f&&d===n,selectorSatisfiedByIndex:h([n],t.selector)}),l}var c=new Set(["$eq","$gt","$gte","$lt","$lte"]),u=new Set(["$eq","$gt","$gte"]),l=new Set(["$eq","$lt","$lte"]);function h(e,t){var n,r=Object.entries(t).find((([t,n])=>!e.includes(t)||Object.entries(n).find((([e,t])=>!c.has(e)))));if(r)return!1;var i,o=e.find((e=>{var r=t[e];if(!r)return!1;var i=Object.keys(r).find((e=>u.has(e)));return!(!n||!i)||("$eq"!==i&&(n=i),!1)}));if(o)return!1;var s=e.find((e=>{var n=t[e];if(!n)return!1;var r=Object.keys(n).find((e=>l.has(e)));return!(!i||!r)||("$eq"!==r&&(i=r),!1)}));if(s)return!1;var a=new Set(Object.keys(t));for(var h of e){if(0===a.size)break;if(!a.has(h))return!1;a.delete(h)}return!0}},7429:(e,t,n)=>{"use strict";n.d(t,{N:()=>l,l:()=>u});var r=n(1858),i=n(1462),o=n(6069),s=n(6493),a=n(327),c=n(8497),u=function(e,t){var n=(0,c.vI)(e.newDocumentState),i=(0,c.vI)(e.realMasterState);return(0,r.v)(n,i)?Promise.resolve({isEqual:!0}):Promise.resolve({isEqual:!1,documentData:e.realMasterState})};async function l(e,t,n){var r=e.input.conflictHandler,c=await r(t,"replication-resolve-conflict");if(!c.isEqual){var u=Object.assign({},c.documentData,{_meta:(0,i.qu)(n._meta),_rev:(0,o.i1)(),_attachments:(0,i.qu)(n._attachments)});return u._meta.lwt=(0,s.z)(),u._rev=(0,a.Zo)(await e.checkpointKey,n),{resolvedDoc:u,output:c}}}},3461:(e,t,n)=>{"use strict";n.d(t,{IA:()=>i,v9:()=>o});var r=n(442);function i(e){return e.documentData?e.documentData:e.previousDocumentData}function o(e){switch(e.operation){case"INSERT":return{operation:e.operation,id:e.documentId,doc:e.documentData,previous:null};case"UPDATE":return{operation:e.operation,id:e.documentId,doc:r.j.deepFreezeWhenDevMode(e.documentData),previous:e.previousDocumentData?e.previousDocumentData:"UNKNOWN"};case"DELETE":return{operation:e.operation,id:e.documentId,doc:null,previous:e.previousDocumentData}}}},7994:(e,t,n)=>{"use strict";n.d(t,{j9:()=>d,kH:()=>f,sJ:()=>p});var r=n(1462),i=n(6069),o=n(6493),s=n(327),a=n(9300),c=n(8655),u=n(1976),l=n(8497),h=n(442);function d(e,t){return t=(0,r.qu)(t),t=(0,a.QC)(e,t),(t=(0,a.Oq)(e.primaryPath,e.jsonSchema,t))._meta=(0,i.dy)(),t.hasOwnProperty("_deleted")||(t._deleted=!1),t.hasOwnProperty("_attachments")||(t._attachments={}),t.hasOwnProperty("_rev")||(t._rev=(0,i.i1)()),t}async function f(e,t){return t.multiInstance=e.multiInstance,await e.storage.createStorageInstance(t)}async function p(e,t,n,r,i,a,d){var f=(await(0,u.uz)(e.statics,t)).filter((e=>e.data.name===i)),p=[];f.forEach((e=>{p.push({collectionName:e.data.name,schema:e.data.schema,isCollection:!0}),e.data.connectedStorages.forEach((e=>p.push({collectionName:e.collectionName,isCollection:!1,schema:e.schema})))}));var m=new Set;if(p=p.filter((e=>{var t=e.collectionName+"||"+e.schema.version;return!m.has(t)&&(m.add(t),!0)})),await Promise.all(p.map((async t=>{var o=await e.createStorageInstance({collectionName:t.collectionName,databaseInstanceToken:n,databaseName:r,multiInstance:!1,options:{},schema:t.schema,password:a,devMode:h.j.isDevMode()});await o.remove(),t.isCollection&&await(0,c.BU)("postRemoveRxCollection",{storage:e,databaseName:r,collectionName:i})}))),d){var y=f.map((e=>{var t=(0,l._$)(e);return t._deleted=!0,t._meta.lwt=(0,o.z)(),t._rev=(0,s.Zo)(n,e),{previous:e,document:t}}));await t.bulkWrite(y,"rx-database-remove-collection-all")}}},4727:(e,t,n)=>{"use strict";n.d(t,{Ko:()=>D,$O:()=>T});var r=n(1656),i=n(4975),o=n(7877),s=n(9127),a=n(5052),c=n(7124),u=n(5688),l=n(1462),h=n(1831),d=n(5618),f=n(7994),p=n(5453),m=n(109),y=n(5872),v=n(361),g=function(){function e(e){this.subs=[],this.limit=100,this.counter=0,this.eventCounterMap=new WeakMap,this.buffer=[],this.collection=e,this.subs.push(this.collection.$.pipe((0,i.h)((e=>!e.isLocal))).subscribe((e=>this._handleChangeEvent(e))))}var t=e.prototype;return t._handleChangeEvent=function(e){for(this.counter++,this.buffer.push(e),this.eventCounterMap.set(e,this.counter);this.buffer.length>this.limit;)this.buffer.shift()},t.getArrayIndexByPointer=function(e){var t=this.buffer[0],n=this.eventCounterMap.get(t);return e<n?null:e-n},t.getFrom=function(e){var t=[],n=this.getArrayIndexByPointer(e);if(null===n)return null;for(;;){var r=this.buffer[n];if(n++,!r)return t;t.push(r)}},t.runFrom=function(e,t){var n=this.getFrom(e);if(null===n)throw new Error("out of bounds");n.forEach((e=>t(e)))},t.reduceByLastOfDoc=function(e){return e.slice(0)},t.destroy=function(){this.subs.forEach((e=>e.unsubscribe()))},e}();var b=n(8655),w=n(4176),_=n(442),E=new WeakMap;function k(e){var t=e.schema.getDocumentPrototype(),n=function(e){var t={};return Object.entries(e.methods).forEach((([e,n])=>{t[e]=n})),t}(e),r=w.kJ,i={};return[t,n,r].forEach((e=>{Object.getOwnPropertyNames(e).forEach((t=>{var n=Object.getOwnPropertyDescriptor(e,t),r=!0;(t.startsWith("_")||t.endsWith("_")||t.startsWith("$")||t.endsWith("$"))&&(r=!1),"function"==typeof n.value?Object.defineProperty(i,t,{get(){return n.value.bind(this)},enumerable:r,configurable:!1}):(n.enumerable=r,n.configurable=!1,n.writable&&(n.writable=!1),Object.defineProperty(i,t,n))}))})),i}function S(e,t){var n=(0,w.Zt)(function(e){return(0,h.c)(E,e,(()=>(0,w.A9)(k(e))))}(e),e,_.j.deepFreezeWhenDevMode(t));return e._runHooksSync("post","create",t,n),(0,b.Cb)("postCreateRxDocument",n),n}var x=n(8497),C=n(7429),O=n(7458),R=["pre","post"],I=["insert","save","remove","create"],P=!1,D=function(){function e(e,t,n,r,i={},o={},s={},a={},c={},u=v.XY,l={},h=C.l){this.storageInstance={},this.timeouts=new Set,this.incrementalWriteQueue={},this._incrementalUpsertQueues=new Map,this.synced=!1,this.hooks={},this._subs=[],this._docCache={},this._queryCache=(0,v.KQ)(),this.$={},this.checkpoint$={},this._changeEventBuffer={},this.onDestroy=[],this.destroyed=!1,this.database=e,this.name=t,this.schema=n,this.internalStorageInstance=r,this.instanceCreationOptions=i,this.migrationStrategies=o,this.methods=s,this.attachments=a,this.options=c,this.cacheReplacementPolicy=u,this.statics=l,this.conflictHandler=h,function(e){if(P)return;P=!0;var t=Object.getPrototypeOf(e);I.forEach((e=>{R.map((n=>{var r=n+(0,d.Ps)(e);t[r]=function(t,r){return this.addHook(n,e,t,r)}}))}))}(this.asRxCollection)}var t=e.prototype;return t.prepare=async function(){this.storageInstance=(0,x.GT)(this.database,this.internalStorageInstance,this.schema.jsonSchema),this.incrementalWriteQueue=new O._l(this.storageInstance,this.schema.primaryPath,((e,t)=>(0,w.Mk)(this,e,t)),(e=>this._runHooks("post","save",e)));var e,t=this.database.eventBulks$.pipe((0,i.h)((e=>e.collectionName===this.name)));this.$=t.pipe((0,o.z)((e=>e.events))),this.checkpoint$=t.pipe((0,s.U)((e=>e.checkpoint))),this._changeEventBuffer=(e=this.asRxCollection,new g(e)),this._docCache=new y.K(this.schema.primaryPath,this.$.pipe((0,i.h)((e=>!e.isLocal))),(e=>S(this.asRxCollection,e)));var n=await this.database.storageToken,r=this.storageInstance.changeStream().subscribe((e=>{var t={id:e.id,internal:!1,collectionName:this.name,storageToken:n,events:e.events.map((e=>(0,x.cN)(!1,e,this))),databaseToken:this.database.token,checkpoint:e.checkpoint,context:e.context,endTime:e.endTime,startTime:e.startTime};this.database.$emit(t)}));return this._subs.push(r),this._subs.push(this.storageInstance.conflictResultionTasks().subscribe((e=>{this.conflictHandler(e.input,e.context).then((t=>{this.storageInstance.resolveConflictResultionTask({id:e.id,output:t})}))}))),a.$Y},t.cleanup=function(e){throw(0,c.k)("cleanup")},t.migrationNeeded=function(){throw(0,c.k)("migration")},t.getMigrationState=function(){throw(0,c.k)("migration")},t.startMigration=function(e=10){return this.getMigrationState().startMigration(e)},t.migratePromise=function(e=10){return this.getMigrationState().migratePromise(e)},t.insert=async function(e){var t=await this.bulkInsert([e]),n=t.error[0];return(0,x.T_)(this,e[this.schema.primaryPath],e,n),(0,u.Is)(t.success[0])},t.bulkInsert=async function(e){if(0===e.length)return{success:[],error:[]};var t=this.schema.primaryPath,n=e.map((e=>(0,f.j9)(this.schema,e))),r=this.hasHooks("pre","insert")?await Promise.all(n.map((e=>this._runHooks("pre","insert",e).then((()=>e))))):n,i=r.map((e=>({document:e}))),o=await this.storageInstance.bulkWrite(i,"rx-collection-bulk-insert"),s=(0,y.B)(this._docCache,o.success);if(this.hasHooks("post","insert")){var a=new Map;r.forEach((e=>{a.set(e[t],e)})),await Promise.all(s.map((e=>this._runHooks("post","insert",a.get(e.primary),e))))}return{success:s,error:o.error}},t.bulkRemove=async function(e){var t=this.schema.primaryPath;if(0===e.length)return{success:[],error:[]};var n=await this.findByIds(e).exec(),r=[],i=new Map;Array.from(n.values()).forEach((e=>{var t=e.toMutableJSON(!0);r.push(t),i.set(e.primary,t)})),await Promise.all(r.map((e=>{var t=e[this.schema.primaryPath];return this._runHooks("pre","remove",e,n.get(t))})));var o=r.map((e=>{var t=(0,l.qu)(e);return t._deleted=!0,{previous:e,document:t}})),s=await this.storageInstance.bulkWrite(o,"rx-collection-bulk-remove"),a=s.success.map((e=>e[t]));return await Promise.all(a.map((e=>this._runHooks("post","remove",i.get(e),n.get(e))))),{success:a.map((e=>(0,h.e)(n,e))),error:s.error}},t.bulkUpsert=async function(e){var t=[],n=new Map;e.forEach((e=>{var r=(0,f.j9)(this.schema,e),i=r[this.schema.primaryPath];if(!i)throw(0,m.f3)("COL3",{primaryPath:this.schema.primaryPath,data:r,schema:this.schema.jsonSchema});n.set(i,r),t.push(r)}));var r=await this.bulkInsert(t),i=r.success.slice(0),o=[];return await Promise.all(r.error.map((async e=>{if(409!==e.status)o.push(e);else{var t=e.documentId,r=(0,h.e)(n,t),s=(0,u.Is)(e.documentInDb),a=this._docCache.getCachedRxDocument(s),c=await a.incrementalModify((()=>r));i.push(c)}}))),{error:o,success:i}},t.upsert=async function(e){var t=await this.bulkUpsert([e]);return(0,x.T_)(this.asRxCollection,e[this.schema.primaryPath],e,t.error[0]),t.success[0]},t.incrementalUpsert=function(e){var t=(0,f.j9)(this.schema,e),n=t[this.schema.primaryPath];if(!n)throw(0,m.f3)("COL4",{data:e});var r=this._incrementalUpsertQueues.get(n);return r||(r=a.$Y),r=r.then((()=>function(e,t,n){var r=e._docCache.getLatestDocumentDataIfExists(t);if(r)return Promise.resolve({doc:e._docCache.getCachedRxDocument(r),inserted:!1});return e.findOne(t).exec().then((t=>t?{doc:t,inserted:!1}:e.insert(n).then((e=>({doc:e,inserted:!0})))))}(this,n,t))).then((e=>e.inserted?e.doc:function(e,t){return e.incrementalModify((e=>t))}(e.doc,t))),this._incrementalUpsertQueues.set(n,r),r},t.find=function(e){if("string"==typeof e)throw(0,m.f3)("COL5",{queryObj:e});return e||(e=(0,p.sU)()),(0,p.uy)("find",e,this)},t.findOne=function(e){if("number"==typeof e||Array.isArray(e))throw(0,m.zU)("COL6",{queryObj:e});var t;if("string"==typeof e)t=(0,p.uy)("findOne",{selector:{[this.schema.primaryPath]:e},limit:1},this);else{if(e||(e=(0,p.sU)()),e.limit)throw(0,m.f3)("QU6");(e=(0,l.qu)(e)).limit=1,t=(0,p.uy)("findOne",e,this)}return t},t.count=function(e){return e||(e=(0,p.sU)()),(0,p.uy)("count",e,this)},t.findByIds=function(e){var t={selector:{[this.schema.primaryPath]:{$in:e.slice(0)}}};return(0,p.uy)("findByIds",t,this)},t.exportJSON=function(){throw(0,c.k)("json-dump")},t.importJSON=function(e){throw(0,c.k)("json-dump")},t.insertCRDT=function(e){throw(0,c.k)("crdt")},t.addHook=function(e,t,n,r=!1){if("function"!=typeof n)throw(0,m.zU)("COL7",{key:t,when:e});if(!R.includes(e))throw(0,m.zU)("COL8",{key:t,when:e});if(!I.includes(t))throw(0,m.f3)("COL9",{key:t});if("post"===e&&"create"===t&&!0===r)throw(0,m.f3)("COL10",{when:e,key:t,parallel:r});var i=n.bind(this),o=r?"parallel":"series";this.hooks[t]=this.hooks[t]||{},this.hooks[t][e]=this.hooks[t][e]||{series:[],parallel:[]},this.hooks[t][e][o].push(i)},t.getHooks=function(e,t){return this.hooks[t]&&this.hooks[t][e]?this.hooks[t][e]:{series:[],parallel:[]}},t.hasHooks=function(e,t){var n=this.getHooks(e,t);return!!n&&(n.series.length>0||n.parallel.length>0)},t._runHooks=function(e,t,n,r){var i=this.getHooks(e,t);if(!i)return a.$Y;var o=i.series.map((e=>()=>e(n,r)));return(0,a.Ze)(o).then((()=>Promise.all(i.parallel.map((e=>e(n,r))))))},t._runHooksSync=function(e,t,n,r){var i=this.getHooks(e,t);i&&i.series.forEach((e=>e(n,r)))},t.promiseWait=function(e){return new Promise((t=>{var n=setTimeout((()=>{this.timeouts.delete(n),t()}),e);this.timeouts.add(n)}))},t.destroy=function(){return this.destroyed?a.kZ:(this.destroyed=!0,Array.from(this.timeouts).forEach((e=>clearTimeout(e))),this._changeEventBuffer&&this._changeEventBuffer.destroy(),this.database.requestIdlePromise().then((()=>Promise.all(this.onDestroy.map((e=>e()))))).then((()=>this.storageInstance.close())).then((()=>(this._subs.forEach((e=>e.unsubscribe())),delete this.database.collections[this.name],(0,b.BU)("postDestroyRxCollection",this).then((()=>!0))))))},t.remove=async function(){await this.destroy(),await(0,f.sJ)(this.database.storage,this.database.internalStore,this.database.token,this.database.name,this.name,this.database.password,this.database.hashFunction)},(0,r.Z)(e,[{key:"insert$",get:function(){return this.$.pipe((0,i.h)((e=>"INSERT"===e.operation)))}},{key:"update$",get:function(){return this.$.pipe((0,i.h)((e=>"UPDATE"===e.operation)))}},{key:"remove$",get:function(){return this.$.pipe((0,i.h)((e=>"DELETE"===e.operation)))}},{key:"asRxCollection",get:function(){return this}}]),e}();function T({database:e,name:t,schema:n,instanceCreationOptions:r={},migrationStrategies:i={},autoMigrate:o=!0,statics:s={},methods:c={},attachments:u={},options:l={},localDocuments:h=!1,cacheReplacementPolicy:d=v.XY,conflictHandler:p=C.l}){var m={databaseInstanceToken:e.token,databaseName:e.name,collectionName:t,schema:n.jsonSchema,options:r,multiInstance:e.multiInstance,password:e.password,devMode:_.j.isDevMode()};return(0,b.Cb)("preCreateRxStorageInstance",m),(0,f.kH)(e,m).then((f=>{var m=new D(e,t,n,f,r,i,c,u,l,d,s,p);return m.prepare().then((()=>{Object.entries(s).forEach((([e,t])=>{Object.defineProperty(m,e,{get:()=>t.bind(m)})}));var e=a.$Y;return o&&0!==m.schema.version&&(e=m.migratePromise()),e})).then((()=>((0,b.Cb)("createRxCollection",{collection:m,creator:{name:t,schema:n,storageInstance:f,instanceCreationOptions:r,migrationStrategies:i,methods:c,attachments:u,options:l,cacheReplacementPolicy:d,localDocuments:h,statics:s}}),m))).catch((e=>f.close().then((()=>Promise.reject(e)))))}))}},1976:(e,t,n)=>{"use strict";n.d(t,{Ln:()=>d,PI:()=>v,Sy:()=>f,YA:()=>b,iw:()=>g,q6:()=>l,uz:()=>p});var r=n(109),i=n(9300),o=n(8497),s=n(5618),a=n(6069),c=n(5688),u=n(1462),l="collection",h="storage-token",d=(0,i.El)({version:0,title:"RxInternalDocument",primaryKey:{key:"id",fields:["context","key"],separator:"|"},type:"object",properties:{id:{type:"string",maxLength:200},key:{type:"string"},context:{type:"string",enum:[l,h,"rx-migration-status","OTHER"]},data:{type:"object",additionalProperties:!0}},indexes:[],required:["key","context","data"],additionalProperties:!1,sharding:{shards:1,mode:"collection"}});function f(e,t){return(0,i.r$)(d,{key:e,context:t})}async function p(e,t){var n=e.prepareQuery(t.schema,{selector:{context:l},sort:[{id:"asc"}],skip:0});return(await t.query(n)).documents}var m="storageToken",y=f(m,h);async function v(e){var t=(0,s.sc)(10),n=e.password?await e.hashFunction(JSON.stringify(e.password)):void 0,i={id:y,context:h,key:m,data:{rxdbVersion:e.rxdbVersion,token:t,instanceToken:e.token,passwordHash:n},_deleted:!1,_meta:(0,a.dy)(),_rev:(0,a.i1)(),_attachments:{}},o=await e.internalStore.bulkWrite([{document:i}],"internal-add-storage-token");if(o.success[0])return o.success[0];var u=(0,c.Is)(o.error[0]);if(u.isError&&(0,r.pi)(u)){var l=u;if(!function(e,t){if(!e)return!1;if(t.includes("beta")&&t!==e)return!1;var n=e.split(".")[0],r=t.split(".")[0];if(n!==r)return!1;return!0}(l.documentInDb.data.rxdbVersion,e.rxdbVersion))throw(0,r.f3)("DM5",{args:{databaseStateVersion:l.documentInDb.data.rxdbVersion,codeVersion:e.rxdbVersion}});if(n&&n!==l.documentInDb.data.passwordHash)throw(0,r.f3)("DB1",{passwordHash:n,existingPasswordHash:l.documentInDb.data.passwordHash});var d=l.documentInDb;return(0,c.Is)(d)}throw u}async function g(e,t,n){if(e.schema.version!==n.version)throw(0,r.f3)("SNH",{schema:n,version:e.schema.version,name:e.name,collection:e,args:{storageCollectionName:t}});for(var i=f(b(e.name,e.schema.jsonSchema),l);;){var s=await(0,o.ov)(e.database.internalStore,i),a=(0,u.d9)((0,c.Is)(s));if(a.data.connectedStorages.find((e=>e.collectionName===t&&e.schema.version===n.version)))return;a.data.connectedStorages.push({collectionName:t,schema:n});try{await(0,o.OW)(e.database.internalStore,{previous:(0,c.Is)(s),document:a},"add-connected-storage-to-collection")}catch(e){if(!(0,r.pi)(e))throw e}}}function b(e,t){return e+"-"+t.version}},9161:(e,t,n)=>{"use strict";n.d(t,{s2:()=>O,tl:()=>I});var r=n(1656),i=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this._parallels=e||1,this._qC=0,this._iC=new Set,this._lHN=0,this._hPM=new Map,this._pHM=new Map};function o(e,t){if(t){if(t._timeoutObj&&clearTimeout(t._timeoutObj),e._pHM.has(t)){var n=e._pHM.get(t);e._hPM.delete(n),e._pHM.delete(t)}e._iC.delete(t)}}function s(e){e._tryIR||0===e._iC.size||(e._tryIR=!0,setTimeout((function(){e.isIdle()?setTimeout((function(){e.isIdle()?(!function(e){0!==e._iC.size&&(e._iC.values().next().value._manRes(),setTimeout((function(){return s(e)}),0))}(e),e._tryIR=!1):e._tryIR=!1}),0):e._tryIR=!1}),0))}i.prototype={isIdle:function(){return this._qC<this._parallels},lock:function(){this._qC++},unlock:function(){this._qC--,s(this)},wrapCall:function(e){var t,n=this;this.lock();try{t=e()}catch(e){throw this.unlock(),e}return t.then&&"function"==typeof t.then?t.then((function(e){return n.unlock(),e})).catch((function(e){throw n.unlock(),e})):(this.unlock(),t)},requestIdlePromise:function(e){var t,n=this;e=e||{};var r=new Promise((function(e){return t=e}));if(r._manRes=function(){o(n,r),t()},e.timeout){var i=setTimeout((function(){r._manRes()}),e.timeout);r._timeoutObj=i}return this._iC.add(r),s(this),r},cancelIdlePromise:function(e){o(this,e)},requestIdleCallback:function(e,t){var n=this._lHN++,r=this.requestIdlePromise(t);return this._hPM.set(n,r),this._pHM.set(r,n),r.then((function(){return e()})),n},cancelIdleCallback:function(e){var t=this._hPM.get(e);this.cancelIdlePromise(t)},clear:function(){var e=this;this._iC.forEach((function(t){return o(e,t)})),this._qC=0,this._iC.clear(),this._hPM=new Map,this._pHM=new Map}};var a=n(7351),c=n(5052),u=n(6069),l=n(1462),h=n(5688),d=n(7124),f=n(4369),p=n(5618),m=n(109),y=n(8316),v=n(8655),g=n(6716),b=n(7877),w=n(4727),_=n(8497),E=n(395),k=n(1976),S=n(7994),x=n(442),C=new Set,O=function(){function e(e,t,n,r,o,s,u=!1,l={},h,d,f,p){this.idleQueue=new i,this.rxdbVersion=a.j,this.storageInstances=new Set,this._subs=[],this.startupErrors=[],this.onDestroy=[],this.destroyed=!1,this.collections={},this.eventBulks$=new g.x,this.observable$=this.eventBulks$.pipe((0,b.z)((e=>e.events))),this.storageToken=c.kZ,this.storageTokenDocument=c.kZ,this.emittedEventBulkIds=new E.i(6e4),this.name=e,this.token=t,this.storage=n,this.instanceCreationOptions=r,this.password=o,this.multiInstance=s,this.eventReduce=u,this.options=l,this.internalStore=h,this.hashFunction=d,this.cleanupPolicy=f,this.allowSlowCount=p,"pseudoInstance"!==this.name&&(this.internalStore=(0,_.GT)(this.asRxDatabase,h,k.Ln),this.storageTokenDocument=(0,k.PI)(this.asRxDatabase).catch((e=>this.startupErrors.push(e))),this.storageToken=this.storageTokenDocument.then((e=>e.data.token)).catch((e=>this.startupErrors.push(e))))}var t=e.prototype;return t.$emit=function(e){this.emittedEventBulkIds.has(e.id)||(this.emittedEventBulkIds.add(e.id),this.eventBulks$.next(e))},t.removeCollectionDoc=async function(e,t){var n=await(0,_.ov)(this.internalStore,(0,k.Sy)((0,k.YA)(e,t),k.q6));if(!n)throw(0,m.f3)("SNH",{name:e,schema:t});var r=(0,_._$)(n);r._deleted=!0,await this.internalStore.bulkWrite([{document:r,previous:n}],"rx-database-remove-collection")},t.addCollections=async function(e){var t={},n={},r=[],i={};await Promise.all(Object.entries(e).map((async([e,o])=>{var s=e,a=o.schema;t[s]=a;var c=(0,y.Dw)(a,this.hashFunction);if(n[s]=c,this.collections[e])throw(0,m.f3)("DB3",{name:e});var h=(0,k.YA)(e,a),d={id:(0,k.Sy)(h,k.q6),key:h,context:k.q6,data:{name:s,schemaHash:await c.hash,schema:c.jsonSchema,version:c.version,connectedStorages:[]},_deleted:!1,_meta:(0,u.dy)(),_rev:(0,u.i1)(),_attachments:{}};r.push({document:d});var f=Object.assign({},o,{name:s,schema:c,database:this}),p=(0,l.qu)(o);p.database=this,p.name=e,(0,v.Cb)("preCreateRxCollection",p),f.conflictHandler=p.conflictHandler,i[s]=f})));var o=await this.internalStore.bulkWrite(r,"rx-database-add-collection");await async function(e){if(await e.storageToken,e.startupErrors[0])throw e.startupErrors[0]}(this),await Promise.all(o.error.map((async e=>{if(409!==e.status)throw(0,m.f3)("DB12",{database:this.name,writeError:e});var r=(0,h.Is)(e.documentInDb),i=r.data.name,o=n[i];if(r.data.schemaHash!==await o.hash)throw(0,m.f3)("DB6",{database:this.name,collection:i,previousSchemaHash:r.data.schemaHash,schemaHash:await o.hash,previousSchema:r.data.schema,schema:(0,h.Is)(t[i])})})));var s={};return await Promise.all(Object.keys(e).map((async e=>{var t=i[e],n=await(0,w.$O)(t);s[e]=n,this.collections[e]=n,this[e]||Object.defineProperty(this,e,{get:()=>this.collections[e]})}))),s},t.lockedRun=function(e){return this.idleQueue.wrapCall(e)},t.requestIdlePromise=function(){return this.idleQueue.requestIdlePromise()},t.exportJSON=function(e){throw(0,d.k)("json-dump")},t.importJSON=function(e){throw(0,d.k)("json-dump")},t.backup=function(e){throw(0,d.k)("backup")},t.leaderElector=function(){throw(0,d.k)("leader-election")},t.isLeader=function(){throw(0,d.k)("leader-election")},t.waitForLeadership=function(){throw(0,d.k)("leader-election")},t.migrationStates=function(){throw(0,d.k)("migration")},t.destroy=async function(){return this.destroyed?c.kZ:(this.destroyed=!0,await(0,v.BU)("preDestroyRxDatabase",this),this.eventBulks$.complete(),this._subs.map((e=>e.unsubscribe())),"pseudoInstance"===this.name?c.kZ:this.requestIdlePromise().then((()=>Promise.all(this.onDestroy.map((e=>e()))))).then((()=>Promise.all(Object.keys(this.collections).map((e=>this.collections[e])).map((e=>e.destroy()))))).then((()=>this.internalStore.close())).then((()=>C.delete(this.name))).then((()=>!0)))},t.remove=function(){return this.destroy().then((()=>async function(e,t,n){var r=(0,p.sc)(10),i=await R(r,t,e,{},!1,n),o=await(0,k.uz)(t.statics,i),s=new Set;o.forEach((e=>s.add(e.data.name)));var a=Array.from(s);return await Promise.all(a.map((o=>(0,S.sJ)(t,i,r,e,o,n)))),await(0,v.BU)("postRemoveRxDatabase",{databaseName:e,storage:t}),await i.remove(),a}(this.name,this.storage,this.password)))},(0,r.Z)(e,[{key:"$",get:function(){return this.observable$}},{key:"asRxDatabase",get:function(){return this}}]),e}();async function R(e,t,n,r,i,o){return await t.createStorageInstance({databaseInstanceToken:e,databaseName:n,collectionName:_.DZ,schema:k.Ln,options:r,multiInstance:i,password:o,devMode:x.j.isDevMode()})}function I({storage:e,instanceCreationOptions:t,name:n,password:r,multiInstance:i=!0,eventReduce:o=!0,ignoreDuplicate:s=!1,options:a={},cleanupPolicy:c,allowSlowCount:u=!1,localDocuments:l=!1,hashFunction:h=f.nt}){(0,v.Cb)("preCreateRxDatabase",{storage:e,instanceCreationOptions:t,name:n,password:r,multiInstance:i,eventReduce:o,ignoreDuplicate:s,options:a,localDocuments:l}),s||function(e){if(C.has(e))throw(0,m.f3)("DB8",{name:e,link:"https://pubkey.github.io/rxdb/rx-database.html#ignoreduplicate"})}(n),C.add(n);var d=(0,p.sc)(10);return R(d,e,n,t,i,r).catch((e=>{throw C.delete(n),e})).then((f=>{var p=new O(n,d,e,t,r,i,o,a,f,h,c,u);return(0,v.BU)("createRxDatabase",{database:p,creator:{storage:e,instanceCreationOptions:t,name:n,password:r,multiInstance:i,eventReduce:o,ignoreDuplicate:s,options:a,localDocuments:l}}).then((()=>p))}))}},4176:(e,t,n)=>{"use strict";n.d(t,{A9:()=>k,Mk:()=>x,Zt:()=>S,kJ:()=>E});var r=n(9127),i=n(4975),o=n(8536),s=n(3741),a=n(7020),c=n(5688),u=n(7475),l=n(5052),h=n(1831),d=n(1462),f=n(5618),p=n(7124),m=n(109),y=n(8655),v=n(3461),g=n(442),b=n(9300),w=n(8497),_=n(7458),E={get primaryPath(){if(this.isInstanceOfRxDocument)return this.collection.schema.primaryPath},get primary(){var e=this;if(e.isInstanceOfRxDocument)return e._data[e.primaryPath]},get revision(){if(this.isInstanceOfRxDocument)return this._data._rev},get deleted$(){if(this.isInstanceOfRxDocument)return this.$.pipe((0,r.U)((e=>e._data._deleted)))},get deleted(){if(this.isInstanceOfRxDocument)return this._data._deleted},getLatest(){var e=this.collection._docCache.getLatestDocumentData(this.primary);return this.collection._docCache.getCachedRxDocument(e)},get $(){return this.collection.$.pipe((0,i.h)((e=>!e.isLocal)),(0,i.h)((e=>e.documentId===this.primary)),(0,r.U)((e=>(0,v.IA)(e))),(0,o.O)(this.collection._docCache.getLatestDocumentData(this.primary)),(0,s.x)(((e,t)=>e._rev===t._rev)),(0,r.U)((e=>this.collection._docCache.getCachedRxDocument(e))),(0,a.d)(c.kv))},get$(e){if(g.j.isDevMode()){if(e.includes(".item."))throw(0,m.f3)("DOC1",{path:e});if(e===this.primaryPath)throw(0,m.f3)("DOC2");if(this.collection.schema.finalFields.includes(e))throw(0,m.f3)("DOC3",{path:e});if(!(0,b._F)(this.collection.schema.jsonSchema,e))throw(0,m.f3)("DOC4",{path:e})}return this.$.pipe((0,r.U)((t=>(0,u.$s)(t,e))),(0,s.x)())},populate(e){var t=(0,b._F)(this.collection.schema.jsonSchema,e),n=this.get(e);if(!n)return l.m5;if(!t)throw(0,m.f3)("DOC5",{path:e});if(!t.ref)throw(0,m.f3)("DOC6",{path:e,schemaObj:t});var r=this.collection.database.collections[t.ref];if(!r)throw(0,m.f3)("DOC7",{ref:t.ref,path:e,schemaObj:t});return"array"===t.type?r.findByIds(n).exec().then((e=>{var t=e.values();return Array.from(t)})):r.findOne(n).exec()},get(e){return(0,h.c)(this._propertyCache,e,(()=>{var t=(0,u.$s)(this._data,e);if("object"!=typeof t||null===t||Array.isArray(t))return g.j.deepFreezeWhenDevMode(t);var n=this;return new Proxy((0,d.qu)(t),{get(t,r){if("string"!=typeof r)return t[r];var i=r.charAt(r.length-1);if("$"===i){var o=r.slice(0,-1);return n.get$((0,f.Ny)(e+"."+o))}if("_"===i){var s=r.slice(0,-1);return n.populate((0,f.Ny)(e+"."+s))}return n.get((0,f.Ny)(e+"."+r))}})}))},toJSON(e=!1){if(e)return g.j.deepFreezeWhenDevMode(this._data);var t=(0,d.qu)(this._data);return delete t._rev,delete t._attachments,delete t._deleted,delete t._meta,g.j.deepFreezeWhenDevMode(t)},toMutableJSON(e=!1){return(0,d.d9)(this.toJSON(e))},update(e){throw(0,p.k)("update")},incrementalUpdate(e){throw(0,p.k)("update")},updateCRDT(e){throw(0,p.k)("crdt")},putAttachment(){throw(0,p.k)("attachments")},getAttachment(){throw(0,p.k)("attachments")},allAttachments(){throw(0,p.k)("attachments")},get allAttachments$(){throw(0,p.k)("attachments")},async modify(e,t){var n=this._data,r=await(0,_.Ll)(e)(n);return this._saveData(r,n)},incrementalModify(e,t){return this.collection.incrementalWriteQueue.addWrite(this._data,(0,_.Ll)(e)).then((e=>this.collection._docCache.getCachedRxDocument(e)))},patch(e){var t=this._data,n=(0,d.d9)(t);return Object.entries(e).forEach((([e,t])=>{n[e]=t})),this._saveData(n,t)},incrementalPatch(e){return this.incrementalModify((t=>(Object.entries(e).forEach((([e,n])=>{t[e]=n})),t)))},async _saveData(e,t){if(e=(0,d.qu)(e),this._data._deleted)throw(0,m.f3)("DOC11",{id:this.primary,document:this});await x(this.collection,e,t);var n=await this.collection.storageInstance.bulkWrite([{previous:t,document:e}],"rx-document-save-data"),r=n.error[0];return(0,w.T_)(this.collection,this.primary,e,r),await this.collection._runHooks("post","save",e,this),this.collection._docCache.getCachedRxDocument(n.success[0])},remove(){var e=this.collection;if(this.deleted)return Promise.reject((0,m.f3)("DOC13",{document:this,id:this.primary}));var t,n=(0,d.qu)(this._data);return e._runHooks("pre","remove",n,this).then((async()=>{n._deleted=!0;var t=await e.storageInstance.bulkWrite([{previous:this._data,document:n}],"rx-document-remove"),r=t.error[0];return(0,w.T_)(e,this.primary,n,r),t.success[0]})).then((e=>(t=e,this.collection._runHooks("post","remove",n,this)))).then((()=>this.collection._docCache.getCachedRxDocument(t)))},incrementalRemove(){return this.incrementalModify((async e=>(await this.collection._runHooks("pre","remove",e,this),e._deleted=!0,e))).then((async e=>(await this.collection._runHooks("post","remove",e._data,e),e)))},destroy(){throw(0,m.f3)("DOC14")}};function k(e=E){var t=function(e,t){this.collection=e,this._data=t,this._propertyCache=new Map,this.isInstanceOfRxDocument=!0};return t.prototype=e,t}function S(e,t,n){var r=new e(t,n);return(0,y.Cb)("createRxDocument",r),r}function x(e,t,n){return t._meta=Object.assign({},n._meta,t._meta),g.j.isDevMode()&&e.schema.validateChange(n,t),e._runHooks("pre","save",t,n)}},109:(e,t,n)=>{"use strict";n.d(t,{pi:()=>m,f3:()=>f,zU:()=>p,A2:()=>v});var r=n(1656);function i(e,t){return i=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},i(e,t)}function o(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,i(e,t)}function s(e){return s=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},s(e)}function a(e,t,n){return a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}()?Reflect.construct.bind():function(e,t,n){var r=[null];r.push.apply(r,t);var o=new(Function.bind.apply(e,r));return n&&i(o,n.prototype),o},a.apply(null,arguments)}function c(e){var t="function"==typeof Map?new Map:void 0;return c=function(e){if(null===e||!function(e){try{return-1!==Function.toString.call(e).indexOf("[native code]")}catch(t){return"function"==typeof e}}(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return a(e,arguments,s(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),i(n,e)},c(e)}var u=n(442);function l(e,t,n){return"RxError ("+t+"):\n"+e+"\n"+function(e){var t="";return 0===Object.keys(e).length?t:(t+="Given parameters: {\n",t+=Object.keys(e).map((t=>{var n="[object Object]";try{n="errors"===t?e[t].map((e=>JSON.stringify(e,Object.getOwnPropertyNames(e)))):JSON.stringify(e[t],(function(e,t){return void 0===t?null:t}),2)}catch(e){}return t+":"+n})).join("\n"),t+="}")}(n)}var h=function(e){function t(t,n,r={}){var i,o=l(n,t,r);return(i=e.call(this,o)||this).code=t,i.message=o,i.parameters=r,i.rxdb=!0,i}return o(t,e),t.prototype.toString=function(){return this.message},(0,r.Z)(t,[{key:"name",get:function(){return"RxError ("+this.code+")"}},{key:"typeError",get:function(){return!1}}]),t}(c(Error)),d=function(e){function t(t,n,r={}){var i,o=l(n,t,r);return(i=e.call(this,o)||this).code=t,i.message=o,i.parameters=r,i.rxdb=!0,i}return o(t,e),t.prototype.toString=function(){return this.message},(0,r.Z)(t,[{key:"name",get:function(){return"RxTypeError ("+this.code+")"}},{key:"typeError",get:function(){return!0}}]),t}(c(TypeError));function f(e,t){return new h(e,u.j.tunnelErrorMessage(e),t)}function p(e,t){return new d(e,u.j.tunnelErrorMessage(e),t)}function m(e){return!(!e||409!==e.status)&&e}var y={409:"document write conflict",422:"schema validation error",510:"attachment data missing"};function v(e){return f("COL20",{name:y[e.status],document:e.documentId,writeError:e})}},4804:(e,t,n)=>{"use strict";n.d(t,{VL:()=>It,Pk:()=>Rt,tN:()=>Ot});var r=n(9334),i=n(9300),o=n(1462),s=n(3333);const a=Number.MAX_SAFE_INTEGER,c=Number.MIN_SAFE_INTEGER,u=Symbol("missing"),l=Object.freeze(new Error("mingo: cycle detected while processing object/array")),h=Object.getPrototypeOf([]),d=Object.getPrototypeOf({}),f=/^\[object ([a-zA-Z0-9]+)\]$/;class p{}class m{}const y=e=>null===e?p:void 0===e?m:e.constructor,v=e=>{const t=function(e){const t=new Set,n=e=>{const r=y(e);if(E.has(r))return E.get(r)(e);const i=r===Object?"":r.name;if(N(e.toJSON))return`${i}(${JSON.stringify(e)})`;if(t.has(e))throw l;t.add(e);try{if(r===Array)return"["+e.map(n).join(",")+"]";if(r!==Object){const[t,r]=Y(e);if(D(e))return`${i}${n([...e,t])}`;e=t}const t=Object.keys(e);return t.sort(),`${i}{`+t.map((t=>`${t}:${n(e[t])}`)).join(",")+"}"}finally{t.delete(e)}};return n(e)}(e);let n=0,r=t.length;for(;r;)n=(n<<5)-n^t.charCodeAt(--r);return n>>>0},g=new Set(["null","undefined","boolean","number","string","date","regexp"]),b=new Set([m,p,Boolean,String,Number]),w=e=>e.toString(),_=e=>`${y(e).name}[${e.toString()}]`,E=new Map([[Number,w],[Boolean,w],[RegExp,w],[Function,w],[Symbol,w],[BigInt,e=>"0x"+e.toString(16)],[Date,e=>e.toISOString()],[String,JSON.stringify],[p,e=>"null"],[m,e=>"undefined"],[Int8Array,_],[Uint8Array,_],[Uint8ClampedArray,_],[Int16Array,_],[Uint16Array,_],[Int32Array,_],[Uint32Array,_],[Float32Array,_],[Float64Array,_],[BigInt64Array,_],[BigUint64Array,_]]),k={null:0,undefined:0,number:1,string:2,object:3,array:4,boolean:5,date:6,regexp:7,function:8},S=(e,t)=>{e===u&&(e=void 0),t===u&&(t=void 0);const[n,r]=[e,t].map((e=>k[O(e).toLowerCase()]));return n!==r?n-r:1===n||2===n||6===n?e<t?-1:e>t?1:0:G(e,t)?0:e<t?-1:e>t?1:0};function x(e,t){if(!e)throw new Error(t)}const C=e=>{if(b.has(y(e)))return e;const t=new Set,n=e=>{if(t.has(e))throw l;const r=y(e);if(b.has(r))return e;try{if(D(e))return t.add(e),e.map(n);if(T(e)){t.add(e);const r={};for(const t in e)r[t]=n(e[t]);return r}}finally{t.delete(e)}return r===Date||r===RegExp||(e=>{const t=Object.getPrototypeOf(y(e));return t&&"TypedArray"===t.name})(e)?new r(e):e};return n(e)},O=e=>f.exec(Object.prototype.toString.call(e))[1],R=e=>"boolean"==typeof e,I=e=>"string"==typeof e,P=e=>!isNaN(e)&&"number"==typeof e,D=Array.isArray,T=e=>{if(!e)return!1;const t=Object.getPrototypeOf(e);return(t===d||null===t)&&"[object Object]"===Object.prototype.toString.call(e)},A=e=>e===Object(e),j=e=>e instanceof Date,M=e=>e instanceof RegExp,N=e=>"function"==typeof e,L=e=>null==e,B=(e,t)=>e.includes(t),F=(e,t)=>!B(e,t),$=e=>L(e)||I(e)&&!e||e instanceof Array&&0===e.length||T(e)&&0===Object.keys(e).length,q=e=>e===u,K=e=>e instanceof Array?e:[e],U=(e,t)=>!!e&&Object.prototype.hasOwnProperty.call(e,t),W=(e,t)=>T(e)&&T(t)||D(e)&&D(t);function z(e,t,n){if(n=n||{flatten:!1},q(e)||L(e))return t;if(q(t)||L(t))return e;if(!W(e,t)){if(n.skipValidation)return t||e;throw Error("mismatched types. must both be array or object")}if(n.skipValidation=!0,D(e)){const r=e,i=t;if(n.flatten){let e=0,o=0;for(;e<r.length&&o<i.length;)r[e]=z(r[e++],i[o++],n);for(;o<i.length;)r.push(t[o++])}else ee(r,i)}else for(const r in t)e[r]=z(e[r],t[r],n);return e}function H(e,t=v){const n=new Map;return e.forEach(((r,i)=>{const o=J(r,t);n.has(o)?n.get(o).some((t=>G(e[t],r)))||n.get(o).push(i):n.set(o,[i])})),n}function Q(e,t=v){if(e.some((e=>0==e.length)))return[];if(1===e.length)return Array.from(e);const n=function(e,t,n=S){if($(e))return e;const r=new Array,i=new Array;for(let n=0;n<e.length;n++){const o=e[n],s=t(o,n);L(s)?i.push(o):r.push([s,o])}return r.sort(((e,t)=>n(e[0],t[0]))),ee(i,r.map((e=>e[1])))}(e.map(((e,t)=>[t,e.length])),(e=>e[1])),r=e[n[0][0]],i=H(r,t),o=new Map,s=new Array;return i.forEach(((t,i)=>{const a=t.map((e=>r[e])),c=a.map((e=>0)),l=a.map((e=>[n[0][0],0]));let h=!1;for(let t=1;t<e.length;t++){const[r,s]=n[t],u=e[r];if(o.has(t)||o.set(t,H(u)),o.get(t).has(i)){const e=o.get(t).get(i).map((e=>u[e]));h=a.map(((n,s)=>e.some(((e,a)=>{const u=c[s];return G(n,e)&&(c[s]++,r<l[s][0]&&(l[s]=[r,o.get(t).get(i)[a]])),u<c[s]})))).some(Boolean)}if(!h)return}h&&ee(s,c.map(((t,n)=>t===e.length-1?[a[n],l[n]]:u)).filter((e=>e!==u)))})),s.sort(((e,t)=>{const[n,[r,i]]=e,[o,[s,a]]=t,c=S(r,s);return 0!==c?c:S(i,a)})).map((e=>e[0]))}function V(e,t=0){const n=new Array;return function e(t,r){for(let i=0,o=t.length;i<o;i++)D(t[i])&&(r>0||r<0)?e(t[i],Math.max(-1,r-1)):n.push(t[i])}(e,t),n}const Y=e=>{let[t,n]=[Object.getPrototypeOf(e),Object.getOwnPropertyNames(e)],r=t;for(;!n.length&&t!==d&&t!==h;)r=t,n=Object.getOwnPropertyNames(t),t=Object.getPrototypeOf(t);const i={};return n.forEach((t=>i[t]=e[t])),[i,r]};function G(e,t){const n=[[e,t]];for(;n.length>0;){if([e,t]=n.pop(),e===t)continue;const r=y(e);if(r!==y(t)||N(e))return!1;if(E.has(r)){const n=E.get(r);if(n(e)!==n(t))return!1}else{if(r!==Array&&r!==Object)return!1;{const r=Object.keys(e),i=Object.keys(t);if(r.length!==i.length)return!1;if(new Set(r.concat(i)).size!=r.length)return!1;for(const i of r)n.push([e[i],t[i]])}}}return!n.length}function J(e,t){return t=t||v,L(e)?null:t(e).toString()}function Z(e,t,n=v){if(e.length<1)return new Map;const r=new Map,i=new Map;for(let o=0;o<e.length;o++){const s=e[o],a=t(s,o),c=J(a,n);if(null===c)i.has(null)?i.get(null).push(s):i.set(null,[s]);else{const e=r.has(c)?r.get(c).find((e=>G(e,a))):null;L(e)?(i.set(a,[s]),r.has(c)?r.get(c).push(a):r.set(c,[a])):i.get(e).push(s)}}return i}const X=5e4;function ee(e,...t){return e instanceof Array?t.reduce(((e,t)=>{let n=Math.ceil(t.length/X),r=0;for(;n-- >0;)Array.prototype.push.apply(e,t.slice(r,r+X)),r+=X;return e}),e):t.filter(A).reduce(((e,t)=>(Object.assign(e,t),e)),e)}function te(e,t){return A(e)?e[t]:void 0}function ne(e,t,n){let r=0;const i=g.has(O(e).toLowerCase())?e:function e(t,n){let i=t;for(let t=0;t<n.length;t++){const o=n[t];if(null===/^\d+$/.exec(o)&&i instanceof Array){if(0===t&&r>0)break;r+=1;const o=n.slice(t);i=i.reduce(((t,n)=>{const r=e(n,o);return void 0!==r&&t.push(r),t}),[]);break}if(i=te(i,o),void 0===i)break}return i}(e,t.split("."));return i instanceof Array&&(null==n?void 0:n.unwrapArray)?function(e,t){if(t<1)return e;for(;t--&&1===e.length;)e=e[0];return e}(i,r):i}function re(e,t,n){const r=t.split("."),i=r[0],o=r.slice(1).join("."),s=null!==/^\d+$/.exec(i),a=r.length>1;let c,l;if(e instanceof Array)if(s)c=te(e,Number(i)),a&&(c=re(c,o,n)),c=[c];else{c=[];for(const r of e)l=re(r,t,n),(null==n?void 0:n.preserveMissing)?(void 0===l&&(l=u),c.push(l)):void 0!==l&&c.push(l)}else{if(l=te(e,i),a&&(l=re(l,o,n)),void 0===l)return;c=(null==n?void 0:n.preserveKeys)?Object.assign({},e):{},c[i]=l}return c}function ie(e){if(e instanceof Array)for(let t=e.length-1;t>=0;t--)e[t]===u?e.splice(t,1):ie(e[t]);else if(T(e))for(const t in e)U(e,t)&&ie(e[t])}const oe=/^\d+$/;function se(e,t,n,r){const i=t.split("."),o=i[0],s=i.slice(1).join(".");if(1===i.length)(T(e)||D(e)&&oe.test(o))&&n(e,o);else{(null==r?void 0:r.buildGraph)&&L(e[o])&&(e[o]={});const t=e[o];if(!t)return;const a=!!(i.length>1&&oe.test(i[1]));t instanceof Array&&(null==r?void 0:r.descendArray)&&!a?t.forEach((e=>se(e,s,n,r))):se(t,s,n,r)}}function ae(e,t,n){se(e,t,((e,t)=>{e[t]=N(n)?n(e[t]):n}),{buildGraph:!0})}function ce(e,t,n){se(e,t,((e,t)=>{if(e instanceof Array){if(/^\d+$/.test(t))e.splice(parseInt(t),1);else if(n&&n.descendArray)for(const n of e)T(n)&&delete n[t]}else T(e)&&delete e[t]}),n)}const ue=/^\$[a-zA-Z0-9_]+$/;function le(e){return ue.test(e)}function he(e){if(g.has(O(e).toLowerCase()))return M(e)?{$regex:e}:{$eq:e};if(A(e)){const t=e;if(!Object.keys(t).some(le))return{$eq:e};if(U(e,"$regex")){const t=Object.assign({},e);return t.$regex=new RegExp(e.$regex,e.$options),delete t.$options,t}}return e}var de,fe,pe=n(109);!function(e){e.CLONE_ALL="CLONE_ALL",e.CLONE_INPUT="CLONE_INPUT",e.CLONE_OUTPUT="CLONE_OUTPUT",e.CLONE_OFF="CLONE_OFF"}(de||(de={}));class me{constructor(e,t,n,r=Date.now()){this._opts=e,this._root=t,this._local=n,this.timestamp=r,this.update(t,n)}static init(e,t,n){return e instanceof me?new me(e._opts,L(e.root)?t:e.root,Object.assign({},e.local,n)):new me(e,t,n)}update(e,t){var n;return this._root=e,this._local=t?Object.assign({},t,{variables:Object.assign({},null===(n=this._local)||void 0===n?void 0:n.variables,null==t?void 0:t.variables)}):t,this}getOptions(){return Object.freeze(Object.assign(Object.assign({},this._opts),{context:ve.from(this._opts.context)}))}get root(){return this._root}get local(){return this._local}get idKey(){return this._opts.idKey}get collation(){var e;return null===(e=this._opts)||void 0===e?void 0:e.collation}get processingMode(){var e;return(null===(e=this._opts)||void 0===e?void 0:e.processingMode)||de.CLONE_OFF}get useStrictMode(){var e;return null===(e=this._opts)||void 0===e?void 0:e.useStrictMode}get scriptEnabled(){var e;return null===(e=this._opts)||void 0===e?void 0:e.scriptEnabled}get useGlobalContext(){var e;return null===(e=this._opts)||void 0===e?void 0:e.useGlobalContext}get hashFunction(){var e;return null===(e=this._opts)||void 0===e?void 0:e.hashFunction}get collectionResolver(){var e;return null===(e=this._opts)||void 0===e?void 0:e.collectionResolver}get jsonSchemaValidator(){var e;return null===(e=this._opts)||void 0===e?void 0:e.jsonSchemaValidator}get variables(){var e;return null===(e=this._opts)||void 0===e?void 0:e.variables}get context(){var e;return null===(e=this._opts)||void 0===e?void 0:e.context}}function ye(e){return e instanceof me?e.getOptions():Object.freeze(Object.assign(Object.assign({idKey:"_id",scriptEnabled:!0,useStrictMode:!0,useGlobalContext:!0,processingMode:de.CLONE_OFF},e),{context:(null==e?void 0:e.context)?ve.from(null==e?void 0:e.context):ve.init({})}))}!function(e){e.ACCUMULATOR="accumulator",e.EXPRESSION="expression",e.PIPELINE="pipeline",e.PROJECTION="projection",e.QUERY="query",e.WINDOW="window"}(fe||(fe={}));class ve{constructor(e){this.operators={[fe.ACCUMULATOR]:{},[fe.EXPRESSION]:{},[fe.PIPELINE]:{},[fe.PROJECTION]:{},[fe.QUERY]:{},[fe.WINDOW]:{}};for(const[t,n]of Object.entries(e))this.addOperators(t,n)}static init(e={}){return new ve(e)}static from(e){return new ve(e.operators)}addOperators(e,t){for(const[n,r]of Object.entries(t))this.getOperator(e,n)||(this.operators[e][n]=r);return this}addAccumulatorOps(e){return this.addOperators(fe.ACCUMULATOR,e)}addExpressionOps(e){return this.addOperators(fe.EXPRESSION,e)}addQueryOps(e){return this.addOperators(fe.QUERY,e)}addPipelineOps(e){return this.addOperators(fe.PIPELINE,e)}addProjectionOps(e){return this.addOperators(fe.PROJECTION,e)}addWindowOps(e){return this.addOperators(fe.WINDOW,e)}getOperator(e,t){return e in this.operators&&this.operators[e][t]||null}}const ge=ve.init();function be(e,t){for(const[n,r]of Object.entries(t)){x(N(r)&&le(n),`'${n}' is not a valid operator`);const t=we(e,n,null);x(!t||r===t,`${n} already exists for '${e}' operators. Cannot change operator function once registered.`)}switch(e){case fe.ACCUMULATOR:ge.addAccumulatorOps(t);break;case fe.EXPRESSION:ge.addExpressionOps(t);break;case fe.PIPELINE:ge.addPipelineOps(t);break;case fe.PROJECTION:ge.addProjectionOps(t);break;case fe.QUERY:ge.addQueryOps(t);break;case fe.WINDOW:ge.addWindowOps(t)}}function we(e,t,n){const{context:r,useGlobalContext:i}=n||{},o=r?r.getOperator(e,t):null;return!o&&i?ge.getOperator(e,t):o}const _e={$$ROOT:(e,t,n)=>n.root,$$CURRENT:(e,t,n)=>e,$$REMOVE(e,t,n){},$$NOW:(e,t,n)=>new Date(n.timestamp)},Ee={$$KEEP:(e,t,n)=>e,$$PRUNE(e,t,n){},$$DESCEND(e,t,n){if(!U(t,"$cond"))return e;let r;for(const[i,o]of Object.entries(e))if(A(o)){if(o instanceof Array){const e=[];for(let r of o)T(r)&&(r=Se(r,t,n.update(r))),L(r)||e.push(r);r=e}else r=Se(o,t,n.update(o));L(r)?delete e[i]:e[i]=r}return e}};function ke(e,t,n,r){var i;const o=me.init(r,e);if(le(n=n||"")){const i=we(fe.EXPRESSION,n,r);if(i)return i(e,t,o);const s=we(fe.ACCUMULATOR,n,r);if(s)return e instanceof Array||(e=ke(e,t,null,o),t=null),x(e instanceof Array,`'${n}' target must be an array.`),s(e,t,o.update(null,o.local));throw new Error(`operator '${n}' is not registered`)}if(I(t)&&t.length>0&&"$"===t[0]){if(U(Ee,t))return t;let n=o.root;const r=t.split(".");if(U(_e,r[0]))n=_e[r[0]](e,null,o),t=t.slice(r[0].length+1);else if("$$"===r[0].slice(0,2)){n=Object.assign({},o.variables,{this:e},null===(i=o.local)||void 0===i?void 0:i.variables);const s=r[0].slice(2);x(U(n,s),`Use of undefined variable: ${s}`),t=t.slice(2)}else t=t.slice(1);return""===t?n:ne(n,t)}if(D(t))return t.map((t=>ke(e,t,null,o)));if(T(t)){const n={};for(const[i,s]of Object.entries(t))if(n[i]=ke(e,s,i,o),[fe.EXPRESSION,fe.ACCUMULATOR].some((e=>!!we(e,i,r))))return x(1===Object.keys(t).length,"Invalid aggregation expression '"+JSON.stringify(t)+"'"),n[i];return n}return t}function Se(e,t,n){const r=ke(e,t,null,n);return U(Ee,r)?Ee[r](e,t,n):r}function xe(e){return e instanceof Ie?e:new Ie(e)}function Ce(e,t){const n=e.slice(t+1);e.splice(t),Array.prototype.push.apply(e,n)}const Oe=new Error;var Re;!function(e){e[e.MAP=0]="MAP",e[e.FILTER=1]="FILTER",e[e.TAKE=2]="TAKE",e[e.DROP=3]="DROP"}(Re||(Re={}));class Ie{constructor(e){let t;if(this.iteratees=[],this.yieldedValues=[],this.isDone=!1,e instanceof Function&&(e={next:e}),(n=e)&&"object"==typeof n&&(null==n?void 0:n.next)instanceof Function){const n=e;t=()=>{const e=n.next();if(e.done)throw Oe;return e.value}}else if(e instanceof Array){const n=e,r=n.length;let i=0;t=()=>{if(i<r)return n[i++];throw Oe}}else if(!(e instanceof Function))throw new Error("Lazy must be initialized with an array, generator, or function.");var n;this.getNext=function(e,t,n){let r=!1,i=-1,o=0;return function(s){try{e:for(;!r;){let a=e();i++;let c=-1;const u=t.length;let l=!1;for(;++c<u;){const e=t[c];switch(e.action){case Re.MAP:a=e.func(a,i);break;case Re.FILTER:if(!e.func(a,i))continue e;break;case Re.TAKE:--e.count,e.count||(l=!0);break;case Re.DROP:--e.count,e.count||Ce(t,c);continue e;default:break e}}if(r=l,!s)return{value:a,done:!1};n[o++]=a}}catch(e){if(e!==Oe)throw e}return r=!0,{done:r}}}(t,this.iteratees,this.yieldedValues)}push(e,t){return"function"==typeof t?this.iteratees.push({action:e,func:t}):"number"==typeof t&&this.iteratees.push({action:e,count:t}),this}next(){return this.getNext()}map(e){return this.push(Re.MAP,e)}filter(e){return this.push(Re.FILTER,e)}take(e){return e>0?this.push(Re.TAKE,e):this}drop(e){return e>0?this.push(Re.DROP,e):this}transform(e){const t=this;let n;return xe((()=>(n||(n=xe(e(t.value()))),n.next())))}value(){return this.isDone||(this.isDone=this.getNext(!0).done),this.yieldedValues}each(e){for(;;){const t=this.next();if(t.done)break;if(!1===e(t.value))return!1}return!0}reduce(e,t){let n=this.next();for(void 0!==t||n.done||(t=n.value,n=this.next());!n.done;)t=e(t,n.value),n=this.next();return t}size(){return this.reduce(((e,t)=>++e),0)}[Symbol.iterator](){return this}}class Pe{constructor(e,t){this.pipeline=e,this.options=ye(t)}stream(e){let t=xe(e);const n=this.options.processingMode;n!=de.CLONE_ALL&&n!=de.CLONE_INPUT||t.map(C);const r=new Array;if(!$(this.pipeline))for(const e of this.pipeline){const n=Object.keys(e),i=n[0],o=we(fe.PIPELINE,i,this.options);x(1===n.length&&!!o,`invalid pipeline operator ${i}`),r.push(i),t=o(t,e[i],this.options)}return(n==de.CLONE_OUTPUT||n==de.CLONE_ALL&&Q([["$group","$unwind"],r]).length)&&t.map(C),t}run(e){return this.stream(e).value()}}class De{constructor(e,t,n,r){this.source=e,this.predicate=t,this.projection=n,this.options=r,this.operators=[],this.result=null,this.buffer=[]}fetch(){return this.result||(T(this.projection)&&this.operators.push({$project:this.projection}),this.result=xe(this.source).filter(this.predicate),this.operators.length>0&&(this.result=new Pe(this.operators,this.options).stream(this.result))),this.result}fetchAll(){const e=xe([...this.buffer]);return this.buffer=[],function(...e){let t=0;return xe((()=>{for(;t<e.length;){const n=e[t].next();if(!n.done)return n;t++}return{done:!0}}))}(e,this.fetch())}all(){return this.fetchAll().value()}count(){return this.all().length}skip(e){return this.operators.push({$skip:e}),this}limit(e){return this.operators.push({$limit:e}),this}sort(e){return this.operators.push({$sort:e}),this}collation(e){return this.options=Object.assign(Object.assign({},this.options),{collation:e}),this}next(){if(this.buffer.length>0)return this.buffer.pop();const e=this.fetch().next();return e.done?void 0:e.value}hasNext(){if(this.buffer.length>0)return!0;const e=this.fetch().next();return!e.done&&(this.buffer.push(e.value),!0)}map(e){return this.all().map(e)}forEach(e){this.all().forEach(e)}[Symbol.iterator](){return this.fetchAll()}}class Te{constructor(e,t){this.condition=e,this.options=ye(t),this.compiled=[],this.compile()}compile(){x(T(this.condition),`query criteria must be an object: ${JSON.stringify(this.condition)}`);const e={};for(const[t,n]of Object.entries(this.condition)){if("$where"===t)Object.assign(e,{field:t,expr:n});else if(B(["$and","$or","$nor","$expr","$jsonSchema"],t))this.processOperator(t,t,n);else{x(!le(t),`unknown top level operator: ${t}`);for(const[e,r]of Object.entries(he(n)))this.processOperator(t,e,r)}e.field&&this.processOperator(e.field,e.field,e.expr)}}processOperator(e,t,n){const r=we(fe.QUERY,t,this.options);if(!r)throw new Error(`unknown operator ${t}`);const i=r(e,n,this.options);this.compiled.push(i)}test(e){for(let t=0,n=this.compiled.length;t<n;t++)if(!this.compiled[t](e))return!1;return!0}find(e,t){return new De(e,(e=>this.test(e)),t||{},this.options)}remove(e){return e.reduce(((e,t)=>(this.test(t)||e.push(t),e)),[])}}new WeakMap;const Ae=(e,t,n)=>{if($(t)||!T(t))return e;let r=S;const i=n.collation;return T(i)&&I(i.locale)&&(r=function(e){const t={sensitivity:je[e.strength||3],caseFirst:"off"===e.caseFirst?"false":e.caseFirst||"false",numeric:e.numericOrdering||!1,ignorePunctuation:"shifted"===e.alternate};!0===(e.caseLevel||!1)&&("base"===t.sensitivity&&(t.sensitivity="case"),"accent"===t.sensitivity&&(t.sensitivity="variant"));const n=new Intl.Collator(e.locale,t);return(e,t)=>{if(!I(e)||!I(t))return S(e,t);const r=n.compare(e,t);return r<0?-1:r>0?1:0}}(i)),e.transform((e=>{const i=Object.keys(t);for(const o of i.reverse()){const i=Z(e,(e=>ne(e,o)),n.hashFunction),s=Array.from(i.keys()).sort(r);-1===t[o]&&s.reverse(),e=[],s.reduce(((e,t)=>ee(e,i.get(t))),e)}return e}))},je={1:"base",2:"accent",3:"variant"};new Set(["$denseRank","$documentNumber","$first","$last","$linearFill","$rank","$shift"]),new Set(["$denseRank","$expMovingAvg","$linearFill","$locf","$rank","$shift"]);function Me(e){const t=(t,n,r)=>{const i={unwrapArray:!0},o=Math.max(1,t.split(".").length-1);return s=>{const a=ne(s,t,i);return e(a,n,Object.assign(Object.assign({},r),{depth:o}))}};return t.op="query",t}function Ne(e){return(t,n,r)=>{const i=ke(t,n,null,r);return e(...i)}}function Le(e,t,n){if(G(e,t))return!0;if(L(e)&&L(t))return!0;if(e instanceof Array){const r=G.bind(null,t);return e.some(r)||V(e,null==n?void 0:n.depth).some(r)}return!1}function Be(e,t,n){return!Le(e,t,n)}function Fe(e,t,n){return L(e)?t.some((e=>null===e)):Q([K(e),t],null==n?void 0:n.hashFunction).length>0}function $e(e,t,n){return!Fe(e,t,n)}function qe(e,t,n){return Ze(e,t,((e,t)=>S(e,t)<0))}function Ke(e,t,n){return Ze(e,t,((e,t)=>S(e,t)<=0))}function Ue(e,t,n){return Ze(e,t,((e,t)=>S(e,t)>0))}function We(e,t,n){return Ze(e,t,((e,t)=>S(e,t)>=0))}function ze(e){return le(e)&&-1===["$and","$or","$nor"].indexOf(e)}function He(e,t,n){if(D(e)&&!$(e)){let r=e=>e,i=t;Object.keys(t).every(ze)&&(i={temp:t},r=e=>({temp:e}));const o=new Te(i,n);for(let t=0,n=e.length;t<n;t++)if(o.test(r(e[t])))return!0}return!1}const Qe=e=>null===e,Ve=e=>P(e)&&e>=-2147483648&&e<=2147483647&&-1===e.toString().indexOf("."),Ye=e=>P(e)&&e>=c&&e<=a&&-1===e.toString().indexOf("."),Ge={array:D,bool:R,boolean:R,date:j,decimal:P,double:P,int:Ve,long:Ye,number:P,null:Qe,object:T,regex:M,regexp:M,string:I,undefined:L,function:e=>{throw new Error("unsupported type key `function`.")},1:P,2:I,3:T,4:D,6:L,8:R,9:j,10:Qe,11:M,16:Ve,18:Ye,19:P};function Je(e,t,n){const r=Ge[t];return!!r&&r(e)}function Ze(e,t,n){return K(e).some((e=>O(e)===O(t)&&n(e,t)))}Ne($e);const Xe=(e,t)=>(n,r,i)=>{x(D(r),`${e}: expression must be an array.`);const o=ke(n,r,null,i);return o.some(L)?null:(x(o.every(P),`${e}: expression must evalue to array of numbers.`),t(o))};Xe("$bitAnd",(e=>e.reduce(((e,t)=>e&t),-1))),Xe("$bitOr",(e=>e.reduce(((e,t)=>e|t),0))),Xe("$bitXor",(e=>e.reduce(((e,t)=>e^t),0))),Ne(Le),Ne(Ue),Ne(We),Ne(qe),Ne(Ke),Ne(Be);const et=(e,t)=>{const n={};return e.split("").forEach(((e,r)=>n[e]=t*(r+1))),n};Object.assign(Object.assign(Object.assign({},et("ABCDEFGHIKLM",1)),et("NOPQRSTUVWXY",-1)),{Z:0});const tt={undefined:null,null:null,NaN:NaN,Infinity:new Error,"-Infinity":new Error};function nt(e,t=tt){const n=Object.assign({},tt,t),r=new Set(Object.keys(n));return(t,i,o)=>{const s=ke(t,i,null,o);if(r.has(`${s}`)){const t=n[`${s}`];if(t instanceof Error)throw new Error(`cannot apply $${e.name} to -inf, value must in (-inf,inf)`);return t}return e(s)}}nt(Math.acos,{Infinity:1/0,0:new Error}),nt(Math.acosh,{Infinity:1/0,0:new Error}),nt(Math.asin),nt(Math.asinh,{Infinity:1/0,"-Infinity":-1/0}),nt(Math.atan),nt(Math.atanh,{1:1/0,"-1":-1/0}),nt(Math.cos),nt(Math.cosh,{"-Infinity":1/0,Infinity:1/0});const rt=Math.PI/180,it=(nt((e=>e*rt),{Infinity:1/0,"-Infinity":1/0}),180/Math.PI);nt((e=>e*it),{Infinity:1/0,"-Infinity":-1/0}),nt(Math.sin),nt(Math.sinh,{"-Infinity":-1/0,Infinity:1/0}),nt(Math.tan);const ot=(e,t,n)=>{if($(t))return e;let r=Object.keys(t),i=!1;at(t,n);const o=n.idKey;if(B(r,o)){const e=t[o];0!==e&&!1!==e||(r=r.filter(F.bind(null,[o])),i=0==r.length)}else r.push(o);const s=me.init(n);return e.map((e=>st(e,t,s.update(e),r,i)))};function st(e,t,n,r,i){let o={},s=!1,a=!1;const c=[];i&&c.push(n.idKey);for(const i of r){let r;const u=t[i];if(i!==n.idKey&&B([0,!1],u)&&(a=!0),i===n.idKey&&$(u))r=e[i];else if(I(u))r=ke(e,u,i,n);else if(B([1,!0],u));else if(u instanceof Array)r=u.map((t=>{const r=ke(e,t,null,n);return L(r)?null:r}));else{if(!T(u)){c.push(i);continue}{const t=u,o=Object.keys(u),a=1==o.length?o[0]:"",c=we(fe.PROJECTION,a,n);if(c)"$slice"===a?K(t[a]).every(P)?(r=c(e,t[a],i,n),s=!0):r=ke(e,t,i,n):r=c(e,t[a],i,n);else if(le(a))r=ke(e,t[a],a,n);else if(U(e,i)){at(t,n);let s=e[i];s instanceof Array?r=s.map((e=>st(e,t,n,o,!1))):(s=T(s)?s:e,r=st(s,t,n,o,!1))}else r=ke(e,u,null,n)}}const l=re(e,i,{preserveMissing:!0});void 0!==l&&z(o,l,{flatten:!0}),F([0,1,!1,!0],u)&&(void 0===r?ce(o,i,{descendArray:!0}):ae(o,i,r))}if(ie(o),(s||a||i)&&(o=ee({},e,o),c.length>0))for(const e of c)ce(o,e,{descendArray:!0});return o}function at(e,t){const n=[!1,!1];for(const[r,i]of Object.entries(e)){if(r===(null==t?void 0:t.idKey))return;0===i||!1===i?n[0]=!0:1!==i&&!0!==i||(n[1]=!0),x(!(n[0]&&n[1]),"Projection cannot have a mix of inclusion and exclusion.")}}const ct=(e,t,n)=>{x(D(t),"Invalid expression: $and expects value to be an Array.");const r=t.map((e=>new Te(e,n)));return e=>r.every((t=>t.test(e)))},ut=(e,t,n)=>{x(D(t),"Invalid expression. $or expects value to be an Array");const r=t.map((e=>new Te(e,n)));return e=>r.some((t=>t.test(e)))},lt=(e,t,n)=>{x(D(t),"Invalid expression. $nor expects value to be an array.");const r=ut("$or",t,n);return e=>!r(e)},ht=(e,t,n)=>{const r={};r[e]=he(t);const i=new Te(r,n);return e=>!i.test(e)},dt=Me(Le),ft=Me(Ue),pt=Me(We),mt=Me(Fe),yt=Me(qe),vt=Me(Ke),gt=Me(Be),bt=Me($e);const wt=Me((function(e,t,n){return K(e).some((e=>2===t.length&&e%t[0]===t[1]))})),_t=Me((function(e,t,n){const r=K(e),i=e=>I(e)&&((e,t=!0)=>!!e||t&&""===e)(t.exec(e),null==n?void 0:n.useStrictMode);return r.some(i)||V(r,1).some(i)}));Me((function(e,t,n){if(!(D(e)&&D(t)&&e.length&&t.length))return!1;let r=!0;for(const i of t){if(!r)break;r=T(i)&&B(Object.keys(i),"$elemMatch")?He(e,i.$elemMatch,n):i instanceof RegExp?e.some((e=>"string"==typeof e&&i.test(e))):e.some((e=>G(i,e)))}return r}));const Et=Me(He),kt=Me((function(e,t,n){return Array.isArray(e)&&e.length===t})),St=Me((function(e,t,n){return(!1===t||0===t)&&void 0===e||(!0===t||1===t)&&void 0!==e})),xt=Me((function(e,t,n){return Array.isArray(t)?t.findIndex((t=>Je(e,t)))>=0:Je(e,t)}));var Ct=!1;function Ot(e,t){var n=(0,i.CT)(e.primaryKey);t=(0,o.qu)(t);var a=(0,o.d9)(t);if("number"!=typeof a.skip&&(a.skip=0),a.selector?(a.selector=a.selector,Object.entries(a.selector).forEach((([e,t])=>{"object"==typeof t&&null!==t||(a.selector[e]={$eq:t})}))):a.selector={},a.index){var c=(0,s.qo)(a.index);c.includes(n)||c.push(n),a.index=c}if(a.sort){var u=a.sort.find((e=>(0,o.BT)(e)===n));u||(a.sort=a.sort.slice(0),a.sort.push({[n]:"asc"}))}else if(a.index)a.sort=a.index.map((e=>({[e]:"asc"})));else{if(e.indexes){var l=new Set;Object.entries(a.selector).forEach((([e,t])=>{("object"!=typeof t||null===t||!!Object.keys(t).find((e=>r.Os.has(e))))&&l.add(e)}));var h,d=-1;e.indexes.forEach((e=>{var t=(0,s.AD)(e)?e:[e],n=t.findIndex((e=>!l.has(e)));n>0&&n>d&&(d=n,h=t)})),h&&(a.sort=h.map((e=>({[e]:"asc"}))))}a.sort||(a.sort=[{[n]:"asc"}])}return a}function Rt(e,t){if(!t.sort)throw(0,pe.f3)("SNH",{query:t});var n=[];t.sort.forEach((e=>{var t=Object.keys(e)[0],r=Object.values(e)[0];n.push({key:t,direction:r,getValueFn:(0,o.wN)(t)})}));return(e,t)=>{for(var r=0;r<n.length;++r){var i=n[r],o=i.getValueFn(e),s=i.getValueFn(t);if(o!==s)return"asc"===i.direction?S(o,s):S(s,o)}}}function It(e,t){if(!t.sort)throw(0,pe.f3)("SNH",{query:t});var n,r=(n=t.selector,Ct||(be(fe.PIPELINE,{$sort:Ae,$project:ot}),be(fe.QUERY,{$and:ct,$eq:dt,$elemMatch:Et,$exists:St,$gt:ft,$gte:pt,$in:mt,$lt:yt,$lte:vt,$ne:gt,$nin:bt,$mod:wt,$nor:lt,$not:ht,$or:ut,$regex:_t,$size:kt,$type:xt}),Ct=!0),new Te(n));return e=>!e._deleted&&r.test(e)}},5453:(e,t,n)=>{"use strict";n.d(t,{OX:()=>be,sU:()=>we,uy:()=>_e});var r=n(1656),i=n(6515),o=n(7795),s=n(4367),a=n(7878),c=new(n(1480).y)((function(e){return e.complete()}));var u=n(7617),l=n(1954);var h=n(4975),d=n(8536),f=n(7877),p=n(9127),m=n(7020),y=n(3741),v=n(6493),g=n(5052),b=n(5688),w=n(1462),_=n(7124),E=n(6069),k=n(3333),S=n(109),x=n(8655);const C=e=>{e.previousResults.unshift(e.changeEvent.doc),e.keyDocumentMap&&e.keyDocumentMap.set(e.changeEvent.id,e.changeEvent.doc)},O=e=>{e.previousResults.push(e.changeEvent.doc),e.keyDocumentMap&&e.keyDocumentMap.set(e.changeEvent.id,e.changeEvent.doc)},R=e=>{const t=e.previousResults.shift();e.keyDocumentMap&&t&&e.keyDocumentMap.delete(t[e.queryParams.primaryKey])},I=e=>{const t=e.previousResults.pop();e.keyDocumentMap&&t&&e.keyDocumentMap.delete(t[e.queryParams.primaryKey])},P=e=>{e.keyDocumentMap&&e.keyDocumentMap.delete(e.changeEvent.id);const t=e.queryParams.primaryKey,n=e.previousResults;for(let r=0;r<n.length;r++){if(n[r][t]===e.changeEvent.id){n.splice(r,1);break}}},D=e=>{const t=e.changeEvent.id,n=e.changeEvent.doc;if(e.keyDocumentMap){if(e.keyDocumentMap.has(t))return;e.keyDocumentMap.set(t,n)}else{if(e.previousResults.find((n=>n[e.queryParams.primaryKey]===t)))return}!function(e,t,n,r){var i,o=e.length,s=o-1,a=0;if(0===o)return e.push(t),0;for(;r<=s;)n(i=e[a=r+(s-r>>1)],t)<=0?r=a+1:s=a-1;n(i,t)<=0&&a++,e.splice(a,0,t)}(e.previousResults,n,e.queryParams.sortComparator,0)},T=["doNothing","insertFirst","insertLast","removeFirstItem","removeLastItem","removeFirstInsertLast","removeLastInsertFirst","removeFirstInsertFirst","removeLastInsertLast","removeExisting","replaceExisting","alwaysWrong","insertAtSortPosition","removeExistingAndInsertAtSortPosition","runFullQueryAgain","unknownAction"],A={doNothing:e=>{},insertFirst:C,insertLast:O,removeFirstItem:R,removeLastItem:I,removeFirstInsertLast:e=>{R(e),O(e)},removeLastInsertFirst:e=>{I(e),C(e)},removeFirstInsertFirst:e=>{R(e),C(e)},removeLastInsertLast:e=>{I(e),O(e)},removeExisting:P,replaceExisting:e=>{const t=e.changeEvent.doc,n=e.queryParams.primaryKey,r=e.previousResults;for(let i=0;i<r.length;i++){if(r[i][n]===e.changeEvent.id){r[i]=t,e.keyDocumentMap&&e.keyDocumentMap.set(e.changeEvent.id,t);break}}},alwaysWrong:e=>{const t={_id:"wrongHuman"+(new Date).getTime()};e.previousResults.length=0,e.previousResults.push(t),e.keyDocumentMap&&(e.keyDocumentMap.clear(),e.keyDocumentMap.set(t._id,t))},insertAtSortPosition:D,removeExistingAndInsertAtSortPosition:e=>{P(e),D(e)},runFullQueryAgain:e=>{throw new Error("Action runFullQueryAgain must be implemented by yourself")},unknownAction:e=>{throw new Error("Action unknownAction should never be called")}};!function(e=6){let t="";const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";for(let r=0;r<e;r++)t+=n.charAt(Math.floor(62*Math.random()))}(4);function j(e,t){const n=[];for(let r=0,i=e.length;r<i;r+=t)n.push(e.substring(r,r+t));return n}const M=40;function N(e){return e.charCodeAt(0)-M}function L(e){return e[e.length-1]}function B(e,t,n){if(Array.isArray(t)&&(t=t.join(".")),!function(e){const t=typeof e;return null!==e&&("object"===t||"function"===t)}(e)||"string"!=typeof t)return void 0===n?e:n;const r=t.split(".");if(0===r.length)return n;for(let t=0;t<r.length;t++){const i=r[t];if(null==(e=F(e,i)?t===r.length-1?void 0:null:e[i])){if(t!==r.length-1)return n;break}}return void 0===e?n:e}function F(e,t){if("number"!=typeof t&&Array.isArray(e)){const n=Number.parseInt(t,10);return Number.isInteger(n)&&e[n]===e[t]}return!1}const $=e=>!!e.queryParams.limit,q=e=>1===e.queryParams.limit,K=e=>!!(e.queryParams.skip&&e.queryParams.skip>0),U=e=>"DELETE"===e.changeEvent.operation,W=e=>"INSERT"===e.changeEvent.operation,z=e=>"UPDATE"===e.changeEvent.operation,H=e=>$(e)&&e.previousResults.length>=e.queryParams.limit,Q=e=>{const t=e.queryParams.sortFields,n=e.changeEvent.previous,r=e.changeEvent.doc;if(!r)return!1;if(!n)return!0;for(let e=0;e<t.length;e++){const i=t[e];if(B(n,i)!==B(r,i))return!0}return!1},V=e=>{const t=e.changeEvent.id;if(e.keyDocumentMap){return e.keyDocumentMap.has(t)}{const n=e.queryParams.primaryKey,r=e.previousResults;for(let e=0;e<r.length;e++){if(r[e][n]===t)return!0}return!1}},Y=e=>{const t=e.previousResults[0];return!(!t||t[e.queryParams.primaryKey]!==e.changeEvent.id)},G=e=>{const t=L(e.previousResults);return!(!t||t[e.queryParams.primaryKey]!==e.changeEvent.id)},J=e=>{const t=e.changeEvent.previous;if(!t)return!1;const n=e.previousResults[0];if(!n)return!1;if(n[e.queryParams.primaryKey]===e.changeEvent.id)return!0;return e.queryParams.sortComparator(t,n)<0},Z=e=>{const t=e.changeEvent.previous;if(!t)return!1;const n=L(e.previousResults);if(!n)return!1;if(n[e.queryParams.primaryKey]===e.changeEvent.id)return!0;return e.queryParams.sortComparator(t,n)>0},X=e=>{const t=e.changeEvent.doc;if(!t)return!1;const n=e.previousResults[0];if(!n)return!1;if(n[e.queryParams.primaryKey]===e.changeEvent.id)return!0;return e.queryParams.sortComparator(t,n)<0},ee=e=>{const t=e.changeEvent.doc;if(!t)return!1;const n=L(e.previousResults);if(!n)return!1;if(n[e.queryParams.primaryKey]===e.changeEvent.id)return!0;return e.queryParams.sortComparator(t,n)>0},te=e=>{const t=e.changeEvent.previous;return!!t&&e.queryParams.queryMatcher(t)},ne=e=>{const t=e.changeEvent.doc;if(!t)return!1;return e.queryParams.queryMatcher(t)},re=e=>0===e.previousResults.length,ie={0:W,1:z,2:U,3:$,4:q,5:K,6:re,7:H,8:Y,9:G,10:Q,11:V,12:J,13:Z,14:X,15:ee,16:te,17:ne};let oe;function se(){return oe||(oe=function(e){const t=new Map,n=2+2*parseInt(e.charAt(0)+e.charAt(1),10),r=j(e.substring(2,n),2);for(let e=0;e<r.length;e++){const n=r[e],i=n.charAt(0),o=N(n.charAt(1));t.set(i,o)}const i=j(e.substring(n,e.length-3),4);for(let e=0;e<i.length;e++){const n=i[e],r=n.charAt(0),o=n.charAt(1),s=n.charAt(2),a=N(n.charAt(3));if(!t.has(o))throw new Error("missing node with id "+o);if(!t.has(s))throw new Error("missing node with id "+s);const c={l:a,0:t.get(o),1:t.get(s)};t.set(r,c)}const o=e.slice(-3),s=o.charAt(0),a=o.charAt(1);return{l:N(o.charAt(2)),0:t.get(s),1:t.get(a)}}("14a1b,c+d2e5f0g/h.i4j*k-l)m(n6obh9pce9qnh9rad9scm9tae9uan9vbf9wbe9xbn9ycg9zck9{cn9|nd9}ne9~nf9ng9¡nm9¢nk9£mh9¤mi9¥mj9¦mk9§ml9¨mn9©mc8ª¤{8«¥z8¬¨s8­¨n8®mn8¯¨¡8°¨m8±pz7²ª«7³{z7´­®7µ}n7¶¤¥7·¨m7¸wo6¹µ}6ºnq6»²¬6¼tu6½wx6¾´¯6¿µn6À®¯6Á¶§6Â·£6Ã¶¨6Ä·¨6Åm¦6Æm¨6Ç¤¥5È¨m5Ém©4Êm®4ËÇ§4ÌÈ£4ÍÇ¬4ÎÃ»4ÏÈ¯4ÐÄ¾4Ñm¦4Òm¯4ÓÆÀ4Ôma3Õmn3ÖÉa3×Ên3ØËr3ÙÁt3ÚÌ|3ÛÂ¹3ÜÍr3ÝÎ¼3ÞÏ|3ßÐ¿3àØÙ2áv¸2ây±2ãÚÛ2ä~º2åµ2æÜÝ2çv½2èy³2éz{2êÞß2ë~n2ìn2íÑÅ2îÒÓ2ï¢n2ðÔb1ñÕn1òÖb1ó×n1ôàá1õâz1öãä1÷æç1øèé1ùêë1úðc0ûñn0üòc0ýón0þmn0ÿÊn0Āôõ0āöå0Ă÷ø0ăùì0Ąíï0ąîï0Ćúû/ćüý/ĈĀā/ĉĂă/ĊÁÂ/ċÃÄ/Čúm.čüm.ĎĆm.ďćm.Đþm.đÿm.ĒĀ§.ēĂ°.ĔĈ§.ĕĉ°.ĖĄ§.ėą°.ĘÁ§.ęÃ¨.ĚĊ§.ěċ¨.ĜÅ§.ĝÆ¨.ĞČč-ğĎď-ĠĐđ-ġĒē-ĢĔĕ-ģĖė-ĤĘę-ĥĚě-ĦĜĝ-ħğĠ,ĨĢģ,ĩĥĦ,ĪĞħ+īġĨ+ĬĤĩ+ĭĪī)ĭĬ(")),oe}const ae=e=>function(e,t,n){let r=e,i=e.l;for(;;){if(r=r[t[i](n)?"1":"0"],"number"==typeof r||"string"==typeof r)return r;i=r.l}}(se(),ie,e);function ce(e){const t=ae(e);return T[t]}var ue=n(3461),le=n(1831),he=n(4804);function de(e,t){return t.sort&&0!==t.sort.length?t.sort.map((e=>Object.keys(e)[0])):[e]}var fe=new WeakMap;function pe(e,t){if(!e.collection.database.eventReduce)return{runFullQueryAgain:!0};var n=function(e){return(0,le.c)(fe,e,(()=>{var t=e.collection,n=(0,he.tN)(t.storageInstance.schema,(0,w.d9)(e.mangoQuery)),r=t.schema.primaryPath,i=(0,he.Pk)(t.schema.jsonSchema,n),o=(0,he.VL)(t.schema.jsonSchema,n);return{primaryKey:e.collection.schema.primaryPath,skip:n.skip,limit:n.limit,sortFields:de(r,n),sortComparator:(t,n)=>{var r={docA:t,docB:n,rxQuery:e};return i(r.docA,r.docB)},queryMatcher:t=>o({doc:t,rxQuery:e}.doc)}}))}(e),r=(0,b.Is)(e._result).docsData.slice(0),i=(0,b.Is)(e._result).docsDataMap,o=!1,s=t.map((e=>(0,ue.v9)(e))).filter(k.S7).find((e=>{var t=ce({queryParams:n,changeEvent:e,previousResults:r,keyDocumentMap:i});return"runFullQueryAgain"===t||("doNothing"!==t?(o=!0,function(e,t,n,r,i){(0,A[e])({queryParams:t,changeEvent:n,previousResults:r,keyDocumentMap:i})}(t,n,e,r,i),!1):void 0)}));return s?{runFullQueryAgain:!0}:{runFullQueryAgain:!1,changed:o,newResults:r}}var me=n(361),ye=n(5872),ve=function(){function e(e,t,n){this.time=(0,v.z)(),this.collection=e,this.count=n,this.documents=(0,ye.B)(this.collection._docCache,t)}return(0,r.Z)(e,[{key:"docsData",get:function(){return(0,w.IK)(this,"docsData",this.documents.map((e=>e._data)))}},{key:"docsDataMap",get:function(){var e=new Map;return this.documents.forEach((t=>{e.set(t.primary,t._data)})),(0,w.IK)(this,"docsDataMap",e)}},{key:"docsMap",get:function(){for(var e=new Map,t=this.documents,n=0;n<t.length;n++){var r=t[n];e.set(r.primary,r)}return(0,w.IK)(this,"docsMap",e)}}]),e}(),ge=0,be=function(){function e(e,t,n,r={}){this.id=++ge,this._execOverDatabaseCount=0,this._creationTime=(0,v.z)(),this._lastEnsureEqual=0,this.uncached=!1,this.refCount$=new i.X(null),this._result=null,this._latestChangeEvent=-1,this._lastExecStart=0,this._lastExecEnd=0,this._ensureEqualQueue=g.kZ,this.op=e,this.mangoQuery=t,this.collection=n,this.other=r,t||(this.mangoQuery={selector:{}}),this.isFindOneByIdQuery=function(e,t){if(!t.skip&&t.selector&&1===Object.keys(t.selector).length&&t.selector[e]){var n=t.selector[e];if("string"==typeof n)return n;if(1===Object.keys(n).length&&"string"==typeof n.$eq)return n.$eq;if(1===Object.keys(n).length&&Array.isArray(n.$eq)&&!n.$eq.find((e=>"string"!=typeof e)))return n.$eq}return!1}(this.collection.schema.primaryPath,t)}var t=e.prototype;return t._setResultData=function(e){if("number"!=typeof e){e instanceof Map&&(e=Array.from(e.values()));var t=new ve(this.collection,e,e.length);this._result=t}else this._result=new ve(this.collection,[],e)},t._execOverDatabase=async function(){if(this._execOverDatabaseCount=this._execOverDatabaseCount+1,this._lastExecStart=(0,v.z)(),"count"===this.op){var e=this.getPreparedQuery(),t=await this.collection.storageInstance.count(e);if("slow"!==t.mode||this.collection.database.allowSlowCount)return t.count;throw(0,S.f3)("QU14",{collection:this.collection,queryObj:this.mangoQuery})}if("findByIds"===this.op){var n=(0,b.Is)(this.mangoQuery.selector)[this.collection.schema.primaryPath].$in,r=new Map,i=[];if(n.forEach((e=>{var t=this.collection._docCache.getLatestDocumentDataIfExists(e);if(t){if(!t._deleted){var n=this.collection._docCache.getCachedRxDocument(t);r.set(e,n)}}else i.push(e)})),i.length>0)(await this.collection.storageInstance.findDocumentsById(i,!1)).forEach((e=>{var t=this.collection._docCache.getCachedRxDocument(e);r.set(t.primary,t)}));return r}var o=async function(e){var t=[],n=e.collection;if(e.isFindOneByIdQuery)if(Array.isArray(e.isFindOneByIdQuery)){var r=e.isFindOneByIdQuery;if(r=r.filter((n=>{var r=e.collection._docCache.getLatestDocumentDataIfExists(n);return!r||(r._deleted||t.push(r),!1)})),r.length>0){var i=await n.storageInstance.findDocumentsById(r,!1);(0,k.gu)(t,i)}}else{var o=e.isFindOneByIdQuery,s=e.collection._docCache.getLatestDocumentDataIfExists(o);if(!s){var a=await n.storageInstance.findDocumentsById([o],!1);a[0]&&(s=a[0])}s&&!s._deleted&&t.push(s)}else{var c=e.getPreparedQuery(),u=await n.storageInstance.query(c);t=u.documents}return t}(this);return o.then((e=>(this._lastExecEnd=(0,v.z)(),e)))},t.exec=function(e){if(e&&"findOne"!==this.op)throw(0,S.f3)("QU9",{collection:this.collection.name,query:this.mangoQuery,op:this.op});return ke(this).then((()=>(0,o.z)(this.$))).then((t=>{if(!t&&e)throw(0,S.f3)("QU10",{collection:this.collection.name,query:this.mangoQuery,op:this.op});return t}))},t.toString=function(){var e=(0,w.CV)({op:this.op,query:this.mangoQuery,other:this.other},!0),t=JSON.stringify(e);return this.toString=()=>t,t},t.getPreparedQuery=function(){var e={rxQuery:this,mangoQuery:(0,he.tN)(this.collection.schema.jsonSchema,this.mangoQuery)};(0,x.Cb)("prePrepareQuery",e);var t=this.collection.database.storage.statics.prepareQuery(this.collection.schema.jsonSchema,e.mangoQuery);return this.getPreparedQuery=()=>t,t},t.doesDocumentDataMatch=function(e){return!e._deleted&&this.queryMatcher(e)},t.remove=function(){return this.exec().then((e=>Array.isArray(e)?Promise.all(e.map((e=>e.remove()))):e.remove()))},t.update=function(e){throw(0,_.k)("update")},t.where=function(e){throw(0,_.k)("query-builder")},t.sort=function(e){throw(0,_.k)("query-builder")},t.skip=function(e){throw(0,_.k)("query-builder")},t.limit=function(e){throw(0,_.k)("query-builder")},(0,r.Z)(e,[{key:"$",get:function(){if(!this._$){var e=this.collection.$.pipe((0,h.h)((e=>!e.isLocal)),(0,d.O)(null),(0,f.z)((()=>ke(this))),(0,p.U)((()=>this._result)),(0,m.d)(b.kv),(0,y.x)(((e,t)=>!(!e||e.time!==(0,b.Is)(t).time))),(0,h.h)((e=>!!e)),(0,p.U)((e=>{var t=(0,b.Is)(e);return"count"===this.op?t.count:"findOne"===this.op?0===t.documents.length?null:t.documents[0]:"findByIds"===this.op?t.docsMap:t.documents.slice(0)})));this._$=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=(0,u.yG)(e),r=(0,u._6)(e,1/0),i=e;return i.length?1===i.length?(0,a.Xf)(i[0]):(0,s.J)(r)((0,l.D)(i,n)):c}(e,this.refCount$.pipe((0,h.h)((()=>!1))))}return this._$}},{key:"queryMatcher",get:function(){var e=this.collection.schema.jsonSchema,t=(0,he.tN)(this.collection.schema.jsonSchema,this.mangoQuery);return(0,w.IK)(this,"queryMatcher",(0,he.VL)(e,t))}},{key:"asRxQuery",get:function(){return this}}]),e}();function we(){return{selector:{}}}function _e(e,t,n,r){(0,x.Cb)("preCreateRxQuery",{op:e,queryObj:t,collection:n,other:r});var i,o=new be(e,t,n,r);return o=(i=o).collection._queryCache.getByQuery(i),(0,me.vT)(n),o}function Ee(e){var t=e.asRxQuery.collection._changeEventBuffer.counter;return e._latestChangeEvent>=t}function ke(e){return e.collection.database.destroyed||Ee(e)?g.kZ:(e._ensureEqualQueue=e._ensureEqualQueue.then((()=>function(e){if(e._lastEnsureEqual=(0,v.z)(),e.collection.database.destroyed||Ee(e))return g.kZ;var t=!1,n=!1;-1===e._latestChangeEvent&&(n=!0);if(!n){var r=e.asRxQuery.collection._changeEventBuffer.getFrom(e._latestChangeEvent+1);if(null===r)n=!0;else{e._latestChangeEvent=e.asRxQuery.collection._changeEventBuffer.counter;var i=e.asRxQuery.collection._changeEventBuffer.reduceByLastOfDoc(r);if("count"===e.op){var o=(0,b.Is)(e._result).count,s=o;i.forEach((t=>{var n=t.previousDocumentData&&e.doesDocumentDataMatch(t.previousDocumentData),r=e.doesDocumentDataMatch(t.documentData);!n&&r&&s++,n&&!r&&s--})),s!==o&&(t=!0,e._setResultData(s))}else{var a=pe(e,i);a.runFullQueryAgain?n=!0:a.changed&&(t=!0,e._setResultData(a.newResults))}}}if(n)return e._execOverDatabase().then((n=>(e._latestChangeEvent=e.collection._changeEventBuffer.counter,"number"==typeof n?(e._result&&n===e._result.count||(t=!0,e._setResultData(n)),t):(e._result&&(0,E.Oy)(e.collection.schema.primaryPath,n,e._result.docsData)||(t=!0,e._setResultData(n)),t))));return Promise.resolve(t)}(e))),e._ensureEqualQueue)}},9300:(e,t,n)=>{"use strict";n.d(t,{ui:()=>w,QC:()=>b,Oq:()=>h,El:()=>y,r$:()=>p,Qu:()=>g,Mb:()=>f,CT:()=>d,_F:()=>l,B:()=>m});var r=n(109),i=/\./g,o=n(5618),s=n(7475),a=n(5688),c=n(1462),u=n(3333);function l(e,t){var n=t;return n="properties."+(n=n.replace(i,".properties.")),n=(0,o.Ny)(n),(0,s.$s)(e,n)}function h(e,t,n){if("string"==typeof t.primaryKey)return n;var i=p(t,n),o=n[e];if(o&&o!==i)throw(0,r.f3)("DOC19",{args:{documentData:n,existingPrimary:o,newPrimary:i},schema:t});return n[e]=i,n}function d(e){return"string"==typeof e?e:e.key}function f(e){var t=l(e,d(e.primaryKey));return(0,a.Is)(t.maxLength)}function p(e,t){if("string"==typeof e.primaryKey)return t[e.primaryKey];var n=e.primaryKey;return n.fields.map((e=>{var n=(0,s.$s)(t,e);if(void 0===n)throw(0,r.f3)("DOC18",{args:{field:e,documentData:t}});return n})).join(n.separator)}function m(e){return(0,c.CV)(e,!0)}function y(e){var t=d((e=(0,c.qu)(e)).primaryKey);e.properties=(0,c.qu)(e.properties),e.additionalProperties=!1,e.hasOwnProperty("keyCompression")||(e.keyCompression=!1),e.indexes=e.indexes?e.indexes.slice(0):[],e.required=e.required?e.required.slice(0):[],e.encrypted=e.encrypted?e.encrypted.slice(0):[],e.properties._rev={type:"string",minLength:1},e.properties._attachments={type:"object"},e.properties._deleted={type:"boolean"},e.properties._meta=v,e.required=e.required?e.required.slice(0):[],e.required.push("_deleted"),e.required.push("_rev"),e.required.push("_meta"),e.required.push("_attachments");var n=g(e);return(0,u.gu)(e.required,n),e.required=e.required.filter((e=>!e.includes("."))).filter(((e,t,n)=>n.indexOf(e)===t)),e.version=e.version||0,e.indexes&&(e.indexes=e.indexes.map((e=>{var n=(0,u.AD)(e)?e.slice(0):[e];if(!n.includes(t)){var r=n.slice(0);return r.push(t),r}return n}))),e}var v={type:"object",properties:{lwt:{type:"number",minimum:n(6069).aA,maximum:1e15,multipleOf:.01}},additionalProperties:!0,required:["lwt"]};function g(e){var t=Object.keys(e.properties).filter((t=>e.properties[t].final)),n=d(e.primaryKey);return t.push(n),"string"!=typeof e.primaryKey&&e.primaryKey.fields.forEach((e=>t.push(e))),t}function b(e,t){for(var n=Object.keys(e.defaultValues),r=0;r<n.length;++r){var i=n[r];t.hasOwnProperty(i)&&void 0!==t[i]||(t[i]=e.defaultValues[i])}return t}var w={type:"object",properties:{id:{type:"string"},lwt:{type:"number"}},required:["id","lwt"],additionalProperties:!1}},8316:(e,t,n)=>{"use strict";n.d(t,{$I:()=>d,Dw:()=>f,os:()=>h});var r=n(1656),i=n(1858),o=n(1462),s=n(3333),a=n(109),c=n(8655),u=n(9300),l=n(442),h=function(){function e(e,t){this.jsonSchema=e,this.hashFunction=t,this.indexes=function(e){return(e.indexes||[]).map((e=>(0,s.AD)(e)?e:[e]))}(this.jsonSchema),this.primaryPath=(0,u.CT)(this.jsonSchema.primaryKey),this.finalFields=(0,u.Qu)(this.jsonSchema)}var t=e.prototype;return t.validateChange=function(e,t){this.finalFields.forEach((n=>{if(!(0,i.v)(e[n],t[n]))throw(0,a.f3)("DOC9",{dataBefore:e,dataAfter:t,fieldName:n,schema:this.jsonSchema})}))},t.getDocumentPrototype=function(){var e={},t=(0,u._F)(this.jsonSchema,"");return Object.keys(t).forEach((t=>{var n=t;e.__defineGetter__(t,(function(){if(this.get&&"function"==typeof this.get)return this.get(n)})),Object.defineProperty(e,t+"$",{get:function(){return this.get$(n)},enumerable:!1,configurable:!1}),Object.defineProperty(e,t+"_",{get:function(){return this.populate(n)},enumerable:!1,configurable:!1})})),(0,o.IK)(this,"getDocumentPrototype",(()=>e)),e},t.getPrimaryOfDocumentData=function(e){return(0,u.r$)(this.jsonSchema,e)},(0,r.Z)(e,[{key:"version",get:function(){return this.jsonSchema.version}},{key:"defaultValues",get:function(){var e={};return Object.entries(this.jsonSchema.properties).filter((([,e])=>e.hasOwnProperty("default"))).forEach((([t,n])=>e[t]=n.default)),(0,o.IK)(this,"defaultValues",e)}},{key:"hash",get:function(){return(0,o.IK)(this,"hash",this.hashFunction(JSON.stringify(this.jsonSchema)))}}]),e}();function d(e){var t=e.version?e.version:0,n=0;return new Array(t).fill(0).map((()=>n++))}function f(e,t,n=!0){n&&(0,c.Cb)("preCreateRxSchema",e);var r=(0,u.El)(e);r=(0,u.B)(r),l.j.deepFreezeWhenDevMode(r);var i=new h(r,t);return(0,c.Cb)("createRxSchema",i),i}},8497:(e,t,n)=>{"use strict";n.d(t,{DF:()=>b,DZ:()=>f,GT:()=>k,OR:()=>x,OW:()=>m,T_:()=>g,_$:()=>E,cN:()=>v,nR:()=>S,ov:()=>p,vI:()=>_,xf:()=>y});var r=n(442),i=n(109),o=n(9300),s=n(5618),a=n(6493),c=n(5688),u=n(1462),l=n(327),h=n(3333),d=n(6069),f="_rxdb_internal";async function p(e,t){var n=(await e.findDocumentsById([t],!1))[0];return n||void 0}async function m(e,t,n){var r=await e.bulkWrite([t],n);if(r.error.length>0)throw r.error[0];return r.success[0]}function y(e){return Object.assign({},...e)}function v(e,t,n){var i=t.documentData,o=t.previousDocumentData;return{documentId:t.documentId,collectionName:n?n.name:void 0,isLocal:e,operation:t.operation,documentData:r.j.deepFreezeWhenDevMode(i),previousDocumentData:r.j.deepFreezeWhenDevMode(o)}}function g(e,t,n,r){if(r)throw 409===r.status?(0,i.f3)("CONFLICT",{collection:e.name,id:t,writeError:r,data:n}):422===r.status?(0,i.f3)("VD2",{collection:e.name,id:t,writeError:r,data:n}):r}function b(e,t,n,r,o,u,l){for(var h,d=!!e.schema.attachments,f=[],p=[],m=[],y={id:(0,s.sc)(10),events:[],checkpoint:null,context:o,startTime:(0,a.z)(),endTime:0},v=y.events,g=[],b=[],E=[],k=n.size>0,S=r.length,x=function(){var e,o=r[C],s=o.document,a=o.previous,y=s[t],S=s._deleted,x=a&&a._deleted,O=void 0;if(k&&(O=n.get(y)),O){var R=O._rev;if(!a||a&&R!==a._rev){var I={isError:!0,status:409,documentId:y,writeRow:o,documentInDb:O};return m.push(I),1}var P=d?w(o):o;d&&(S?a&&Object.keys(a._attachments).forEach((e=>{b.push({documentId:y,attachmentId:e,digest:(0,c.Is)(a)._attachments[e].digest})})):(Object.entries(s._attachments).find((([t,n])=>((a?a._attachments[t]:void 0)||n.data||(e={documentId:y,documentInDb:O,isError:!0,status:510,writeRow:o,attachmentId:t}),!0))),e||Object.entries(s._attachments).forEach((([e,t])=>{var n=a?a._attachments[e]:void 0;if(n){var r=P.document._attachments[e].digest;t.data&&n.digest!==r&&E.push({documentId:y,attachmentId:e,attachmentData:t,digest:t.digest})}else g.push({documentId:y,attachmentId:e,attachmentData:t,digest:t.digest})})))),e?m.push(e):(d?(p.push(w(P)),l&&l(s)):(p.push(P),l&&l(s)),h=P);var D=null,T=null,A=null;if(x&&!S)A="INSERT",D=d?_(s):s;else if(!a||x||S){if(!S)throw(0,i.f3)("SNH",{args:{writeRow:o}});A="DELETE",D=(0,c.Is)(s),T=a}else A="UPDATE",D=d?_(s):s,T=a;var j={documentId:y,documentData:D,previousDocumentData:T,operation:A};v.push(j)}else{var M=!!S;if(d&&Object.entries(s._attachments).forEach((([t,n])=>{n.data?g.push({documentId:y,attachmentId:t,attachmentData:n,digest:n.digest}):(e={documentId:y,isError:!0,status:510,writeRow:o,attachmentId:t},m.push(e))})),e||(d?(f.push(w(o)),u&&u(s)):(f.push(o),u&&u(s)),h=o),!M){var N={documentId:y,operation:"INSERT",documentData:d?_(s):s,previousDocumentData:d&&a?_(a):a};v.push(N)}}},C=0;C<S;C++)x();return{bulkInsertDocs:f,bulkUpdateDocs:p,newestRow:h,errors:m,eventBulk:y,attachmentsAdd:g,attachmentsRemove:b,attachmentsUpdate:E}}function w(e){return{previous:e.previous,document:_(e.document)}}function _(e){if(!e._attachments||0===Object.keys(e._attachments).length)return e;var t=(0,u.qu)(e);return t._attachments={},Object.entries(e._attachments).forEach((([e,n])=>{var r,i,o;t._attachments[e]=(o=(r=n).data)?{length:(i=o,atob(i).length),digest:r.digest,type:r.type}:r})),t}function E(e){var t=(0,u.qu)(e);return t._meta=(0,u.qu)(e._meta),t}function k(e,t,n){r.j.deepFreezeWhenDevMode(n);var s=(0,o.CT)(n.primaryKey);var f={originalStorageInstance:t,schema:t.schema,internals:t.internals,collectionName:t.collectionName,databaseName:t.databaseName,options:t.options,bulkWrite(d,f){var p=d.map((c=>function(c){var h=(0,u.qu)(c.document);if(h._meta=(0,u.qu)(h._meta),r.j.isDevMode()){h=(0,o.Oq)(s,n,h);try{"function"==typeof structuredClone?structuredClone(c):JSON.parse(JSON.stringify(c))}catch(e){throw(0,i.f3)("DOC24",{collection:t.collectionName,document:c.document})}c.previous,c.previous&&Object.keys(c.previous._meta).forEach((e=>{if(!c.document._meta.hasOwnProperty(e))throw(0,i.f3)("SNH",{dataBefore:c.previous,dataAfter:c.document})}))}return h._meta.lwt=(0,a.z)(),h._rev=(0,l.Zo)(e.token,c.previous),{document:h,previous:c.previous}}(c)));return e.lockedRun((()=>t.bulkWrite(p,f))).then((n=>{var r={error:[],success:n.success.slice(0)},i=n.error.filter((e=>!(409!==e.status||e.writeRow.previous||e.writeRow.document._deleted||!(0,c.Is)(e.documentInDb)._deleted)||(r.error.push(e),!1)));if(i.length>0){var o=i.map((t=>({previous:t.documentInDb,document:Object.assign({},t.writeRow.document,{_rev:(0,l.Zo)(e.token,t.documentInDb)})})));return e.lockedRun((()=>t.bulkWrite(o,f))).then((e=>((0,h.gu)(r.error,e.error),(0,h.gu)(r.success,e.success),r)))}return n}))},query:n=>e.lockedRun((()=>t.query(n))),count:n=>e.lockedRun((()=>t.count(n))),info:()=>e.lockedRun((()=>t.info())),findDocumentsById:(n,r)=>e.lockedRun((()=>t.findDocumentsById(n,r))),getAttachmentData:(n,r,i)=>e.lockedRun((()=>t.getAttachmentData(n,r,i))),getChangedDocumentsSince:(n,r)=>e.lockedRun((()=>t.getChangedDocumentsSince((0,c.Is)(n),r))),cleanup:n=>e.lockedRun((()=>t.cleanup(n))),remove:()=>(e.storageInstances.delete(f),e.lockedRun((()=>t.remove()))),close:()=>(e.storageInstances.delete(f),e.lockedRun((()=>t.close()))),changeStream:()=>t.changeStream(),conflictResultionTasks:()=>t.conflictResultionTasks(),resolveConflictResultionTask(e){if(e.output.isEqual)return t.resolveConflictResultionTask(e);var n=Object.assign({},e.output.documentData,{_meta:(0,d.dy)(),_rev:(0,d.i1)(),_attachments:{}}),r=(0,u.qu)(n);return delete r._meta,delete r._rev,delete r._attachments,t.resolveConflictResultionTask({id:e.id,output:{isEqual:!1,documentData:r}})}};return e.storageInstances.add(f),f}function S(e){if(e.schema.keyCompression)throw(0,i.f3)("UT5",{args:{params:e}});if(x(e.schema))throw(0,i.f3)("UT6",{args:{params:e}});if(e.schema.attachments&&e.schema.attachments.compression)throw(0,i.f3)("UT7",{args:{params:e}})}function x(e){return!!(e.encrypted&&e.encrypted.length>0||e.attachments&&e.attachments.encrypted)}},7582:(e,t,n)=>{"use strict";n.d(t,{CR:()=>c,FC:()=>h,Jh:()=>s,KL:()=>d,XA:()=>a,ZT:()=>i,ev:()=>u,mG:()=>o,qq:()=>l});var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)};function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}function o(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{c(r.next(e))}catch(e){o(e)}}function a(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))}function s(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(c){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(s=0)),s;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,r=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}}Object.create;function a(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function c(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s}function u(e,t,n){if(n||2===arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))}function l(e){return this instanceof l?(this.v=e,this):new l(e)}function h(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=n.apply(e,t||[]),o=[];return r={},s("next"),s("throw"),s("return"),r[Symbol.asyncIterator]=function(){return this},r;function s(e){i[e]&&(r[e]=function(t){return new Promise((function(n,r){o.push([e,t,n,r])>1||a(e,t)}))})}function a(e,t){try{(n=i[e](t)).value instanceof l?Promise.resolve(n.value.v).then(c,u):h(o[0][2],n)}catch(e){h(o[0][3],e)}var n}function c(e){a("next",e)}function u(e){a("throw",e)}function h(e,t){e(t),o.shift(),o.length&&a(o[0][0],o[0][1])}}function d(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=a(e),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(n){t[n]=e[n]&&function(t){return new Promise((function(r,i){(function(e,t,n,r){Promise.resolve(r).then((function(t){e({value:t,done:n})}),t)})(r,i,(t=e[n](t)).done,t.value)}))}}}Object.create;"function"==typeof SuppressedError&&SuppressedError}},r={};function i(e){var t=r[e];if(void 0!==t)return t.exports;var o=r[e]={exports:{}};return n[e].call(o.exports,o,o.exports,i),o.exports}i.m=n,i.d=(e,t)=>{for(var n in t)i.o(t,n)&&!i.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},i.f={},i.e=e=>Promise.all(Object.keys(i.f).reduce(((t,n)=>(i.f[n](e,t),t)),[])),i.u=e=>({631:"1d891c4a9126871ed952",651:"51743b380ecd45e506d8"}[e]+".bundle.js"),i.miniCssF=e=>{},i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),e={},t="rxdb-quickstart:",i.l=(n,r,o,s)=>{if(e[n])e[n].push(r);else{var a,c;if(void 0!==o)for(var u=document.getElementsByTagName("script"),l=0;l<u.length;l++){var h=u[l];if(h.getAttribute("src")==n||h.getAttribute("data-webpack")==t+o){a=h;break}}a||(c=!0,(a=document.createElement("script")).charset="utf-8",a.timeout=120,i.nc&&a.setAttribute("nonce",i.nc),a.setAttribute("data-webpack",t+o),a.src=n),e[n]=[r];var d=(t,r)=>{a.onerror=a.onload=null,clearTimeout(f);var i=e[n];if(delete e[n],a.parentNode&&a.parentNode.removeChild(a),i&&i.forEach((e=>e(r))),t)return t(r)},f=setTimeout(d.bind(null,void 0,{type:"timeout",target:a}),12e4);a.onerror=d.bind(null,a.onerror),a.onload=d.bind(null,a.onload),c&&document.head.appendChild(a)}},i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e;i.g.importScripts&&(e=i.g.location+"");var t=i.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var n=t.getElementsByTagName("script");if(n.length)for(var r=n.length-1;r>-1&&!e;)e=n[r--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),i.p=e})(),(()=>{var e={179:0};i.f.j=(t,n)=>{var r=i.o(e,t)?e[t]:void 0;if(0!==r)if(r)n.push(r[2]);else{var o=new Promise(((n,i)=>r=e[t]=[n,i]));n.push(r[2]=o);var s=i.p+i.u(t),a=new Error;i.l(s,(n=>{if(i.o(e,t)&&(0!==(r=e[t])&&(e[t]=void 0),r)){var o=n&&("load"===n.type?"missing":n.type),s=n&&n.target&&n.target.src;a.message="Loading chunk "+t+" failed.\n("+o+": "+s+")",a.name="ChunkLoadError",a.type=o,a.request=s,r[1](a)}}),"chunk-"+t,t)}};var t=(t,n)=>{var r,o,[s,a,c]=n,u=0;if(s.some((t=>0!==e[t]))){for(r in a)i.o(a,r)&&(i.m[r]=a[r]);if(c)c(i)}for(t&&t(n);u<s.length;u++)o=s[u],i.o(e,o)&&e[o]&&e[o][0](),e[o]=0},n=self.webpackChunkrxdb_quickstart=self.webpackChunkrxdb_quickstart||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})(),(()=>{"use strict";var e=i(5618),t=i(5688),n=i(8316),r=i(4176),o=i(5453),s=i(4727),a=i(9161),c=i(442),u=i(8655),l=i(109),h={RxSchema:n.os.prototype,RxDocument:r.kJ,RxQuery:o.OX.prototype,RxCollection:s.Ko.prototype,RxDatabase:a.s2.prototype},d=new Set,f=new Set;function p(e){if((0,u.Cb)("preAddRxPlugin",{plugin:e,plugins:d}),!d.has(e)){if(f.has(e.name))throw(0,l.f3)("PL3",{name:e.name,plugin:e});if(d.add(e),f.add(e.name),!e.rxdb)throw(0,l.zU)("PL1",{plugin:e});e.init&&e.init(),e.prototypes&&Object.entries(e.prototypes).forEach((([e,t])=>t(h[e]))),e.overwritable&&Object.assign(c.j,e.overwritable),e.hooks&&Object.entries(e.hooks).forEach((([e,t])=>{t.after&&u.cF[e].push(t.after),t.before&&u.cF[e].unshift(t.before)}))}}var m=i(4369),y=i(7351),v=i(1858),g=i(4975),b=i(9127),w=i(6515),_=i(6716),E=i(7795),k=i(1480),S=Array.isArray,x=Object.getPrototypeOf,C=Object.prototype,O=Object.keys;function R(e){if(1===e.length){var t=e[0];if(S(t))return{args:t,keys:null};if((r=t)&&"object"==typeof r&&x(r)===C){var n=O(t);return{args:n.map((function(e){return t[e]})),keys:n}}}var r;return{args:e,keys:null}}var I=i(1954),P=i(278),D=i(7582),T=Array.isArray;function A(e){return(0,b.U)((function(t){return function(e,t){return T(t)?e.apply(void 0,(0,D.ev)([],(0,D.CR)(t))):e(t)}(e,t)}))}var j=i(7617);var M=i(2566),N=i(7845);function L(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=(0,j.yG)(e),r=(0,j.jO)(e),i=R(e),o=i.args,s=i.keys;if(0===o.length)return(0,I.D)([],n);var a=new k.y(function(e,t,n){void 0===n&&(n=P.y);return function(r){B(t,(function(){for(var i=e.length,o=new Array(i),s=i,a=i,c=function(i){B(t,(function(){var c=(0,I.D)(e[i],t),u=!1;c.subscribe((0,M.x)(r,(function(e){o[i]=e,u||(u=!0,a--),a||r.next(n(o.slice()))}),(function(){--s||r.complete()})))}),r)},u=0;u<i;u++)c(u)}),r)}}(o,n,s?function(e){return function(e,t){return e.reduce((function(e,n,r){return e[n]=t[r],e}),{})}(s,e)}:P.y));return r?a.pipe(A(r)):a}function B(e,t,n){e?(0,N.f)(n,e,t):t()}var F=i(7877),$=i(9300),q=i(1462),K=i(5052),U=i(8497),W=i(6069),z=i(6493),H=i(327);async function Q(e,t){var n=(0,$.r$)(e.input.metaInstance.schema,{isCheckpoint:"1",itemId:t}),r=(await e.input.metaInstance.findDocumentsById([n],!1))[0];return e.lastCheckpointDoc[t]=r,r?r.checkpointData:void 0}async function V(e,n,r){e.checkpointQueue=e.checkpointQueue.then((async()=>{var i=e.lastCheckpointDoc[n];if(r&&!e.events.canceled.getValue()&&(!i||JSON.stringify(i.checkpointData)!==JSON.stringify(r))){var o={id:"",isCheckpoint:"1",itemId:n,_deleted:!1,_attachments:{},checkpointData:r,_meta:(0,W.dy)(),_rev:(0,W.i1)()};for(o.id=(0,$.r$)(e.input.metaInstance.schema,o);!e.events.canceled.getValue();){if(i&&(o.checkpointData=(0,U.xf)([i.checkpointData,o.checkpointData])),o._meta.lwt=(0,z.z)(),o._rev=(0,H.Zo)(await e.checkpointKey,i),e.events.canceled.getValue())return;var s=await e.input.metaInstance.bulkWrite([{previous:i,document:o}],"replication-set-checkpoint"),a=s.success[0];if(a)return void(e.lastCheckpointDoc[n]=a);var c=s.error[0];if(409!==c.status)throw c;i=(0,t.Is)(c.documentInDb),o._rev=(0,H.Zo)(await e.checkpointKey,i)}}})),await e.checkpointQueue}var Y=i(3333);function G(e,t,n,r,i){var o=Object.assign({},r,{_attachments:t&&r._attachments?r._attachments:{},_meta:n?r._meta:{lwt:(0,z.z)()},_rev:n?r._rev:(0,W.i1)()});return o._rev||(o._rev=(0,H.Zo)(e,i)),o}function J(e,t,n){var r=(0,q.qu)(e);return t||delete r._attachments,n||(delete r._meta,delete r._rev),r}function Z(e,t){return e.hasAttachments?t.map((e=>{var t=(0,q.d9)(e.document);return t.docData=(0,U.vI)(t.docData),{document:t,previous:e.previous}})):t}function X(e){for(;;){if(!e.underlyingPersistentStorage)return e;e=e.underlyingPersistentStorage}}function ee(e,t){return e.input.metaInstance.findDocumentsById(t.map((t=>(0,$.r$)(e.input.metaInstance.schema,{itemId:t,isCheckpoint:"0"}))),!0).then((e=>{var t={};return Object.values(e).forEach((e=>{t[e.itemId]={docData:e.docData,metaDocument:e}})),t}))}async function te(e,t,n,r){var i=t[e.primaryPath],o=n?(0,U._$)(n):{id:"",isCheckpoint:"0",itemId:i,docData:t,_attachments:{},_deleted:!1,_rev:(0,W.i1)(),_meta:{lwt:0}};return o.docData=t,o.isResolvedConflict=r,o._meta.lwt=(0,z.z)(),o.id=(0,$.r$)(e.input.metaInstance.schema,o),o._rev=(0,H.Zo)(await e.checkpointKey,n),{previous:n,document:o}}async function ne(e){e.input.initialCheckpoint&&e.input.initialCheckpoint.downstream&&(await Q(e,"down")||await V(e,"down",e.input.initialCheckpoint.downstream));var n=await e.input.hashFunction(e.input.identifier),r=e.input.replicationHandler,i=0,o=[];function s(n){e.stats.down.addNewTask=e.stats.down.addNewTask+1;var s={time:i++,task:n};o.push(s),e.streamQueue.down=e.streamQueue.down.then((()=>{for(var n=[];o.length>0;){e.events.active.down.next(!0);var s=(0,t.Is)(o.shift());if(!(s.time<c)){if("RESYNC"===s.task){if(0===n.length){n.push(s.task);break}break}n.push(s.task)}}if(0!==n.length)return"RESYNC"===n[0]?async function(){if(e.stats.down.downstreamResyncOnce=e.stats.down.downstreamResyncOnce+1,e.events.canceled.getValue())return;e.checkpointQueue=e.checkpointQueue.then((()=>Q(e,"down")));var t=await e.checkpointQueue,n=[];for(;!e.events.canceled.getValue();){c=i++;var o=await r.masterChangesSince(t,e.input.pullBatchSize);if(0===o.documents.length)break;if(t=(0,U.xf)([t,o.checkpoint]),n.push(d(o.documents,t)),o.documents.length<e.input.pullBatchSize)break}await Promise.all(n)}():function(n){e.stats.down.downstreamProcessChanges=e.stats.down.downstreamProcessChanges+1;var r=[],i=null;return n.forEach((e=>{if("RESYNC"===e)throw new Error("SNH");(0,Y.gu)(r,e.documents),i=(0,U.xf)([i,e.checkpoint])})),d(r,(0,t.Is)(i))}(n)})).then((()=>{e.events.active.down.next(!1),e.firstSyncDone.down.getValue()||e.events.canceled.getValue()||e.firstSyncDone.down.next(!0)}))}if(s("RESYNC"),!e.events.canceled.getValue()){var a=r.masterChangeStream$.subscribe((t=>{e.stats.down.masterChangeStreamEmit=e.stats.down.masterChangeStreamEmit+1,s(t)}));(0,E.z)(e.events.canceled.pipe((0,g.h)((e=>!!e)))).then((()=>a.unsubscribe()))}var c=-1;var u=K.$Y,h={docs:{}};function d(t,r){var i=e.primaryPath;return e.stats.down.persistFromMaster=e.stats.down.persistFromMaster+1,t.forEach((e=>{var t=e[i];h.docs[t]=e})),h.checkpoint=r,u=u.then((()=>{var t=h.docs;h.docs={};var r=h.checkpoint,o=Object.keys(t);if(e.events.canceled.getValue()||0===o.length)return K.$Y;var s=[],a={},c={},u=[];return Promise.all([e.input.forkInstance.findDocumentsById(o,!0),ee(e,o)]).then((([r,l])=>{var h=new Map;return r.forEach((e=>h.set(e[i],e))),Promise.all(o.map((async r=>{var i=h.get(r),o=i?J(i,e.hasAttachments,!1):void 0,d=t[r],f=l[r];if(f&&i&&f.metaDocument.isResolvedConflict===i._rev)return K.$Y;var p=!(!f||!o)&&await e.input.conflictHandler({realMasterState:f.docData,newDocumentState:o},"downstream-check-if-equal-0").then((e=>e.isEqual));if(!p&&f&&f.docData._rev&&i&&i._meta[e.input.identifier]&&(0,H.Tz)(i._rev).height===i._meta[e.input.identifier]&&(p=!0),i&&f&&!1===p||i&&!f)return K.$Y;var m=!!o&&await e.input.conflictHandler({realMasterState:d,newDocumentState:o},"downstream-check-if-equal-1").then((e=>e.isEqual));if(o&&m)return f&&!1!==p||u.push(await te(e,o,f?f.metaDocument:void 0)),K.$Y;var y=Object.assign({},d,i?{_meta:(0,q.qu)(i._meta),_attachments:e.hasAttachments&&d._attachments?d._attachments:{},_rev:(0,W.i1)()}:{_meta:{lwt:(0,z.z)()},_rev:(0,W.i1)(),_attachments:e.hasAttachments&&d._attachments?d._attachments:{}});if(d._rev){var v=i?(0,H.Tz)(i._rev).height+1:1;y._meta[e.input.identifier]=v,e.input.keepMeta&&(y._rev=d._rev)}e.input.keepMeta&&d._meta&&(y._meta=d._meta);var g={previous:i,document:y};g.document._rev=g.document._rev?g.document._rev:(0,H.Zo)(n,g.previous),s.push(g),a[r]=g,c[r]=await te(e,d,f?f.metaDocument:void 0)})))})).then((async()=>{if(s.length>0)return e.input.forkInstance.bulkWrite(s,await e.downstreamBulkWriteFlag).then((t=>{t.success.forEach((t=>{var n=t[i];e.events.processed.down.next(a[n]),u.push(c[n])})),t.error.forEach((t=>{409!==t.status&&e.events.error.next((0,l.f3)("RC_PULL",{writeError:t}))}))}))})).then((()=>{if(u.length>0)return e.input.metaInstance.bulkWrite(Z(e,u),"replication-down-write-meta").then((t=>{t.error.forEach((t=>{e.events.error.next((0,l.f3)("RC_PULL",{id:t.documentId,writeError:t}))}))}))})).then((()=>{V(e,"down",r)}))})).catch((t=>e.events.error.next(t)))}}var re=i(7429);async function ie(e,n,r,i){if(!r._attachments||i&&!i._attachments)throw new Error("_attachments missing");var o=r[e],s=new Set(i&&i._attachments?Object.keys(i._attachments):[]);return await Promise.all(Object.entries(r._attachments).map((async([e,r])=>{if((!s.has(e)||i&&(0,t.Is)(i._attachments)[e].digest!==r.digest)&&!r.data){var a=await n.getAttachmentData(o,e,r.digest);r.data=a}}))),r}async function oe(e){e.input.initialCheckpoint&&e.input.initialCheckpoint.upstream&&(await Q(e,"up")||await V(e,"up",e.input.initialCheckpoint.upstream));var n=e.input.replicationHandler;e.streamQueue.up=e.streamQueue.up.then((()=>u().then((()=>{l()}))));var r=0,i=-1,o=[],s=K.kZ,a={docs:{}},c=e.input.forkInstance.changeStream().subscribe((async t=>{if(t.context!==await e.downstreamBulkWriteFlag)return e.stats.up.forkChangeStreamEmit=e.stats.up.forkChangeStreamEmit+1,o.push({task:t,time:r++}),e.input.waitBeforePersist?e.input.waitBeforePersist().then((()=>l())):l()}));async function u(){if(e.stats.up.upstreamInitialSync=e.stats.up.upstreamInitialSync+1,!e.events.canceled.getValue()){e.checkpointQueue=e.checkpointQueue.then((()=>Q(e,"up")));for(var n=await e.checkpointQueue,o=new Set,s=async function(){i=r++,o.size>3&&await Promise.race(Array.from(o));var s=await e.input.forkInstance.getChangedDocumentsSince(e.input.pushBatchSize,n);if(0===s.documents.length)return 1;n=(0,U.xf)([n,s.checkpoint]);var a=h(s.documents,(0,t.Is)(n));o.add(a),a.catch().then((()=>o.delete(a)))};!e.events.canceled.getValue()&&!await s(););(await Promise.all(o)).find((e=>!!e))?await u():e.firstSyncDone.up.getValue()||e.events.canceled.getValue()||e.firstSyncDone.up.next(!0)}}function l(){e.events.canceled.getValue()||0===o.length?e.events.active.up.next(!1):(e.stats.up.processTasks=e.stats.up.processTasks+1,e.events.active.up.next(!0),e.streamQueue.up=e.streamQueue.up.then((()=>{for(var n=[],r={};o.length>0;){var s=(0,t.Is)(o.shift());s.time<i||((0,Y.gu)(n,s.task.events.map((e=>e.documentData))),r=(0,U.xf)([r,s.task.checkpoint]))}return(0===n.length?K.kZ:h(n,r)).then((()=>{0===o.length?e.events.active.up.next(!1):l()}))})))}function h(r,i){return e.stats.up.persistToMaster=e.stats.up.persistToMaster+1,r.forEach((t=>{var n=t[e.primaryPath];a.docs[n]=t})),a.checkpoint=i,s=s.then((async()=>{if(e.events.canceled.getValue())return!1;var r=a.docs;a.docs={};var i=a.checkpoint,o=Object.keys(r);if(0===o.length)return!1;var s=await ee(e,o),c={},u=[],l={},h={};if(await Promise.all(o.map((async t=>{var n=r[t];h[t]=n;var i=J(n,e.hasAttachments,!!e.input.keepMeta),o=s[t];o&&o.metaDocument.isResolvedConflict!==n._rev&&(await e.input.conflictHandler({realMasterState:o.docData,newDocumentState:i},"upstream-check-if-equal")).isEqual||o&&o.docData._rev&&(0,H.Tz)(n._rev).height===n._meta[e.input.identifier]||(u.push(t),c[t]={assumedMasterState:o?o.docData:void 0,newDocumentState:i},l[t]=await te(e,i,o?o.metaDocument:void 0))}))),0===u.length)return!1;var d=Object.values(c),f=new Set,p={},m=(0,Y.o_)(d,e.input.pushBatchSize);await Promise.all(m.map((async t=>{e.hasAttachments&&await Promise.all(t.map((async t=>{t.newDocumentState=await ie(e.primaryPath,e.input.forkInstance,(0,q.d9)(t.newDocumentState),t.assumedMasterState)}))),(await n.masterWrite(t)).forEach((t=>{var n=t[e.primaryPath];f.add(n),p[n]=t}))})));var y=[];if(u.forEach((t=>{f.has(t)||(e.events.processed.up.next(c[t]),y.push(l[t]))})),e.events.canceled.getValue())return!1;y.length>0&&await e.input.metaInstance.bulkWrite(Z(e,y),"replication-up-write-meta");var v=!1;if(f.size>0){e.stats.up.persistToMasterHadConflicts=e.stats.up.persistToMasterHadConflicts+1;var g=[],b={};if(await Promise.all(Object.entries(p).map((([n,r])=>{var i=c[n],o={newDocumentState:i.newDocumentState,assumedMasterState:i.assumedMasterState,realMasterState:r};return(0,re.N)(e,o,h[n]).then((async i=>{if(i){e.events.resolvedConflicts.next({input:o,output:i.output}),g.push({previous:h[n],document:i.resolvedDoc});var a=s[n];b[n]=await te(e,(0,t.Is)(r),a?a.metaDocument:void 0,i.resolvedDoc._rev)}}))}))),g.length>0){v=!0,e.stats.up.persistToMasterConflictWrites=e.stats.up.persistToMasterConflictWrites+1;var w=await e.input.forkInstance.bulkWrite(g,"replication-up-write-conflict"),_=[];w.success.forEach((t=>{var n=t[e.primaryPath];_.push(b[n])})),_.length>0&&await e.input.metaInstance.bulkWrite(Z(e,_),"replication-up-write-conflict-meta")}}return V(e,"up",i),v})).catch((t=>(e.events.error.next(t),!1)))}(0,E.z)(e.events.canceled.pipe((0,g.h)((e=>!!e)))).then((()=>c.unsubscribe()))}function se(e){return(0,E.z)(L([e.firstSyncDone.down.pipe((0,g.h)((e=>!!e))),e.firstSyncDone.up.pipe((0,g.h)((e=>!!e)))])).then((()=>{}))}function ae(e){return Promise.all([e.streamQueue.up,e.streamQueue.down,e.checkpointQueue])}var ce=i(1831);Promise.resolve(!1);var ue=Promise.resolve(!0),le=Promise.resolve();function he(e,t){return e||(e=0),new Promise((function(n){return setTimeout((function(){return n(t)}),e)}))}function de(){return Math.random().toString(36).substring(2)}var fe=0;function pe(){var e=1e3*Date.now();return e<=fe&&(e=fe+1),fe=e,e}var me=i(4155);var ye=i(4155),ve="[object process]"===Object.prototype.toString.call(void 0!==ye?ye:0)?function(e){me.on("exit",(function(){return e()})),me.on("beforeExit",(function(){return e().then((function(){return me.exit()}))})),me.on("SIGINT",(function(){return e().then((function(){return me.exit()}))})),me.on("uncaughtException",(function(t){return e().then((function(){console.trace(t),me.exit(101)}))}))}:function(e){if("function"==typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope){var t=self.close.bind(self);self.close=function(){return e(),t()}}else{if("function"!=typeof window.addEventListener)return;window.addEventListener("beforeunload",(function(){e()}),!0),window.addEventListener("unload",(function(){e()}),!0)}},ge=new Set,be=!1;function we(e){if(be||(be=!0,ve(_e)),"function"!=typeof e)throw new Error("Listener is no function");return ge.add(e),{remove:function(){return ge.delete(e)},run:function(){return ge.delete(e),e()}}}function _e(){var e=[];return ge.forEach((function(t){e.push(t()),ge.delete(t)})),Promise.all(e)}function Ee(e,t){var n={context:"leader",action:t,token:e.token};return e.broadcastChannel.postInternal(n)}function ke(e){e.isLeader=!0,e._hasLeader=!0;var t=we((function(){return e.die()}));e._unl.push(t);var n=function(t){"leader"===t.context&&"apply"===t.action&&Ee(e,"tell"),"leader"!==t.context||"tell"!==t.action||e._dpLC||(e._dpLC=!0,e._dpL(),Ee(e,"tell"))};return e.broadcastChannel.addEventListener("internal",n),e._lstns.push(n),Ee(e,"tell")}var Se=function(e,t){var n=this;this.broadcastChannel=e,e._befC.push((function(){return n.die()})),this._options=t,this.isLeader=!1,this.isDead=!1,this.token=de(),this._lstns=[],this._unl=[],this._dpL=function(){},this._dpLC=!1,this._wKMC={},this.lN="pubkey-bc||"+e.method.type+"||"+e.name};Se.prototype={hasLeader:function(){var e=this;return navigator.locks.query().then((function(t){var n=t.held?t.held.filter((function(t){return t.name===e.lN})):[];return!!(n&&n.length>0)}))},awaitLeadership:function(){var e=this;if(!this._wLMP){this._wKMC.c=new AbortController;var t=new Promise((function(t,n){e._wKMC.res=t,e._wKMC.rej=n}));this._wLMP=new Promise((function(n){navigator.locks.request(e.lN,{signal:e._wKMC.c.signal},(function(){return e._wKMC.c=void 0,ke(e),n(),t})).catch((function(){}))}))}return this._wLMP},set onduplicate(e){},die:function(){var e=this;return this._lstns.forEach((function(t){return e.broadcastChannel.removeEventListener("internal",t)})),this._lstns=[],this._unl.forEach((function(e){return e.remove()})),this._unl=[],this.isLeader&&(this.isLeader=!1),this.isDead=!0,this._wKMC.res&&this._wKMC.res(),this._wKMC.c&&this._wKMC.c.abort("LeaderElectionWebLock.die() called"),Ee(this,"death")}};var xe=function(e,t){var n=this;this.broadcastChannel=e,this._options=t,this.isLeader=!1,this._hasLeader=!1,this.isDead=!1,this.token=de(),this._aplQ=le,this._aplQC=0,this._unl=[],this._lstns=[],this._dpL=function(){},this._dpLC=!1;var r=function(e){"leader"===e.context&&("death"===e.action&&(n._hasLeader=!1),"tell"===e.action&&(n._hasLeader=!0))};this.broadcastChannel.addEventListener("internal",r),this._lstns.push(r)};function Ce(e,t){if(e._leaderElector)throw new Error("BroadcastChannel already has a leader-elector");t=function(e,t){return e||(e={}),(e=JSON.parse(JSON.stringify(e))).fallbackInterval||(e.fallbackInterval=3e3),e.responseTime||(e.responseTime=t.method.averageResponseTime(t.options)),e}(t,e);var n="undefined"!=typeof navigator&&void 0!==navigator.locks&&"function"==typeof navigator.locks.request?new Se(e,t):new xe(e,t);return e._befC.push((function(){return n.die()})),e._leaderElector=n,n}xe.prototype={hasLeader:function(){return Promise.resolve(this._hasLeader)},applyOnce:function(e){var t=this;if(this.isLeader)return he(0,!0);if(this.isDead)return he(0,!1);if(this._aplQC>1)return this._aplQ;return this._aplQC=this._aplQC+1,this._aplQ=this._aplQ.then((function(){return function(){if(t.isLeader)return ue;var n,r=!1,i=new Promise((function(e){n=function(){r=!0,e()}})),o=function(e){"leader"===e.context&&e.token!=t.token&&("apply"===e.action&&e.token>t.token&&n(),"tell"===e.action&&(n(),t._hasLeader=!0))};t.broadcastChannel.addEventListener("internal",o);var s=e?4*t._options.responseTime:t._options.responseTime;return Ee(t,"apply").then((function(){return Promise.race([he(s),i.then((function(){return Promise.reject(new Error)}))])})).then((function(){return Ee(t,"apply")})).then((function(){return Promise.race([he(s),i.then((function(){return Promise.reject(new Error)}))])})).catch((function(){})).then((function(){return t.broadcastChannel.removeEventListener("internal",o),!r&&ke(t).then((function(){return!0}))}))}()})).then((function(){t._aplQC=t._aplQC-1})),this._aplQ.then((function(){return t.isLeader}))},awaitLeadership:function(){return this._aLP||(this._aLP=function(e){if(e.isLeader)return le;return new Promise((function(t){var n=!1;function r(){n||(n=!0,e.broadcastChannel.removeEventListener("internal",i),t(!0))}e.applyOnce().then((function(){e.isLeader&&r()})),function t(){return he(e._options.fallbackInterval).then((function(){if(!e.isDead&&!n)return e.isLeader?void r():e.applyOnce(!0).then((function(){e.isLeader?r():t()}))}))}();var i=function(t){"leader"===t.context&&"death"===t.action&&(e._hasLeader=!1,e.applyOnce().then((function(){e.isLeader&&r()})))};e.broadcastChannel.addEventListener("internal",i),e._lstns.push(i)}))}(this)),this._aLP},set onduplicate(e){this._dpL=e},die:function(){var e=this;return this._lstns.forEach((function(t){return e.broadcastChannel.removeEventListener("internal",t)})),this._lstns=[],this._unl.forEach((function(e){return e.remove()})),this._unl=[],this.isLeader&&(this._hasLeader=!1,this.isLeader=!1),this.isDead=!0,Ee(this,"death")}};var Oe=i(6798),Re=Array.isArray;var Ie=i(4367);function Pe(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=(0,j.yG)(e),r=(0,j._6)(e,1/0);return e=function(e){return 1===e.length&&Re(e[0])?e[0]:e}(e),(0,Oe.e)((function(t,i){(0,Ie.J)(r)((0,I.D)((0,D.ev)([t],(0,D.CR)(e)),n)).subscribe(i)}))}var De={create:function(e){var t={time:pe(),messagesCallback:null,bc:new BroadcastChannel(e),subFns:[]};return t.bc.onmessage=function(e){t.messagesCallback&&t.messagesCallback(e.data)},t},close:function(e){e.bc.close(),e.subFns=[]},onMessage:function(e,t){e.messagesCallback=t},postMessage:function(e,t){try{return e.bc.postMessage(t,!1),le}catch(e){return Promise.reject(e)}},canBeUsed:function(){if("undefined"!=typeof globalThis&&globalThis.Deno&&globalThis.Deno.args)return!0;if("undefined"==typeof window&&"undefined"==typeof self||"function"!=typeof BroadcastChannel)return!1;if(BroadcastChannel._pubkey)throw new Error("BroadcastChannel: Do not overwrite window.BroadcastChannel with this module, this is not a polyfill");return!0},type:"native",averageResponseTime:function(){return 150},microSeconds:pe},Te=i(395);function Ae(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=JSON.parse(JSON.stringify(e));return void 0===t.webWorkerSupport&&(t.webWorkerSupport=!0),t.idb||(t.idb={}),t.idb.ttl||(t.idb.ttl=45e3),t.idb.fallbackInterval||(t.idb.fallbackInterval=150),e.idb&&"function"==typeof e.idb.onclose&&(t.idb.onclose=e.idb.onclose),t.localstorage||(t.localstorage={}),t.localstorage.removeTimeout||(t.localstorage.removeTimeout=6e4),e.methods&&(t.methods=e.methods),t.node||(t.node={}),t.node.ttl||(t.node.ttl=12e4),t.node.maxParallelWrites||(t.node.maxParallelWrites=2048),void 0===t.node.useFastPath&&(t.node.useFastPath=!0),t}var je="pubkey.broadcast-channel-0-",Me="messages",Ne={durability:"relaxed"};function Le(){if("undefined"!=typeof indexedDB)return indexedDB;if("undefined"!=typeof window){if(void 0!==window.mozIndexedDB)return window.mozIndexedDB;if(void 0!==window.webkitIndexedDB)return window.webkitIndexedDB;if(void 0!==window.msIndexedDB)return window.msIndexedDB}return!1}function Be(e){e.commit&&e.commit()}function Fe(e,t){var n=e.transaction(Me,"readonly",Ne),r=n.objectStore(Me),i=[],o=IDBKeyRange.bound(t+1,1/0);if(r.getAll){var s=r.getAll(o);return new Promise((function(e,t){s.onerror=function(e){return t(e)},s.onsuccess=function(t){e(t.target.result)}}))}return new Promise((function(e,s){var a=function(){try{return o=IDBKeyRange.bound(t+1,1/0),r.openCursor(o)}catch(e){return r.openCursor()}}();a.onerror=function(e){return s(e)},a.onsuccess=function(r){var o=r.target.result;o?o.value.id<t+1?o.continue(t+1):(i.push(o.value),o.continue()):(Be(n),e(i))}}))}function $e(e){return(t=e.db,n=e.options.idb.ttl,r=Date.now()-n,i=t.transaction(Me,"readonly",Ne),o=i.objectStore(Me),s=[],new Promise((function(e){o.openCursor().onsuccess=function(t){var n=t.target.result;if(n){var o=n.value;o.time<r?(s.push(o),n.continue()):(Be(i),e(s))}else e(s)}}))).then((function(t){return function(e,t){if(e.closed)return Promise.resolve([]);var n=e.db.transaction(Me,"readwrite",Ne).objectStore(Me);return Promise.all(t.map((function(e){var t=n.delete(e);return new Promise((function(e){t.onsuccess=function(){return e()}}))})))}(e,t.map((function(e){return e.id})))}));var t,n,r,i,o,s}function qe(e){e.closed||Ke(e).then((function(){return he(e.options.idb.fallbackInterval)})).then((function(){return qe(e)}))}function Ke(e){return e.closed?le:e.messagesCallback?Fe(e.db,e.lastCursorId).then((function(t){var n=t.filter((function(e){return!!e})).map((function(t){return t.id>e.lastCursorId&&(e.lastCursorId=t.id),t})).filter((function(t){return function(e,t){return!(e.uuid===t.uuid||t.eMIs.has(e.id)||e.data.time<t.messagesCallbackTime)}(t,e)})).sort((function(e,t){return e.time-t.time}));return n.forEach((function(t){e.messagesCallback&&(e.eMIs.add(t.id),e.messagesCallback(t.data))})),le})):le}var Ue={create:function(e,t){return t=Ae(t),function(e){var t=Le(),n=je+e,r=t.open(n);return r.onupgradeneeded=function(e){e.target.result.createObjectStore(Me,{keyPath:"id",autoIncrement:!0})},new Promise((function(e,t){r.onerror=function(e){return t(e)},r.onsuccess=function(){e(r.result)}}))}(e).then((function(n){var r={closed:!1,lastCursorId:0,channelName:e,options:t,uuid:de(),eMIs:new Te.i(2*t.idb.ttl),writeBlockPromise:le,messagesCallback:null,readQueuePromises:[],db:n};return n.onclose=function(){r.closed=!0,t.idb.onclose&&t.idb.onclose()},qe(r),r}))},close:function(e){e.closed=!0,e.db.close()},onMessage:function(e,t,n){e.messagesCallbackTime=n,e.messagesCallback=t,Ke(e)},postMessage:function(e,t){return e.writeBlockPromise=e.writeBlockPromise.then((function(){return function(e,t,n){var r={uuid:t,time:Date.now(),data:n},i=e.transaction([Me],"readwrite",Ne);return new Promise((function(e,t){i.oncomplete=function(){return e()},i.onerror=function(e){return t(e)},i.objectStore(Me).add(r),Be(i)}))}(e.db,e.uuid,t)})).then((function(){var t,n;0===(t=0,n=10,Math.floor(Math.random()*(n-t+1)+t))&&$e(e)})),e.writeBlockPromise},canBeUsed:function(){return!!Le()},type:"idb",averageResponseTime:function(e){return 2*e.idb.fallbackInterval},microSeconds:pe},We="pubkey.broadcastChannel-";function ze(){var e;if("undefined"==typeof window)return null;try{e=window.localStorage,e=window["ie8-eventlistener/storage"]||window.localStorage}catch(e){}return e}function He(e){return We+e}function Qe(){var e=ze();if(!e)return!1;try{var t="__broadcastchannel_check";e.setItem(t,"works"),e.removeItem(t)}catch(e){return!1}return!0}var Ve={create:function(e,t){if(t=Ae(t),!Qe())throw new Error("BroadcastChannel: localstorage cannot be used");var n=de(),r=new Te.i(t.localstorage.removeTimeout),i={channelName:e,uuid:n,eMIs:r};return i.listener=function(e,t){var n=He(e),r=function(e){e.key===n&&t(JSON.parse(e.newValue))};return window.addEventListener("storage",r),r}(e,(function(e){i.messagesCallback&&e.uuid!==n&&e.token&&!r.has(e.token)&&(e.data.time&&e.data.time<i.messagesCallbackTime||(r.add(e.token),i.messagesCallback(e.data)))})),i},close:function(e){var t;t=e.listener,window.removeEventListener("storage",t)},onMessage:function(e,t,n){e.messagesCallbackTime=n,e.messagesCallback=t},postMessage:function(e,t){return new Promise((function(n){he().then((function(){var r=He(e.channelName),i={token:de(),time:Date.now(),data:t,uuid:e.uuid},o=JSON.stringify(i);ze().setItem(r,o);var s=document.createEvent("Event");s.initEvent("storage",!0,!0),s.key=r,s.newValue=o,window.dispatchEvent(s),n()}))}))},canBeUsed:Qe,type:"localstorage",averageResponseTime:function(){var e=navigator.userAgent.toLowerCase();return e.includes("safari")&&!e.includes("chrome")?240:120},microSeconds:pe},Ye=pe,Ge=new Set;var Je={create:function(e){var t={time:Ye(),name:e,messagesCallback:null};return Ge.add(t),t},close:function(e){Ge.delete(e)},onMessage:function(e,t){e.messagesCallback=t},postMessage:function(e,t){return new Promise((function(n){return setTimeout((function(){Array.from(Ge).forEach((function(n){n.name===e.name&&n!==e&&n.messagesCallback&&n.time<t.time&&n.messagesCallback(t)})),n()}),5)}))},canBeUsed:function(){return!0},type:"simulate",averageResponseTime:function(){return 5},microSeconds:Ye},Ze=[De,Ue,Ve];var Xe,et=new Set,tt=0,nt=function(e,t){var n,r,i;this.id=tt++,et.add(this),this.name=e,Xe&&(t=Xe),this.options=Ae(t),this.method=function(e){var t=[].concat(e.methods,Ze).filter(Boolean);if(e.type){if("simulate"===e.type)return Je;var n=t.find((function(t){return t.type===e.type}));if(n)return n;throw new Error("method-type "+e.type+" not found")}e.webWorkerSupport||(t=t.filter((function(e){return"idb"!==e.type})));var r=t.find((function(e){return e.canBeUsed()}));if(r)return r;throw new Error("No usable method found in "+JSON.stringify(Ze.map((function(e){return e.type}))))}(this.options),this._iL=!1,this._onML=null,this._addEL={message:[],internal:[]},this._uMP=new Set,this._befC=[],this._prepP=null,r=(n=this).method.create(n.name,n.options),(i=r)&&"function"==typeof i.then?(n._prepP=r,r.then((function(e){n._state=e}))):n._state=r};function rt(e,t,n){var r={time:e.method.microSeconds(),type:t,data:n};return(e._prepP?e._prepP:le).then((function(){var t=e.method.postMessage(e._state,r);return e._uMP.add(t),t.catch().then((function(){return e._uMP.delete(t)})),t}))}function it(e){return e._addEL.message.length>0||e._addEL.internal.length>0}function ot(e,t,n){e._addEL[t].push(n),function(e){if(!e._iL&&it(e)){var t=function(t){e._addEL[t.type].forEach((function(e){t.time>=e.time&&e.fn(t.data)}))},n=e.method.microSeconds();e._prepP?e._prepP.then((function(){e._iL=!0,e.method.onMessage(e._state,t,n)})):(e._iL=!0,e.method.onMessage(e._state,t,n))}}(e)}function st(e,t,n){e._addEL[t]=e._addEL[t].filter((function(e){return e!==n})),function(e){if(e._iL&&!it(e)){e._iL=!1;var t=e.method.microSeconds();e.method.onMessage(e._state,null,t)}}(e)}nt._pubkey=!0,nt.prototype={postMessage:function(e){if(this.closed)throw new Error("BroadcastChannel.postMessage(): Cannot post message after channel has closed "+JSON.stringify(e));return rt(this,"message",e)},postInternal:function(e){return rt(this,"internal",e)},set onmessage(e){var t={time:this.method.microSeconds(),fn:e};st(this,"message",this._onML),e&&"function"==typeof e?(this._onML=t,ot(this,"message",t)):this._onML=null},addEventListener:function(e,t){ot(this,e,{time:this.method.microSeconds(),fn:t})},removeEventListener:function(e,t){st(this,e,this._addEL[e].find((function(e){return e.fn===t})))},close:function(){var e=this;if(!this.closed){et.delete(this),this.closed=!0;var t=this._prepP?this._prepP:le;return this._onML=null,this._addEL.message=[],t.then((function(){return Promise.all(Array.from(e._uMP))})).then((function(){return Promise.all(e._befC.map((function(e){return e()})))})).then((function(){return e.method.close(e._state)}))}},get type(){return this.method.type},get isClosed(){return this.closed}};var at=new Map;function ct(e,t,n,r){var i=at.get(t);return i||(i={bc:new nt(["RxDB:",e,n].join("|")),refs:new Set},at.set(t,i)),i.refs.add(r),i.bc}function ut(e,t){var n=at.get(e);if(n)return n.refs.delete(t),0===n.refs.size?(at.delete(e),n.bc.close()):void 0}function lt(e,t,n,r){if(t.multiInstance){var i=r||ct(e,t.databaseInstanceToken,n.databaseName,n),o=new _.x,s=n=>{n.storageName===e&&n.databaseName===t.databaseName&&n.collectionName===t.collectionName&&n.version===t.schema.version&&o.next(n.eventBulk)};i.addEventListener("message",s);var a=n.changeStream(),c=!1,u=a.subscribe((n=>{c||i.postMessage({storageName:e,databaseName:t.databaseName,collectionName:t.collectionName,version:t.schema.version,eventBulk:n})}));n.changeStream=function(){return o.asObservable().pipe(function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Pe.apply(void 0,(0,D.ev)([],(0,D.CR)(e)))}(a))};var l=n.close.bind(n);n.close=async function(){return c=!0,u.unsubscribe(),i.removeEventListener("message",s),r||await ut(t.databaseInstanceToken,n),l()};var h=n.remove.bind(n);n.remove=async function(){return c=!0,u.unsubscribe(),i.removeEventListener("message",s),r||await ut(t.databaseInstanceToken,n),h()}}}var ht=new WeakMap,dt=new WeakMap;function ft(e){return(0,ce.c)(dt,e,(()=>Ce(e)))}function pt(){var e=ct(this.storage.name,this.token,this.name,this),t=this.destroy.bind(this);this.destroy=function(){return ut(this.token,this),t()};var n=ft(e);return n||(n=ft(e),ht.set(this,n)),this.leaderElector=()=>n,n}function mt(){return!this.multiInstance||this.leaderElector().isLeader}function yt(){return this.multiInstance?this.leaderElector().awaitLeadership().then((()=>!0)):K.wd}var vt={name:"leader-election",rxdb:!0,prototypes:{RxDatabase:e=>{e.leaderElector=pt,e.isLeader=mt,e.waitForLeadership=yt}},hooks:{preDestroyRxDatabase:{after:function(e){var t=ht.get(e);t&&t.die()}}}},gt=i(7124),bt=e=>Promise.resolve(e);function wt(e,t){if("_deleted"===e)return t;var n=!!(t=(0,q.qu)(t))._deleted;return t[e]=n,delete t._deleted,t}function _t(e,t,n){return n.map((n=>{var r=(0,q.qu)(n);if("_deleted"!==t){var i=!!r[t];r._deleted=i,delete r[t]}else r._deleted=!!r._deleted;return r[e.schema.primaryPath]=(0,$.r$)(e.schema.jsonSchema,r),r}))}function Et(e,t){if("undefined"==typeof window||"object"!=typeof window||void 0===window.addEventListener||navigator.onLine)return e.promiseWait(t);var n,r=new Promise((e=>{n=()=>{window.removeEventListener("online",n),e()},window.addEventListener("online",n)}));return Promise.race([r,e.promiseWait(t)]).then((()=>{window.removeEventListener("online",n)}))}var kt=i(1976),St=new WeakMap,xt=function(){function e(e,t,n,r,i,o,s,a){this.subs=[],this.subjects={received:new _.x,sent:new _.x,error:new _.x,canceled:new w.X(!1),active:new w.X(!1)},this.received$=this.subjects.received.asObservable(),this.sent$=this.subjects.sent.asObservable(),this.error$=this.subjects.error.asObservable(),this.canceled$=this.subjects.canceled.asObservable(),this.active$=this.subjects.active.asObservable(),this.callOnStart=void 0,this.remoteEvents$=new _.x,this.replicationIdentifier=e,this.collection=t,this.deletedField=n,this.pull=r,this.push=i,this.live=o,this.retryTime=s,this.autoStart=a,(0,ce.c)(St,t,(()=>[])).push(this),this.collection.onDestroy.push((()=>this.cancel())),Object.keys(this.subjects).forEach((e=>{Object.defineProperty(this,e+"$",{get:function(){return this.subjects[e].asObservable()}})}));var c=new Promise((e=>{this.callOnStart=e}));this.startPromise=c}var n=e.prototype;return n.start=async function(){if(!this.isStopped()){var e,n,r,i,o=this.pull&&this.pull.modifier?this.pull.modifier:bt,s=this.push&&this.push.modifier?this.push.modifier:bt,a=this.collection.database,h="rx-replication-meta-"+await a.hashFunction([this.collection.name,this.replicationIdentifier].join("-")),d=(e=this.collection.schema.jsonSchema,n=(0,U.OR)(this.collection.schema.jsonSchema),r=(0,$.Mb)(e),i={title:"RxReplicationProtocolMetaData",primaryKey:{key:"id",fields:["itemId","isCheckpoint"],separator:"|"},type:"object",version:e.version,additionalProperties:!1,properties:{id:{type:"string",minLength:1,maxLength:r+2},isCheckpoint:{type:"string",enum:["0","1"],minLength:1,maxLength:1},itemId:{type:"string",maxLength:r>4?r:4},checkpointData:{type:"object",additionalProperties:!0},docData:{type:"object",properties:e.properties},isResolvedConflict:{type:"string"}},keyCompression:e.keyCompression,required:["id","isCheckpoint","itemId"]},n&&(i.encrypted=["docData"]),(0,$.El)(i)),[f]=await Promise.all([this.collection.database.storage.createStorageInstance({databaseName:a.name,collectionName:h,databaseInstanceToken:a.token,multiInstance:a.multiInstance,options:{},schema:d,password:a.password,devMode:c.j.isDevMode()}),(0,kt.iw)(this.collection,h,d)]);this.metaInstance=f,this.internalReplicationState=function(e){(e=(0,q.qu)(e)).forkInstance=X(e.forkInstance),e.metaInstance=X(e.metaInstance);var t=async function(e){return"rx_storage_replication_"+await e.hashFunction([e.identifier,e.forkInstance.databaseName,e.forkInstance.collectionName].join("||"))}(e),n={primaryPath:(0,$.CT)(e.forkInstance.schema.primaryKey),hasAttachments:!!e.forkInstance.schema.attachments,input:e,checkpointKey:t,downstreamBulkWriteFlag:t.then((e=>"replication-downstream-"+e)),events:{canceled:new w.X(!1),active:{down:new w.X(!0),up:new w.X(!0)},processed:{down:new _.x,up:new _.x},resolvedConflicts:new _.x,error:new _.x},stats:{down:{addNewTask:0,downstreamProcessChanges:0,downstreamResyncOnce:0,masterChangeStreamEmit:0,persistFromMaster:0},up:{forkChangeStreamEmit:0,persistToMaster:0,persistToMasterConflictWrites:0,persistToMasterHadConflicts:0,processTasks:0,upstreamInitialSync:0}},firstSyncDone:{down:new w.X(!1),up:new w.X(!1)},streamQueue:{down:K.$Y,up:K.$Y},checkpointQueue:K.$Y,lastCheckpointDoc:{}};return ne(n),oe(n),n}({pushBatchSize:this.push&&this.push.batchSize?this.push.batchSize:100,pullBatchSize:this.pull&&this.pull.batchSize?this.pull.batchSize:100,initialCheckpoint:{upstream:this.push?this.push.initialCheckpoint:void 0,downstream:this.pull?this.pull.initialCheckpoint:void 0},forkInstance:this.collection.storageInstance,metaInstance:this.metaInstance,hashFunction:a.hashFunction,identifier:"rxdbreplication"+this.replicationIdentifier,conflictHandler:this.collection.conflictHandler,replicationHandler:{masterChangeStream$:this.remoteEvents$.asObservable().pipe((0,g.h)((e=>!!this.pull)),(0,F.z)((async e=>{if("RESYNC"===e)return e;var t=(0,q.qu)(e);return t.documents=_t(this.collection,this.deletedField,t.documents),t.documents=await Promise.all(t.documents.map((e=>o(e)))),t}))),masterChangesSince:async(e,n)=>{if(!this.pull)return{checkpoint:null,documents:[]};for(var r=!1,i={};!r&&!this.isStopped();)try{i=await this.pull.handler(e,n),r=!0}catch(n){var s=(0,l.f3)("RC_PULL",{checkpoint:e,errors:(0,Y.qo)(n).map((e=>(0,gt.i)(e))),direction:"pull"});this.subjects.error.next(s),await Et(this.collection,(0,t.Is)(this.retryTime))}if(this.isStopped())return{checkpoint:null,documents:[]};var a=(0,q.qu)(i);return a.documents=_t(this.collection,this.deletedField,a.documents),a.documents=await Promise.all(a.documents.map((e=>o(e)))),a},masterWrite:async e=>{if(!this.push)return[];var n=!1;await(0,u.BU)("preReplicationMasterWrite",{rows:e,collection:this.collection});var r=(await Promise.all(e.map((async e=>(e.newDocumentState=await s(e.newDocumentState),null===e.newDocumentState?null:(e.assumedMasterState&&(e.assumedMasterState=await s(e.assumedMasterState)),"_deleted"!==this.deletedField&&(e.newDocumentState=wt(this.deletedField,e.newDocumentState),e.assumedMasterState&&(e.assumedMasterState=wt(this.deletedField,e.assumedMasterState))),e)))))).filter(Y.S7),i=null;for(0===r.length&&(n=!0,i=[]);!n&&!this.isStopped();)try{if(i=await this.push.handler(r),!Array.isArray(i))throw(0,l.f3)("RC_PUSH_NO_AR",{pushRows:e,direction:"push",args:{result:i}});n=!0}catch(n){var o=n.rxdb?n:(0,l.f3)("RC_PUSH",{pushRows:e,errors:(0,Y.qo)(n).map((e=>(0,gt.i)(e))),direction:"push"});this.subjects.error.next(o),await Et(this.collection,(0,t.Is)(this.retryTime))}return this.isStopped()?[]:(await(0,u.BU)("preReplicationMasterWriteDocumentsHandle",{result:i,collection:this.collection}),_t(this.collection,this.deletedField,(0,t.Is)(i)))}}}),this.subs.push(this.internalReplicationState.events.error.subscribe((e=>{this.subjects.error.next(e)})),this.internalReplicationState.events.processed.down.subscribe((e=>this.subjects.received.next(e.document))),this.internalReplicationState.events.processed.up.subscribe((e=>{this.subjects.sent.next(e.newDocumentState)})),L([this.internalReplicationState.events.active.down,this.internalReplicationState.events.active.up]).subscribe((([e,t])=>{var n=e||t;this.subjects.active.next(n)}))),this.pull&&this.pull.stream$&&this.live&&this.subs.push(this.pull.stream$.subscribe({next:e=>{this.remoteEvents$.next(e)},error:e=>{this.subjects.error.next(e)}})),this.live||(await se(this.internalReplicationState),await ae(this.internalReplicationState),await this.cancel()),this.callOnStart()}},n.isStopped=function(){return!!this.subjects.canceled.getValue()},n.awaitInitialReplication=async function(){return await this.startPromise,se((0,t.Is)(this.internalReplicationState))},n.awaitInSync=async function(){return await this.startPromise,await se((0,t.Is)(this.internalReplicationState)),await this.collection.database.requestIdlePromise(),await ae((0,t.Is)(this.internalReplicationState)),!0},n.reSync=function(){this.remoteEvents$.next("RESYNC")},n.emitEvent=function(e){this.remoteEvents$.next(e)},n.cancel=async function(){if(this.isStopped())return K.kZ;var e=[];return this.internalReplicationState&&await async function(e){e.events.canceled.next(!0),e.events.active.up.complete(),e.events.active.down.complete(),e.events.processed.up.complete(),e.events.processed.down.complete(),e.events.resolvedConflicts.complete(),e.events.canceled.complete(),await e.checkpointQueue}(this.internalReplicationState),this.metaInstance&&e.push((0,t.Is)(this.internalReplicationState).checkpointQueue.then((()=>(0,t.Is)(this.metaInstance).close()))),this.subs.forEach((e=>e.unsubscribe())),this.subjects.canceled.next(!0),this.subjects.active.complete(),this.subjects.canceled.complete(),this.subjects.error.complete(),this.subjects.received.complete(),this.subjects.sent.complete(),Promise.all(e)},e}();function Ct({replicationIdentifier:e,collection:t,deletedField:n="_deleted",pull:r,push:i,live:o=!0,retryTime:s=5e3,waitForLeadership:a=!0,autoStart:c=!0}){if(p(vt),!r&&!i)throw(0,l.f3)("UT3",{collection:t.name,args:{replicationIdentifier:e}});var u=new xt(e,t,n,r,i,o,s,c);return function(e,t){var n=e&&t.collection.database.multiInstance,r=n?t.collection.database.waitForLeadership():K.wd;r.then((()=>{t.isStopped()||t.autoStart&&t.start()}))}(a,u),u}function Ot(e,t,n){var r=n.id,i=(0,E.z)(e.response$.pipe((0,g.h)((e=>e.peer===t)),(0,g.h)((e=>e.response.id===r)),(0,b.U)((e=>e.response))));return e.send(t,n),i}var Rt=function(){function e(e,n,r){this.peerStates$=new w.X(new Map),this.canceled=!1,this.subs=[],this.error$=new _.x,this.collection=e,this.options=n,this.connectionHandler=r,this.collection.onDestroy.push((()=>this.cancel())),this.masterReplicationHandler=function(e,n,r,i=!1){var o=!!(e=X(e)).schema.attachments,s=(0,$.CT)(e.schema.primaryKey),a={masterChangeStream$:e.changeStream().pipe((0,F.z)((async t=>({checkpoint:t.checkpoint,documents:await Promise.all(t.events.map((async t=>{var n=J(t.documentData,o,i);return o&&(n=await ie(s,e,(0,q.d9)(n),void 0)),n})))})))),masterChangesSince:(t,n)=>e.getChangedDocumentsSince(n,t).then((async n=>({checkpoint:n.documents.length>0?n.checkpoint:t,documents:await Promise.all(n.documents.map((async t=>{var n=J(t,o,i);return o&&(n=await ie(s,e,(0,q.d9)(n),void 0)),n})))}))),async masterWrite(a){var c={};a.forEach((e=>{var t=e.newDocumentState[s];c[t]=e}));var u=Object.keys(c),l=await e.findDocumentsById(u,!0),h=new Map;l.forEach((e=>h.set(e[s],e)));var d=[],f=[];return await Promise.all(Object.entries(c).map((async([e,s])=>{var a=h.get(e);a?a&&!s.assumedMasterState?d.push(J(a,o,i)):!0===(await n({realMasterState:J(a,o,i),newDocumentState:(0,t.Is)(s.assumedMasterState)},"rxStorageInstanceToReplicationHandler-masterWrite")).isEqual?f.push({previous:a,document:G(r,o,i,s.newDocumentState,a)}):d.push(J(a,o,i)):f.push({document:G(r,o,i,s.newDocumentState)})}))),f.length>0&&(await e.bulkWrite(f,"replication-master-write")).error.forEach((e=>{if(409!==e.status)throw new Error("non conflict error");d.push(J((0,t.Is)(e.documentInDb),o,i))})),d}};return a}(e.storageInstance,e.conflictHandler,e.database.token)}var n=e.prototype;return n.addPeer=function(e,t){var n={peer:e,replicationState:t,subs:[]};this.peerStates$.next(this.peerStates$.getValue().set(e,n)),t&&n.subs.push(t.error$.subscribe((e=>this.error$.next(e))))},n.removePeer=function(e){var t=(0,ce.e)(this.peerStates$.getValue(),e);this.peerStates$.getValue().delete(e),this.peerStates$.next(this.peerStates$.getValue()),t.subs.forEach((e=>e.unsubscribe())),t.replicationState&&t.replicationState.cancel()},n.awaitFirstPeer=function(){return(0,E.z)(this.peerStates$.pipe((0,g.h)((e=>e.size>0))))},n.cancel=async function(){this.canceled||(this.canceled=!0,this.subs.forEach((e=>e.unsubscribe())),Array.from(this.peerStates$.getValue().keys()).forEach((e=>{this.removePeer(e)})),await this.connectionHandler.destroy())},e}(),It=i(8853);function Pt(e,t){e.send(JSON.stringify(t))}var Dt="signaling.rxdb.info",Tt="wss://"+Dt+"/",At=!1;function jt({signalingServerUrl:n,wrtc:r,webSocketConstructor:i}){n=n||Tt,i=i||WebSocket,n.includes(Dt)&&!At&&(At=!0,console.warn(["RxDB Warning: You are using the RxDB WebRTC replication plugin","but you did not specify your own signaling server url.","By default it will use a signaling server provided by RxDB at "+Tt,"This server is made for demonstration purposes and tryouts. It is not reliable and might be offline at any time.","In production you must always use your own signaling server instead.","Learn how to run your own server at https://rxdb.info/replication-webrtc.html","Also leave a ⭐ at the RxDB github repo 🙏 https://github.com/pubkey/rxdb 🙏"].join(" ")));return async o=>{var s,a=new _.x,c=new _.x,u=new _.x,h=new _.x,d=new _.x,f=new Map,p=!1,m=void 0;return function y(){if(p)return;(m=new i(n)).onclose=()=>y(),m.onopen=()=>{(0,t.Is)(m).onmessage=n=>{var i=JSON.parse(n.data);switch(i.type){case"init":s=i.yourPeerId,Pt((0,t.Is)(m),{type:"join",room:o.topic});break;case"joined":var p=function(n){var i=!1,y=new It({initiator:n>s,wrtc:r,trickle:!0});y.id=(0,e.sc)(10),f.set(n,y),y.on("signal",(e=>{Pt((0,t.Is)(m),{type:"signal",senderPeerId:s,receiverPeerId:n,room:o.topic,data:e})})),y.on("data",(e=>{(e=JSON.parse(e.toString())).result?h.next({peer:y,response:e}):u.next({peer:y,message:e})})),y.on("error",(e=>{d.next((0,l.f3)("RC_WEBRTC_PEER",{error:e})),y.destroy(),i||(i=!0,c.next(y))})),y.on("connect",(()=>{a.next(y)})),y.on("close",(()=>{i||(i=!0,c.next(y)),p(n)}))};i.otherPeerIds.forEach((e=>{e===s||f.has(e)||p(e)}));break;case"signal":(0,ce.e)(f,i.senderPeerId).signal(i.data)}}}}(),(async()=>{for(;await(0,K.YB)(6e4),!p;)m&&Pt(m,{type:"ping"})})(),{error$:d,connect$:a,disconnect$:c,message$:u,response$:h,async send(e,t){await e.send(JSON.stringify(t))},destroy:()=>(p=!0,(0,t.Is)(m).close(),d.complete(),a.complete(),c.complete(),u.complete(),h.complete(),K.$Y)}}}var Mt=i(8006),Nt=i(9334),Lt=i(4804);function Bt(e){return e===Nt.eG?-1/0:e}function Ft(e,t){if(!t){if("undefined"==typeof window)throw new Error("IDBKeyRange missing");t=window.IDBKeyRange}var n,r=e.startKeys.map(Bt),i=e.endKeys.map(Bt);if(1===e.index.length){var o=r[0]===i[0];n=t.bound(r[0],i[0],!o&&!e.inclusiveStart,!o&&!e.inclusiveEnd)}else n=t.bound(r,i,!e.inclusiveStart,!e.inclusiveEnd);return n}async function $t(e,t){var n=await e.internals,r=t.query,i=r.skip?r.skip:0,o=i+(r.limit?r.limit:1/0),s=t.queryPlan,a=!1;s.selectorSatisfiedByIndex||(a=(0,Lt.VL)(e.schema,t.query));var c=Ft(s,n.dexieDb._options.IDBKeyRange),u=s.index,l=[];if(await n.dexieDb.transaction("r",n.dexieTable,(async t=>{var n,r,i=t.idbtrans.objectStore(Mt.l4);1===u.length&&u[0]===e.primaryPath?n=i:(r=1===u.length?(0,Mt.N$)(u[0]):"["+u.map((e=>(0,Mt.N$)(e))).join("+")+"]",n=i.index(r));var h=n.openCursor(c);await new Promise((e=>{h.onsuccess=function(t){var n=t.target.result;if(n){var r=(0,Mt.dU)(n.value);r._deleted||a&&!a(r)||l.push(r),s.sortFieldsSameAsIndexFields&&l.length===o?e():n.continue()}else e()}}))})),!s.sortFieldsSameAsIndexFields){var h=(0,Lt.Pk)(e.schema,t.query);l=l.sort(h)}return{documents:l=l.slice(i,o)}}var qt=(0,z.z)(),Kt=function(){function e(e,t,n,r,i,o,s){this.changes$=new _.x,this.instanceId=qt++,this.storage=e,this.databaseName=t,this.collectionName=n,this.schema=r,this.internals=i,this.options=o,this.settings=s,this.primaryPath=(0,$.CT)(this.schema.primaryKey)}var n=e.prototype;return n.bulkWrite=async function(e,n){Ut(this),e.forEach((e=>{if(!e.document._rev||e.previous&&!e.previous._rev)throw(0,l.f3)("SNH",{args:{row:e}})}));var r,i=await this.internals,o={success:[],error:[]},s=e.map((e=>e.document[this.primaryPath]));if(await i.dexieDb.transaction("rw",i.dexieTable,i.dexieDeletedTable,(async()=>{var t=new Map;(await(0,Mt.Kj)(this.internals,s)).forEach((e=>{var n=e?(0,Mt.dU)(e):e;return n&&t.set(n[this.primaryPath],n),n})),r=(0,U.DF)(this,this.primaryPath,t,e,n),o.error=r.errors;var a=[],c=[],u=[],h=[];r.bulkInsertDocs.forEach((e=>{o.success.push(e.document),a.push(e.document)})),r.bulkUpdateDocs.forEach((e=>{var t=e.document[this.primaryPath];if(o.success.push(e.document),e.document._deleted&&e.previous&&!e.previous._deleted)c.push(t),u.push(e.document);else if(e.document._deleted&&e.previous&&e.previous._deleted)u.push(e.document);else{if(e.document._deleted)throw(0,l.f3)("SNH",{args:{row:e}});a.push(e.document)}})),await Promise.all([a.length>0?i.dexieTable.bulkPut(a.map((e=>(0,Mt.Gl)(e)))):K.$Y,c.length>0?i.dexieTable.bulkDelete(c):K.$Y,u.length>0?i.dexieDeletedTable.bulkPut(u.map((e=>(0,Mt.Gl)(e)))):K.$Y,h.length>0?i.dexieDeletedTable.bulkDelete(h):K.$Y])})),(r=(0,t.Is)(r)).eventBulk.events.length>0){var a=(0,t.Is)(r.newestRow).document;r.eventBulk.checkpoint={id:a[this.primaryPath],lwt:a._meta.lwt},r.eventBulk.endTime=(0,z.z)(),this.changes$.next(r.eventBulk)}return o},n.findDocumentsById=async function(e,t){Ut(this);var n=await this.internals,r=[];return await n.dexieDb.transaction("r",n.dexieTable,n.dexieDeletedTable,(async()=>{var i;i=t?await(0,Mt.Kj)(this.internals,e):await n.dexieTable.bulkGet(e),e.forEach(((e,n)=>{var o=i[n];!o||o._deleted&&!t||r.push((0,Mt.dU)(o))}))})),r},n.query=function(e){return Ut(this),$t(this,e)},n.count=async function(e){if(e.queryPlan.selectorSatisfiedByIndex){var t=await async function(e,t){var n=await e.internals,r=t.queryPlan,i=r.index,o=Ft(r,n.dexieDb._options.IDBKeyRange),s=-1;return await n.dexieDb.transaction("r",n.dexieTable,(async t=>{var n,r,a=t.idbtrans.objectStore(Mt.l4);1===i.length&&i[0]===e.primaryPath?n=a:(r=1===i.length?(0,Mt.N$)(i[0]):"["+i.map((e=>(0,Mt.N$)(e))).join("+")+"]",n=a.index(r));var c=n.count(o);s=await new Promise(((e,t)=>{c.onsuccess=function(){e(c.result)},c.onerror=e=>t(e)}))})),s}(this,e);return{count:t,mode:"fast"}}return{count:(await $t(this,e)).documents.length,mode:"slow"}},n.info=async function(){var e=await this.internals,t={totalCount:-1};return await e.dexieDb.transaction("r",e.dexieTable,e.dexieDeletedTable,(async n=>{var[r,i]=await Promise.all([e.dexieTable.count(),e.dexieDeletedTable.count()]);t.totalCount=r+i})),t},n.getChangedDocumentsSince=async function(e,t){Ut(this);var n=t?t.lwt:W.aA,r=t?t.id:"",i=await this.internals,[o,s]=await Promise.all([i.dexieTable,i.dexieDeletedTable].map((async t=>{var i=t.where("[_meta.lwt+"+this.primaryPath+"]").above([n,r]).limit(e);return(await i.toArray()).map((e=>(0,Mt.dU)(e)))}))),a=o.slice(0);(0,Y.gu)(a,s),a=(a=(0,W.Iy)(this.primaryPath,a)).slice(0,e);var c=(0,Y.SI)(a);return{documents:a,checkpoint:c?{id:c[this.primaryPath],lwt:c._meta.lwt}:t||{id:"",lwt:0}}},n.changeStream=function(){return Ut(this),this.changes$.asObservable()},n.cleanup=async function(e){Ut(this);var t=await this.internals;return await t.dexieDb.transaction("rw",t.dexieDeletedTable,(async()=>{var n=(0,z.z)()-e,r=(await t.dexieDeletedTable.where("_meta.lwt").below(n).toArray()).map((e=>e[this.primaryPath]));await t.dexieDeletedTable.bulkDelete(r)})),!0},n.getAttachmentData=function(e,t,n){throw Ut(this),new Error("Attachments are not implemented in the dexie RxStorage. Make a pull request.")},n.remove=async function(){Ut(this);var e=await this.internals;return await Promise.all([e.dexieDeletedTable.clear(),e.dexieTable.clear()]),this.close()},n.close=function(){return this.closed||(this.closed=(async()=>{this.changes$.complete(),await(0,Mt.Yi)(this.internals)})()),this.closed},n.conflictResultionTasks=function(){return new _.x},n.resolveConflictResultionTask=async function(e){},e}();function Ut(e){if(e.closed)throw new Error("RxStorageInstanceDexie is closed "+e.databaseName+"-"+e.collectionName)}var Wt=function(){function e(e){this.name=Mt.aS,this.statics=Mt.S9,this.settings=e}return e.prototype.createStorageInstance=function(e){return(0,U.nR)(e),(0,Mt.k4)(e.schema),async function(e,t,n){var r=(0,Mt.z4)(t.databaseName,t.collectionName,n,t.schema),i=new Kt(e,t.databaseName,t.collectionName,t.schema,r,t.options,n);return await lt(Mt.aS,t,i),Promise.resolve(i)}(this,e,this.settings)},e}();var zt=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{c(r.next(e))}catch(e){o(e)}}function a(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))},Ht=function(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(c){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(s=0)),s;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,r=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}};console.log("mode: production");var Qt=function(e={}){return new Wt(e)}(),Vt=zt(void 0,void 0,void 0,(function(){var n,r,o,s;return Ht(this,(function(c){switch(c.label){case 0:return[3,3];case 1:return c.sent(),[4,i.e(651).then(i.bind(i,651)).then((function(e){Qt=e.wrappedValidateAjvStorage({storage:Qt})}))];case 2:c.sent(),c.label=3;case 3:return(!(n=window.location.hash)||n.length<5)&&(window.location.hash="room-"+(0,e.sc)(10),window.location.reload()),[4,(0,m.nt)(n)];case 4:return r=c.sent(),[4,(0,a.tl)({name:"tpdp-"+y.j.replace(/\./g,"-")+"-"+r.substring(0,10),storage:Qt})];case 5:return o=c.sent(),s=function(e){return zt(void 0,void 0,void 0,(function(){return Ht(this,(function(t){return(0,v.v)(e.newDocumentState,e.realMasterState)?[2,{isEqual:!0}]:[2,{isEqual:!1,documentData:e.newDocumentState.lastChange>e.realMasterState.lastChange?e.newDocumentState:e.realMasterState}]}))}))},[4,o.addCollections({todos:{schema:{version:0,primaryKey:"id",type:"object",properties:{id:{type:"string",maxLength:20},name:{type:"string"},state:{type:"string",enum:["open","done"],maxLength:10},lastChange:{type:"number",minimum:0,maximum:2701307494132,multipleOf:1}},required:["id","name","state","lastChange"],indexes:["state",["state","lastChange"]]},conflictHandler:s}})];case 6:return c.sent(),o.todos.preSave((function(e){return e.lastChange=Date.now(),e}),!0),[4,o.todos.bulkInsert(["touch your 👃 with your 👅","solve rubik's cube 🎲 blindfolded","invent new 🍔"].map((function(e,t){return{id:"todo-"+t,name:e,lastChange:0,state:"open"}})))];case 7:return c.sent(),async function(n){var r=n.collection;p(vt),n.pull&&(n.pull.batchSize||(n.pull.batchSize=20)),n.push&&(n.push.batchSize||(n.push.batchSize=20)),r.database.multiInstance&&await r.database.waitForLeadership();var i=0,o=(0,e.sc)(10);function s(){var e=i++;return r.database.token+"|"+o+"|"+e}var a=await r.database.storageToken,c=new Rt(r,n,await n.connectionHandlerCreator(n));c.subs.push(c.connectionHandler.error$.subscribe((e=>c.error$.next(e))),c.connectionHandler.disconnect$.subscribe((e=>c.removePeer(e)))),c.subs.push(c.connectionHandler.message$.pipe((0,g.h)((e=>"token"===e.message.method))).subscribe((e=>{c.connectionHandler.send(e.peer,{id:e.message.id,result:a})})));var u=c.connectionHandler.connect$.pipe((0,g.h)((()=>!c.canceled))).subscribe((async e=>{var i,o;if(!n.isPeerValid||await n.isPeerValid(e)){try{i=(await Ot(c.connectionHandler,e,{id:s(),method:"token",params:[]})).result}catch(e){return void c.error$.next((0,l.f3)("RC_WEBRTC_PEER",{error:e}))}if(await async function(e,t,n){return await e([t,n].join("|"))>await e([n,t].join("|"))}(r.database.hashFunction,a,i)){var u=c.masterReplicationHandler,h=u.masterChangeStream$.subscribe((t=>{var n={id:"masterChangeStream$",result:t};c.connectionHandler.send(e,n)}));c.subs.push(h,c.connectionHandler.disconnect$.pipe((0,g.h)((t=>t===e))).subscribe((()=>h.unsubscribe())));var d=c.connectionHandler.message$.pipe((0,g.h)((t=>t.peer===e)),(0,g.h)((e=>"token"!==e.message.method))).subscribe((async e=>{var{peer:t,message:n}=e,r=u[n.method].bind(u),i=await r(...n.params),o={id:n.id,result:i};c.connectionHandler.send(t,o)}));c.subs.push(d)}else o=Ct({replicationIdentifier:[r.name,n.topic,i].join("||"),collection:r,autoStart:!0,deletedField:"_deleted",live:!0,retryTime:n.retryTime,waitForLeadership:!1,pull:n.pull?Object.assign({},n.pull,{handler:async r=>(await Ot(c.connectionHandler,e,{method:"masterChangesSince",params:[r,(0,t.Is)(n.pull).batchSize],id:s()})).result,stream$:c.connectionHandler.response$.pipe((0,g.h)((e=>"masterChangeStream$"===e.response.id)),(0,b.U)((e=>e.response.result)))}):void 0,push:n.push?Object.assign({},n.push,{handler:async t=>(await Ot(c.connectionHandler,e,{method:"masterWrite",params:[t],id:s()})).result}):void 0});c.addPeer(e,o)}}));return c.subs.push(u),c}({collection:o.todos,connectionHandlerCreator:jt({}),topic:r.substring(0,10),pull:{},push:{}}).then((function(e){e.error$.subscribe((function(e){console.log("replication error:"),console.dir(e)})),e.peerStates$.subscribe((function(e){console.log("new peer states:"),console.dir(e)}))})),[2,o]}}))})),Yt=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{c(r.next(e))}catch(e){o(e)}}function a(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))},Gt=function(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(c){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(s=0)),s;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,r=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}};function Jt(e){return(0,t.Is)(document.getElementById(e))}Yt(void 0,void 0,void 0,(function(){var t,n,r,i;return Gt(this,(function(o){switch(o.label){case 0:return[4,Vt];case 1:return t=o.sent(),Jt("copy-url").innerHTML=window.location.href,n=Jt("todo-list"),t.todos.find({sort:[{state:"desc"},{lastChange:"desc"}]}).$.subscribe((function(e){n.innerHTML="",e.forEach((function(e){return n.append(function(e){var t=this,n=document.createElement("li"),r=document.createElement("div"),i=document.createElement("input"),o=document.createElement("label"),s=document.createElement("button");n.append(r),r.append(i),r.append(o),r.append(s),i.onclick=function(){return e.incrementalPatch({state:"done"===e.state?"open":"done"})},i.type="checkbox",i.classList.add("toggle"),o.contentEditable="true";var a=function(){return Yt(t,void 0,void 0,(function(){var t;return Gt(this,(function(n){switch(n.label){case 0:return(t=(t=o.innerText||o.textContent).replace(/<br>/g,"").replace(/\&nbsp;/g," ").trim())===e.name?[3,2]:[4,e.incrementalPatch({name:t})];case 1:n.sent(),n.label=2;case 2:return[2]}}))}))};return o.onblur=function(){return a()},o.onkeyup=function(e){return Yt(t,void 0,void 0,(function(){return Gt(this,(function(t){return Xt(e)&&a(),[2]}))}))},o.innerHTML=Zt(e.name),s.classList.add("destroy"),s.onclick=function(){return e.remove()},"done"===e.state&&(n.classList.add("completed"),i.checked=!0),n}(e))}))})),r=Jt("insert-todo"),i=function(){return Yt(void 0,void 0,void 0,(function(){return Gt(this,(function(n){switch(n.label){case 0:return r.value.length<1?[2]:[4,t.todos.insert({id:(0,e.sc)(10),name:r.value,state:"open",lastChange:Date.now()})];case 1:return n.sent(),r.value="",[2]}}))}))},r.onkeydown=function(e){return Yt(void 0,void 0,void 0,(function(){return Gt(this,(function(t){return Xt(e)&&i(),[2]}))}))},r.onblur=function(){return i()},Jt("clear-completed").onclick=function(){return t.todos.find({selector:{state:"done"}}).remove()},[2]}}))}));var Zt=function(e){return e.replace(/[&<]/g,(function(e){return"&"===e?"&amp;":"&lt;"}))},Xt=function(e){return"Enter"===e.code||13===e.keyCode}})()})();
//# sourceMappingURL=f0966f73ea9a88f7fcfa.bundle.js.map